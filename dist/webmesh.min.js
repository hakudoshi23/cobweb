"use strict";!function(){function e(e,t,n){e[t]||(e[t]=n)}e(Array.prototype,"unique",function(){for(var e=this.concat(),t=0;t<e.length;++t)for(var n=t+1;n<e.length;++n)e[t]===e[n]&&e.splice(n--,1);return e}),e(HTMLElement.prototype,"addClass",function(){for(var e in arguments){var t=this.className?this.className.trim().replace(/\s+/g," ").split(" "):[],n=arguments[e]?arguments[e].trim().replace(/\s+/g," ").split(" "):[];this.className=t.concat(n).unique().join(" ")}}),e(HTMLElement.prototype,"height",function(){return this.getBoundingClientRect().height}),e(HTMLElement.prototype,"width",function(){return this.getBoundingClientRect().width})}(),function(){window.EventHandler=function(){this.listeners={},this.trigger=function(){for(var e=arguments[0],t=this.listeners[e]||[],n=0;n<t.length;n++)Array.prototype.splice.call(arguments,0,1),t[n].apply(null,arguments)},this.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},this.off=function(e){delete this.listeners[e]},this.off=function(e,t){if(this.listeners[e]){var n=this.listeners[e];n.indexOf(t)>-1&&n.splice(index,1)}}}}(),function(){function e(t,n){for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];"object"==typeof o?e(t[i],n[i]):t[i]=n[i]}}var t=function(n){this.options={container:{selector:"#webmesh",className:"wm-container"},menu:{className:"wm-menu"},logger:{className:"wm-logger"}},n&&"object"==typeof n&&e(this.options,n),this.container=document.querySelector(this.options.container.selector),this.container.addClass(this.options.container.className),this.gl=GL.create({height:container.height(),width:container.width()}),this.container.append(this.gl.canvas),this.events=new EventHandler,t.prototype.enablePlugins(this),this.events.on("resize",function(e){e.gl.canvas.height=e.container.height(),e.gl.canvas.width=e.container.width()});var i=this;window.addEventListener("resize",function(e){i.events.trigger("resize",i)})};t.prototype.plugins={},t.prototype.enablePlugins=function(e){for(var n in t.prototype.plugins)e[n]=new t.prototype.plugins[n](e)},window.WebMesh=t}(),function(){WebMesh.prototype.plugins.logger=function(e){var t=document.createElement("DIV");t.addClass(e.options.logger.className),e.container.append(t);var n=document.createElement("DIV");n.innerHTML="Lorem ipsum...",n.addClass("info"),t.append(n),this.info=function(e){n.innerHTML=e},e.events.on("logger.info",this.info)}}(),function(){WebMesh.prototype.plugins.menu=function(e){var t=document.createElement("DIV");t.addClass(e.options.menu.className),e.container.append(t);var n=document.createElement("UL");t.append(n),this.items={File:[{"Load...":function(){console.log("item click!")}}],"Alert!":function(){e.events.trigger("logger.info","LOOK AT ME! O_O"),window.setTimeout(function(){e.events.trigger("logger.info","STAPH!")},2e3)},Help:[{"About WebMesh":function(){console.log("About what?!")}}]},this.update=function(){for(var e in this.items){var t=document.createElement("LI");t.innerHTML=e,t.addClass(e);var i=this.items[e];"function"==typeof i&&(t.onclick=i),n.append(t)}},this.update()}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLmpzIiwiZXZlbnRzLmpzIiwid2VibWVzaC5qcyIsImxvZ2dlci5qcyIsIm1lbnUuanMiXSwibmFtZXMiOlsic2FmZU92ZXJyaWRlIiwicHJvdG90eXBlIiwicHJvcGVydHkiLCJ2YWx1ZSIsIkFycmF5IiwiYSIsInRoaXMiLCJjb25jYXQiLCJpIiwibGVuZ3RoIiwiaiIsInNwbGljZSIsIkhUTUxFbGVtZW50IiwiYXJndW1lbnRzIiwib2xkQ2xhc3NOYW1lcyIsImNsYXNzTmFtZSIsInRyaW0iLCJyZXBsYWNlIiwic3BsaXQiLCJuZXdDbGFzc05hbWVzIiwidW5pcXVlIiwiam9pbiIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImhlaWdodCIsIndpZHRoIiwid2luZG93IiwiRXZlbnRIYW5kbGVyIiwibGlzdGVuZXJzIiwidHJpZ2dlciIsIm5hbWUiLCJjYWxsIiwiYXBwbHkiLCJvbiIsImNhbGxiYWNrIiwicHVzaCIsIm9mZiIsImFycmF5IiwiaW5kZXhPZiIsImluZGV4IiwiZXh0ZW5kIiwic291cmNlIiwicHJvcGVydGllcyIsImhhc093blByb3BlcnR5IiwiV2ViTWVzaCIsIm9wdGlvbnMiLCJjb250YWluZXIiLCJzZWxlY3RvciIsIm1lbnUiLCJsb2dnZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRDbGFzcyIsImdsIiwiR0wiLCJjcmVhdGUiLCJhcHBlbmQiLCJjYW52YXMiLCJldmVudHMiLCJlbmFibGVQbHVnaW5zIiwiaW5zdGFuY2UiLCJzY29wZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInBsdWdpbnMiLCJjcmVhdGVFbGVtZW50IiwiaW5mbyIsImlubmVySFRNTCIsInRleHQiLCJpdGVtcyIsIkZpbGUiLCJMb2FkLi4uIiwiY29uc29sZSIsImxvZyIsIkFsZXJ0ISIsInNldFRpbWVvdXQiLCJIZWxwIiwiQWJvdXQgV2ViTWVzaCIsInVwZGF0ZSIsIml0ZW0iLCJsaSIsIm9uY2xpY2siXSwibWFwcGluZ3Mi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LFdBQ0EsTUFFQStDLE9BRUFDLGdCQUFBLFdBQ0FMLFFBQUFDLElBQUEsb0JBTUFsRSxLQUFBdUUsT0FBQSxXQUNBLElBQUEsR0FBQUMsS0FBQXhFLE1BQUE4RCxNQUFBLENBQ0EsR0FBQVcsR0FBQTlCLFNBQUFlLGNBQUEsS0FDQWUsR0FBQWIsVUFBQVksRUFDQUMsRUFBQTVCLFNBQUEyQixFQUVBLElBQUEzRSxHQUFBRyxLQUFBOEQsTUFBQVUsRUFDQSxtQkFBQTNFLEtBQ0E0RSxFQUFBQyxRQUFBN0UsR0FHQTRDLEVBQUFRLE9BQUF3QixLQUdBekUsS0FBQXVFIiwiZmlsZSI6IndlYm1lc2gubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG5cclxuKChmdW5jdGlvbigpe1xyXG4gICAgc2FmZU92ZXJyaWRlKEFycmF5LnByb3RvdHlwZSwgJ3VuaXF1ZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBhID0gdGhpcy5jb25jYXQoKTtcclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICBmb3IodmFyIGogPSBpICsgMTsgaiA8IGEubGVuZ3RoOyArK2opIHtcclxuICAgICAgICAgICAgICAgIGlmKGFbaV0gPT09IGFbal0pIGEuc3BsaWNlKGotLSwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGE7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzYWZlT3ZlcnJpZGUoSFRNTEVsZW1lbnQucHJvdG90eXBlLCAnYWRkQ2xhc3MnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBmb3IodmFyIGkgaW4gYXJndW1lbnRzKXtcclxuICAgICAgICAgICAgdmFyIG9sZENsYXNzTmFtZXMgPSAhdGhpcy5jbGFzc05hbWUgPyBbXSA6IHRoaXMuY2xhc3NOYW1lLnRyaW0oKS5yZXBsYWNlKC9cXHMrL2csICcgJykuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgdmFyIG5ld0NsYXNzTmFtZXMgPSAhYXJndW1lbnRzW2ldID8gW10gOiBhcmd1bWVudHNbaV0udHJpbSgpLnJlcGxhY2UoL1xccysvZywgJyAnKS5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICB0aGlzLmNsYXNzTmFtZSA9IG9sZENsYXNzTmFtZXMuY29uY2F0KG5ld0NsYXNzTmFtZXMpLnVuaXF1ZSgpLmpvaW4oJyAnKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBzYWZlT3ZlcnJpZGUoSFRNTEVsZW1lbnQucHJvdG90eXBlLCAnaGVpZ2h0JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0O1xyXG4gICAgfSk7XHJcblxyXG4gICAgc2FmZU92ZXJyaWRlKEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ3dpZHRoJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBzYWZlT3ZlcnJpZGUocHJvdG90eXBlLCBwcm9wZXJ0eSwgdmFsdWUpIHtcclxuICAgICAgICBpZighcHJvdG90eXBlW3Byb3BlcnR5XSkgcHJvdG90eXBlW3Byb3BlcnR5XSA9IHZhbHVlO1xyXG4gICAgfVxyXG59KSgpKTtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuKChmdW5jdGlvbigpIHtcclxuICAgIHdpbmRvdy5FdmVudEhhbmRsZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmxpc3RlbmVycyA9IHt9O1xyXG4gICAgICAgIHRoaXMudHJpZ2dlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgbmFtZSA9IGFyZ3VtZW50c1swXTtcclxuICAgICAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMubGlzdGVuZXJzW25hbWVdIHx8IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNwbGljZS5jYWxsKGFyZ3VtZW50cywgMCwgMSk7XHJcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcnNbaV0uYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5vbiA9IGZ1bmN0aW9uKG5hbWUsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5saXN0ZW5lcnNbbmFtZV0pIHRoaXMubGlzdGVuZXJzW25hbWVdID0gW107XHJcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzW25hbWVdLnB1c2goY2FsbGJhY2spO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5vZmYgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmxpc3RlbmVyc1tuYW1lXTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMub2ZmID0gZnVuY3Rpb24obmFtZSwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubGlzdGVuZXJzW25hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJyYXkgPSB0aGlzLmxpc3RlbmVyc1tuYW1lXTtcclxuICAgICAgICAgICAgICAgIGlmIChhcnJheS5pbmRleE9mKGNhbGxiYWNrKSA+IC0xKSBhcnJheS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbn0pKCkpO1xyXG4iLCIndXNlIHN0cmljdCc7XHJcblxyXG4oZnVuY3Rpb24oKXtcclxuICAgIHZhciBXZWJNZXNoID0gZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgY29udGFpbmVyOiB7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJyN3ZWJtZXNoJyxcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ3dtLWNvbnRhaW5lcidcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWVudToge1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnd20tbWVudSdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbG9nZ2VyOiB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICd3bS1sb2dnZXInXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChvcHRpb25zICYmIHR5cGVvZiBvcHRpb25zID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICBleHRlbmQodGhpcy5vcHRpb25zLCBvcHRpb25zKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm9wdGlvbnMuY29udGFpbmVyLnNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuY29udGFpbmVyLmNsYXNzTmFtZSk7XHJcblxyXG4gICAgICAgIHRoaXMuZ2wgPSBHTC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBoZWlnaHQ6IGNvbnRhaW5lci5oZWlnaHQoKSxcclxuICAgICAgICAgICAgd2lkdGg6IGNvbnRhaW5lci53aWR0aCgpXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZCh0aGlzLmdsLmNhbnZhcyk7XHJcblxyXG4gICAgICAgIHRoaXMuZXZlbnRzID0gbmV3IEV2ZW50SGFuZGxlcigpO1xyXG4gICAgICAgIFdlYk1lc2gucHJvdG90eXBlLmVuYWJsZVBsdWdpbnModGhpcyk7XHJcblxyXG4gICAgICAgIHRoaXMuZXZlbnRzLm9uKCdyZXNpemUnLCBmdW5jdGlvbihpbnN0YW5jZSkge1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5nbC5jYW52YXMuaGVpZ2h0ID0gaW5zdGFuY2UuY29udGFpbmVyLmhlaWdodCgpO1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5nbC5jYW52YXMud2lkdGggPSBpbnN0YW5jZS5jb250YWluZXIud2lkdGgoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIHNjb3BlID0gdGhpcztcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgc2NvcGUuZXZlbnRzLnRyaWdnZXIoJ3Jlc2l6ZScsIHNjb3BlKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgV2ViTWVzaC5wcm90b3R5cGUucGx1Z2lucyA9IHt9O1xyXG5cclxuICAgIFdlYk1lc2gucHJvdG90eXBlLmVuYWJsZVBsdWdpbnMgPSBmdW5jdGlvbihpbnN0YW5jZSkge1xyXG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gV2ViTWVzaC5wcm90b3R5cGUucGx1Z2lucylcclxuICAgICAgICAgICAgaW5zdGFuY2VbbmFtZV0gPSBuZXcgV2ViTWVzaC5wcm90b3R5cGUucGx1Z2luc1tuYW1lXShpbnN0YW5jZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIGV4dGVuZChzb3VyY2UsIHByb3BlcnRpZXMpe1xyXG4gICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIHByb3BlcnRpZXMpIHtcclxuICAgICAgICAgICAgaWYgKHByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkocHJvcGVydHkpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBwcm9wZXJ0aWVzW3Byb3BlcnR5XTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXh0ZW5kKHNvdXJjZVtwcm9wZXJ0eV0sIHByb3BlcnRpZXNbcHJvcGVydHldKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc291cmNlW3Byb3BlcnR5XSA9IHByb3BlcnRpZXNbcHJvcGVydHldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHdpbmRvdy5XZWJNZXNoID0gV2ViTWVzaDtcclxufSgpKTtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuKChmdW5jdGlvbigpe1xyXG4gICAgV2ViTWVzaC5wcm90b3R5cGUucGx1Z2luc1snbG9nZ2VyJ10gPSBmdW5jdGlvbihpbnN0YW5jZSkge1xyXG4gICAgICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcclxuICAgICAgICBjb250YWluZXIuYWRkQ2xhc3MoaW5zdGFuY2Uub3B0aW9ucy5sb2dnZXIuY2xhc3NOYW1lKTtcclxuICAgICAgICBpbnN0YW5jZS5jb250YWluZXIuYXBwZW5kKGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgIHZhciBpbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XHJcbiAgICAgICAgaW5mby5pbm5lckhUTUwgPSAnTG9yZW0gaXBzdW0uLi4nO1xyXG4gICAgICAgIGluZm8uYWRkQ2xhc3MoJ2luZm8nKTtcclxuICAgICAgICBjb250YWluZXIuYXBwZW5kKGluZm8pO1xyXG5cclxuICAgICAgICB0aGlzLmluZm8gPSBmdW5jdGlvbih0ZXh0KSB7XHJcbiAgICAgICAgICAgIGluZm8uaW5uZXJIVE1MID0gdGV4dDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGluc3RhbmNlLmV2ZW50cy5vbignbG9nZ2VyLmluZm8nLCB0aGlzLmluZm8pO1xyXG4gICAgfTtcclxufSkoKSk7XHJcbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbigoZnVuY3Rpb24oKXtcclxuICAgIFdlYk1lc2gucHJvdG90eXBlLnBsdWdpbnNbJ21lbnUnXSA9IGZ1bmN0aW9uKGluc3RhbmNlKSB7XHJcbiAgICAgICAgdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG4gICAgICAgIGNvbnRhaW5lci5hZGRDbGFzcyhpbnN0YW5jZS5vcHRpb25zLm1lbnUuY2xhc3NOYW1lKTtcclxuICAgICAgICBpbnN0YW5jZS5jb250YWluZXIuYXBwZW5kKGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgIHZhciBtZW51ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnVUwnKTtcclxuICAgICAgICBjb250YWluZXIuYXBwZW5kKG1lbnUpO1xyXG5cclxuICAgICAgICB0aGlzLml0ZW1zID0ge1xyXG4gICAgICAgICAgICAnRmlsZSc6IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAnTG9hZC4uLic6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnaXRlbSBjbGljayEnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICdBbGVydCEnOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLmV2ZW50cy50cmlnZ2VyKCdsb2dnZXIuaW5mbycsICdMT09LIEFUIE1FISBPX08nKTtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuZXZlbnRzLnRyaWdnZXIoJ2xvZ2dlci5pbmZvJywgJ1NUQVBIIScpO1xyXG4gICAgICAgICAgICAgICAgfSwgMjAwMCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdIZWxwJzogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICdBYm91dCBXZWJNZXNoJzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBYm91dCB3aGF0PyEnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBmb3IodmFyIGl0ZW0gaW4gdGhpcy5pdGVtcyl7XHJcbiAgICAgICAgICAgICAgICB2YXIgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdMSScpO1xyXG4gICAgICAgICAgICAgICAgbGkuaW5uZXJIVE1MID0gaXRlbTtcclxuICAgICAgICAgICAgICAgIGxpLmFkZENsYXNzKGl0ZW0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuaXRlbXNbaXRlbV07XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGkub25jbGljayA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIG1lbnUuYXBwZW5kKGxpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy51cGRhdGUoKTtcclxuICAgIH07XHJcbn0pKCkpO1xyXG4iXX0=
