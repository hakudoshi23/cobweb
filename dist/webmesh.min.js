"use strict";!function(){function e(e,t,n){e[t]||(e[t]=n)}e(Array.prototype,"unique",function(){for(var e=this.concat(),t=0;t<e.length;++t)for(var n=t+1;n<e.length;++n)e[t]===e[n]&&e.splice(n--,1);return e}),e(HTMLElement.prototype,"addClass",function(){for(var e in arguments){var t=this.className?this.className.trim().replace(/\s+/g," ").split(" "):[],n=arguments[e]?arguments[e].trim().replace(/\s+/g," ").split(" "):[];this.className=t.concat(n).unique().join(" ")}}),e(HTMLElement.prototype,"height",function(){return this.getBoundingClientRect().height}),e(HTMLElement.prototype,"width",function(){return this.getBoundingClientRect().width})}(),function(){window.EventHandler=function(){this.listeners={},this.trigger=function(){for(var e=arguments[0],t=this.listeners[e]||[],n=0;n<t.length;n++)Array.prototype.splice.call(arguments,0,1),t[n].apply(null,arguments)},this.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},this.off=function(e){delete this.listeners[e]},this.off=function(e,t){if(this.listeners[e]){var n=this.listeners[e];n.indexOf(t)>-1&&n.splice(index,1)}}}}(),function(){function e(t,n){for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];"object"==typeof o?e(t[i],n[i]):t[i]=n[i]}}window.WebMesh=function(t){this.options={container:{selector:"#webmesh",className:"wm-container"},menu:{className:"wm-menu"},logger:{className:"wm-logger"}},t&&"object"==typeof t&&e(this.options,t),this.container=document.querySelector(this.options.container.selector),this.container.addClass(this.options.container.className),this.gl=GL.create({height:container.height(),width:container.width()}),this.container.append(this.gl.canvas),this.events=new EventHandler,WebMesh.prototype.enablePlugins(this),this.events.on("resize",function(e){e.gl.canvas.height=e.container.height(),e.gl.canvas.width=e.container.width()});var n=this;window.addEventListener("resize",function(e){n.events.trigger("resize",n)})}}(),function(){WebMesh.prototype.plugins={},WebMesh.prototype.enablePlugins=function(e){for(var t in WebMesh.prototype.plugins)e[t]=new WebMesh.prototype.plugins[t](e)}}(),function(){WebMesh.prototype.plugins.logger=function(e){var t=document.createElement("DIV");t.addClass(e.options.logger.className),e.container.append(t);var n=document.createElement("DIV");n.innerHTML="Lorem ipsum...",n.addClass("info"),t.append(n),this.info=function(e){n.innerHTML=e},e.events.on("logger.info",this.info)}}(),function(){WebMesh.prototype.plugins.menu=function(e){var t=document.createElement("DIV");t.addClass(e.options.menu.className),e.container.append(t);var n=document.createElement("UL");t.append(n),this.items={File:[{"Load...":function(){console.log("item click!")}}],"Alert!":function(){e.events.trigger("logger.info","LOOK AT ME! O_O"),window.setTimeout(function(){e.events.trigger("logger.info","STAPH!")},2e3)},Help:[{"About WebMesh":function(){console.log("About what?!")}}]},this.update=function(){for(var e in this.items){var t=document.createElement("LI");t.innerHTML=e,t.addClass(e);var i=this.items[e];"function"==typeof i&&(t.onclick=i),n.append(t)}},this.update()}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLmpzIiwiZXZlbnRzLmpzIiwid2VibWVzaC5qcyIsInBsdWdpbnMuanMiLCJsb2dnZXIuanMiLCJtZW51LmpzIl0sIm5hbWVzIjpbInNhZmVPdmVycmlkZSIsInByb3RvdHlwZSIsInByb3BlcnR5IiwidmFsdWUiLCJBcnJheSIsImEiLCJ0aGlzIiwiY29uY2F0IiwiaSIsImxlbmd0aCIsImoiLCJzcGxpY2UiLCJIVE1MRWxlbWVudCIsImFyZ3VtZW50cyIsIm9sZENsYXNzTmFtZXMiLCJjbGFzc05hbWUiLCJ0cmltIiwicmVwbGFjZSIsInNwbGl0IiwibmV3Q2xhc3NOYW1lcyIsInVuaXF1ZSIsImpvaW4iLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJoZWlnaHQiLCJ3aWR0aCIsIndpbmRvdyIsIkV2ZW50SGFuZGxlciIsImxpc3RlbmVycyIsInRyaWdnZXIiLCJuYW1lIiwiY2FsbCIsImFwcGx5Iiwib24iLCJjYWxsYmFjayIsInB1c2giLCJvZmYiLCJhcnJheSIsImluZGV4T2YiLCJpbmRleCIsImV4dGVuZCIsInNvdXJjZSIsInByb3BlcnRpZXMiLCJoYXNPd25Qcm9wZXJ0eSIsIldlYk1lc2giLCJvcHRpb25zIiwiY29udGFpbmVyIiwic2VsZWN0b3IiLCJtZW51IiwibG9nZ2VyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWRkQ2xhc3MiLCJnbCIsIkdMIiwiY3JlYXRlIiwiYXBwZW5kIiwiY2FudmFzIiwiZXZlbnRzIiwiZW5hYmxlUGx1Z2lucyIsImluc3RhbmNlIiwic2NvcGUiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJwbHVnaW5zIiwiY3JlYXRlRWxlbWVudCIsImluZm8iLCJpbm5lckhUTUwiLCJ0ZXh0IiwiaXRlbXMiLCJGaWxlIiwiTG9hZC4uLiIsImNvbnNvbGUiLCJsb2ciLCJBbGVydCEiLCJzZXRUaW1lb3V0IiwiSGVscCIsIkFib3V0IFdlYk1lc2giLCJ1cGRhdGUiLCJpdGVtIiwibGkiLCJvbmNsaWNrIl0sIm1hcHBpbmdzIjoiQUFBQSxjQUVBLFdBMkJBLFFBQUFBLEdBQUFDLEVBQUFDLEVBQUFDLEdBQ0FGLEVBQUFDLEtBQUFELEVBQUFDLEdBQUFDLEdBM0JBSCxFQUFBSSxNQUFBSCxVQUFBLFNBQUEsV0FFQSxJQUFBLEdBREFJLEdBQUFDLEtBQUFDLFNBQ0FDLEVBQUEsRUFBQUEsRUFBQUgsRUFBQUksU0FBQUQsRUFDQSxJQUFBLEdBQUFFLEdBQUFGLEVBQUEsRUFBQUUsRUFBQUwsRUFBQUksU0FBQUMsRUFDQUwsRUFBQUcsS0FBQUgsRUFBQUssSUFBQUwsRUFBQU0sT0FBQUQsSUFBQSxFQUdBLE9BQUFMLEtBR0FMLEVBQUFZLFlBQUFYLFVBQUEsV0FBQSxXQUNBLElBQUEsR0FBQU8sS0FBQUssV0FBQSxDQUNBLEdBQUFDLEdBQUFSLEtBQUFTLFVBQUFULEtBQUFTLFVBQUFDLE9BQUFDLFFBQUEsT0FBQSxLQUFBQyxNQUFBLFFBQ0FDLEVBQUFOLFVBQUFMLEdBQUFLLFVBQUFMLEdBQUFRLE9BQUFDLFFBQUEsT0FBQSxLQUFBQyxNQUFBLE9BQ0FaLE1BQUFTLFVBQUFELEVBQUFQLE9BQUFZLEdBQUFDLFNBQUFDLEtBQUEsUUFJQXJCLEVBQUFZLFlBQUFYLFVBQUEsU0FBQSxXQUNBLE1BQUFLLE1BQUFnQix3QkFBQUMsU0FHQXZCLEVBQUFZLFlBQUFYLFVBQUEsUUFBQSxXQUNBLE1BQUFLLE1BQUFnQix3QkFBQUUsV0N4QkEsV0FDQUMsT0FBQUMsYUFBQSxXQUNBcEIsS0FBQXFCLGFBQ0FyQixLQUFBc0IsUUFBQSxXQUdBLElBQUEsR0FGQUMsR0FBQWhCLFVBQUEsR0FDQWMsRUFBQXJCLEtBQUFxQixVQUFBRSxPQUNBckIsRUFBQSxFQUFBQSxFQUFBbUIsRUFBQWxCLE9BQUFELElBQ0FKLE1BQUFILFVBQUFVLE9BQUFtQixLQUFBakIsVUFBQSxFQUFBLEdBQ0FjLEVBQUFuQixHQUFBdUIsTUFBQSxLQUFBbEIsWUFHQVAsS0FBQTBCLEdBQUEsU0FBQUgsRUFBQUksR0FDQTNCLEtBQUFxQixVQUFBRSxLQUFBdkIsS0FBQXFCLFVBQUFFLE9BQ0F2QixLQUFBcUIsVUFBQUUsR0FBQUssS0FBQUQsSUFFQTNCLEtBQUE2QixJQUFBLFNBQUFOLFNBQ0F2QixNQUFBcUIsVUFBQUUsSUFFQXZCLEtBQUE2QixJQUFBLFNBQUFOLEVBQUFJLEdBQ0EsR0FBQTNCLEtBQUFxQixVQUFBRSxHQUFBLENBQ0EsR0FBQU8sR0FBQTlCLEtBQUFxQixVQUFBRSxFQUNBTyxHQUFBQyxRQUFBSixJQUFBLEdBQUFHLEVBQUF6QixPQUFBMkIsTUFBQSxTQ3JCQSxXQTBDQSxRQUFBQyxHQUFBQyxFQUFBQyxHQUNBLElBQUEsR0FBQXZDLEtBQUF1QyxHQUNBLEdBQUFBLEVBQUFDLGVBQUF4QyxHQUFBLENBQ0EsR0FBQUMsR0FBQXNDLEVBQUF2QyxFQUNBLGlCQUFBQyxHQUNBb0MsRUFBQUMsRUFBQXRDLEdBQUF1QyxFQUFBdkMsSUFFQXNDLEVBQUF0QyxHQUFBdUMsRUFBQXZDLElBaERBdUIsT0FBQWtCLFFBQUEsU0FBQUMsR0FDQXRDLEtBQUFzQyxTQUNBQyxXQUNBQyxTQUFBLFdBQ0EvQixVQUFBLGdCQUVBZ0MsTUFDQWhDLFVBQUEsV0FFQWlDLFFBQ0FqQyxVQUFBLGNBR0E2QixHQUFBLGdCQUFBQSxJQUNBTCxFQUFBakMsS0FBQXNDLFFBQUFBLEdBR0F0QyxLQUFBdUMsVUFBQUksU0FBQUMsY0FBQTVDLEtBQUFzQyxRQUFBQyxVQUFBQyxVQUNBeEMsS0FBQXVDLFVBQUFNLFNBQUE3QyxLQUFBc0MsUUFBQUMsVUFBQTlCLFdBRUFULEtBQUE4QyxHQUFBQyxHQUFBQyxRQUNBL0IsT0FBQXNCLFVBQUF0QixTQUNBQyxNQUFBcUIsVUFBQXJCLFVBR0FsQixLQUFBdUMsVUFBQVUsT0FBQWpELEtBQUE4QyxHQUFBSSxRQUVBbEQsS0FBQW1ELE9BQUEsR0FBQS9CLGNBQ0FpQixRQUFBMUMsVUFBQXlELGNBQUFwRCxNQUVBQSxLQUFBbUQsT0FBQXpCLEdBQUEsU0FBQSxTQUFBMkIsR0FDQUEsRUFBQVAsR0FBQUksT0FBQWpDLE9BQUFvQyxFQUFBZCxVQUFBdEIsU0FDQW9DLEVBQUFQLEdBQUFJLE9BQUFoQyxNQUFBbUMsRUFBQWQsVUFBQXJCLFNBR0EsSUFBQW9DLEdBQUF0RCxJQUNBbUIsUUFBQW9DLGlCQUFBLFNBQUEsU0FBQUMsR0FDQUYsRUFBQUgsT0FBQTdCLFFBQUEsU0FBQWdDLFNDdENBLFdBQ0FqQixRQUFBMUMsVUFBQThELFdBRUFwQixRQUFBMUMsVUFBQXlELGNBQUEsU0FBQUMsR0FDQSxJQUFBLEdBQUE5QixLQUFBYyxTQUFBMUMsVUFBQThELFFBQ0FKLEVBQUE5QixHQUFBLEdBQUFjLFNBQUExQyxVQUFBOEQsUUFBQWxDLEdBQUE4QixPQ0xBLFdBQ0FoQixRQUFBMUMsVUFBQThELFFBQUEsT0FBQSxTQUFBSixHQUNBLEdBQUFkLEdBQUFJLFNBQUFlLGNBQUEsTUFDQW5CLEdBQUFNLFNBQUFRLEVBQUFmLFFBQUFJLE9BQUFqQyxXQUNBNEMsRUFBQWQsVUFBQVUsT0FBQVYsRUFFQSxJQUFBb0IsR0FBQWhCLFNBQUFlLGNBQUEsTUFDQUMsR0FBQUMsVUFBQSxpQkFDQUQsRUFBQWQsU0FBQSxRQUNBTixFQUFBVSxPQUFBVSxHQUVBM0QsS0FBQTJELEtBQUEsU0FBQUUsR0FDQUYsRUFBQUMsVUFBQUMsR0FHQVIsRUFBQUYsT0FBQXpCLEdBQUEsY0FBQTFCLEtBQUEyRCxVQ2ZBLFdBQ0F0QixRQUFBMUMsVUFBQThELFFBQUEsS0FBQSxTQUFBSixHQUNBLEdBQUFkLEdBQUFJLFNBQUFlLGNBQUEsTUFDQW5CLEdBQUFNLFNBQUFRLEVBQUFmLFFBQUFHLEtBQUFoQyxXQUNBNEMsRUFBQWQsVUFBQVUsT0FBQVYsRUFFQSxJQUFBRSxHQUFBRSxTQUFBZSxjQUFBLEtBQ0FuQixHQUFBVSxPQUFBUixHQUVBekMsS0FBQThELE9BQ0FDLE9BRUFDLFVBQUEsV0FDQUMsUUFBQUMsSUFBQSxrQkFJQUMsU0FBQSxXQUNBZCxFQUFBRixPQUFBN0IsUUFBQSxjQUFBLG1CQUNBSCxPQUFBaUQsV0FBQSxXQUNBZixFQUFBRixPQUFBN0IsUUFBQSxjQUFBLFdBQ0EsTUFFQStDLE9BRUFDLGdCQUFBLFdBQ0FMLFFBQUFDLElBQUEsb0JBTUFsRSxLQUFBdUUsT0FBQSxXQUNBLElBQUEsR0FBQUMsS0FBQXhFLE1BQUE4RCxNQUFBLENBQ0EsR0FBQVcsR0FBQTlCLFNBQUFlLGNBQUEsS0FDQWUsR0FBQWIsVUFBQVksRUFDQUMsRUFBQTVCLFNBQUEyQixFQUVBLElBQUEzRSxHQUFBRyxLQUFBOEQsTUFBQVUsRUFDQSxtQkFBQTNFLEtBQ0E0RSxFQUFBQyxRQUFBN0UsR0FHQTRDLEVBQUFRLE9BQUF3QixLQUdBekUsS0FBQXVFIiwiZmlsZSI6IndlYm1lc2gubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG5cclxuKChmdW5jdGlvbigpe1xyXG4gICAgc2FmZU92ZXJyaWRlKEFycmF5LnByb3RvdHlwZSwgJ3VuaXF1ZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBhID0gdGhpcy5jb25jYXQoKTtcclxuICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICBmb3IodmFyIGogPSBpICsgMTsgaiA8IGEubGVuZ3RoOyArK2opIHtcclxuICAgICAgICAgICAgICAgIGlmKGFbaV0gPT09IGFbal0pIGEuc3BsaWNlKGotLSwgMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGE7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzYWZlT3ZlcnJpZGUoSFRNTEVsZW1lbnQucHJvdG90eXBlLCAnYWRkQ2xhc3MnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBmb3IodmFyIGkgaW4gYXJndW1lbnRzKXtcclxuICAgICAgICAgICAgdmFyIG9sZENsYXNzTmFtZXMgPSAhdGhpcy5jbGFzc05hbWUgPyBbXSA6IHRoaXMuY2xhc3NOYW1lLnRyaW0oKS5yZXBsYWNlKC9cXHMrL2csICcgJykuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgdmFyIG5ld0NsYXNzTmFtZXMgPSAhYXJndW1lbnRzW2ldID8gW10gOiBhcmd1bWVudHNbaV0udHJpbSgpLnJlcGxhY2UoL1xccysvZywgJyAnKS5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICB0aGlzLmNsYXNzTmFtZSA9IG9sZENsYXNzTmFtZXMuY29uY2F0KG5ld0NsYXNzTmFtZXMpLnVuaXF1ZSgpLmpvaW4oJyAnKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBzYWZlT3ZlcnJpZGUoSFRNTEVsZW1lbnQucHJvdG90eXBlLCAnaGVpZ2h0JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkuaGVpZ2h0O1xyXG4gICAgfSk7XHJcblxyXG4gICAgc2FmZU92ZXJyaWRlKEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ3dpZHRoJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg7XHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBzYWZlT3ZlcnJpZGUocHJvdG90eXBlLCBwcm9wZXJ0eSwgdmFsdWUpIHtcclxuICAgICAgICBpZighcHJvdG90eXBlW3Byb3BlcnR5XSkgcHJvdG90eXBlW3Byb3BlcnR5XSA9IHZhbHVlO1xyXG4gICAgfVxyXG59KSgpKTtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuKChmdW5jdGlvbigpIHtcclxuICAgIHdpbmRvdy5FdmVudEhhbmRsZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB0aGlzLmxpc3RlbmVycyA9IHt9O1xyXG4gICAgICAgIHRoaXMudHJpZ2dlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgbmFtZSA9IGFyZ3VtZW50c1swXTtcclxuICAgICAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMubGlzdGVuZXJzW25hbWVdIHx8IFtdO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3RlbmVycy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNwbGljZS5jYWxsKGFyZ3VtZW50cywgMCwgMSk7XHJcbiAgICAgICAgICAgICAgICBsaXN0ZW5lcnNbaV0uYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5vbiA9IGZ1bmN0aW9uKG5hbWUsIGNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5saXN0ZW5lcnNbbmFtZV0pIHRoaXMubGlzdGVuZXJzW25hbWVdID0gW107XHJcbiAgICAgICAgICAgIHRoaXMubGlzdGVuZXJzW25hbWVdLnB1c2goY2FsbGJhY2spO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5vZmYgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmxpc3RlbmVyc1tuYW1lXTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMub2ZmID0gZnVuY3Rpb24obmFtZSwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMubGlzdGVuZXJzW25hbWVdKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYXJyYXkgPSB0aGlzLmxpc3RlbmVyc1tuYW1lXTtcclxuICAgICAgICAgICAgICAgIGlmIChhcnJheS5pbmRleE9mKGNhbGxiYWNrKSA+IC0xKSBhcnJheS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbn0pKCkpO1xyXG4iLCIndXNlIHN0cmljdCc7XHJcblxyXG4oZnVuY3Rpb24oKXtcclxuICAgIHdpbmRvdy5XZWJNZXNoID0gZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgY29udGFpbmVyOiB7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJyN3ZWJtZXNoJyxcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ3dtLWNvbnRhaW5lcidcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWVudToge1xyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnd20tbWVudSdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbG9nZ2VyOiB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICd3bS1sb2dnZXInXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGlmIChvcHRpb25zICYmIHR5cGVvZiBvcHRpb25zID09PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICBleHRlbmQodGhpcy5vcHRpb25zLCBvcHRpb25zKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm9wdGlvbnMuY29udGFpbmVyLnNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuY29udGFpbmVyLmNsYXNzTmFtZSk7XHJcblxyXG4gICAgICAgIHRoaXMuZ2wgPSBHTC5jcmVhdGUoe1xyXG4gICAgICAgICAgICBoZWlnaHQ6IGNvbnRhaW5lci5oZWlnaHQoKSxcclxuICAgICAgICAgICAgd2lkdGg6IGNvbnRhaW5lci53aWR0aCgpXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZCh0aGlzLmdsLmNhbnZhcyk7XHJcblxyXG4gICAgICAgIHRoaXMuZXZlbnRzID0gbmV3IEV2ZW50SGFuZGxlcigpO1xyXG4gICAgICAgIFdlYk1lc2gucHJvdG90eXBlLmVuYWJsZVBsdWdpbnModGhpcyk7XHJcblxyXG4gICAgICAgIHRoaXMuZXZlbnRzLm9uKCdyZXNpemUnLCBmdW5jdGlvbihpbnN0YW5jZSkge1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5nbC5jYW52YXMuaGVpZ2h0ID0gaW5zdGFuY2UuY29udGFpbmVyLmhlaWdodCgpO1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5nbC5jYW52YXMud2lkdGggPSBpbnN0YW5jZS5jb250YWluZXIud2lkdGgoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIHNjb3BlID0gdGhpcztcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgc2NvcGUuZXZlbnRzLnRyaWdnZXIoJ3Jlc2l6ZScsIHNjb3BlKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcblxyXG4gICAgZnVuY3Rpb24gZXh0ZW5kKHNvdXJjZSwgcHJvcGVydGllcyl7XHJcbiAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gcHJvcGVydGllcykge1xyXG4gICAgICAgICAgICBpZiAocHJvcGVydGllcy5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eSkpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHByb3BlcnRpZXNbcHJvcGVydHldO1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBleHRlbmQoc291cmNlW3Byb3BlcnR5XSwgcHJvcGVydGllc1twcm9wZXJ0eV0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzb3VyY2VbcHJvcGVydHldID0gcHJvcGVydGllc1twcm9wZXJ0eV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0oKSk7XHJcbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbigoZnVuY3Rpb24oKSB7XHJcbiAgICBXZWJNZXNoLnByb3RvdHlwZS5wbHVnaW5zID0ge307XHJcblxyXG4gICAgV2ViTWVzaC5wcm90b3R5cGUuZW5hYmxlUGx1Z2lucyA9IGZ1bmN0aW9uKGluc3RhbmNlKSB7XHJcbiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBXZWJNZXNoLnByb3RvdHlwZS5wbHVnaW5zKVxyXG4gICAgICAgICAgICBpbnN0YW5jZVtuYW1lXSA9IG5ldyBXZWJNZXNoLnByb3RvdHlwZS5wbHVnaW5zW25hbWVdKGluc3RhbmNlKTtcclxuICAgIH07XHJcbn0pKCkpO1xyXG4iLCIndXNlIHN0cmljdCc7XHJcblxyXG4oKGZ1bmN0aW9uKCl7XHJcbiAgICBXZWJNZXNoLnByb3RvdHlwZS5wbHVnaW5zWydsb2dnZXInXSA9IGZ1bmN0aW9uKGluc3RhbmNlKSB7XHJcbiAgICAgICAgdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0RJVicpO1xyXG4gICAgICAgIGNvbnRhaW5lci5hZGRDbGFzcyhpbnN0YW5jZS5vcHRpb25zLmxvZ2dlci5jbGFzc05hbWUpO1xyXG4gICAgICAgIGluc3RhbmNlLmNvbnRhaW5lci5hcHBlbmQoY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgdmFyIGluZm8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcclxuICAgICAgICBpbmZvLmlubmVySFRNTCA9ICdMb3JlbSBpcHN1bS4uLic7XHJcbiAgICAgICAgaW5mby5hZGRDbGFzcygnaW5mbycpO1xyXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmQoaW5mbyk7XHJcblxyXG4gICAgICAgIHRoaXMuaW5mbyA9IGZ1bmN0aW9uKHRleHQpIHtcclxuICAgICAgICAgICAgaW5mby5pbm5lckhUTUwgPSB0ZXh0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaW5zdGFuY2UuZXZlbnRzLm9uKCdsb2dnZXIuaW5mbycsIHRoaXMuaW5mbyk7XHJcbiAgICB9O1xyXG59KSgpKTtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuKChmdW5jdGlvbigpe1xyXG4gICAgV2ViTWVzaC5wcm90b3R5cGUucGx1Z2luc1snbWVudSddID0gZnVuY3Rpb24oaW5zdGFuY2UpIHtcclxuICAgICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XHJcbiAgICAgICAgY29udGFpbmVyLmFkZENsYXNzKGluc3RhbmNlLm9wdGlvbnMubWVudS5jbGFzc05hbWUpO1xyXG4gICAgICAgIGluc3RhbmNlLmNvbnRhaW5lci5hcHBlbmQoY29udGFpbmVyKTtcclxuXHJcbiAgICAgICAgdmFyIG1lbnUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdVTCcpO1xyXG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmQobWVudSk7XHJcblxyXG4gICAgICAgIHRoaXMuaXRlbXMgPSB7XHJcbiAgICAgICAgICAgICdGaWxlJzogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICdMb2FkLi4uJzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpdGVtIGNsaWNrIScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgJ0FsZXJ0ISc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuZXZlbnRzLnRyaWdnZXIoJ2xvZ2dlci5pbmZvJywgJ0xPT0sgQVQgTUUhIE9fTycpO1xyXG4gICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5ldmVudHMudHJpZ2dlcignbG9nZ2VyLmluZm8nLCAnU1RBUEghJyk7XHJcbiAgICAgICAgICAgICAgICB9LCAyMDAwKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ0hlbHAnOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ0Fib3V0IFdlYk1lc2gnOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Fib3V0IHdoYXQ/IScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGZvcih2YXIgaXRlbSBpbiB0aGlzLml0ZW1zKXtcclxuICAgICAgICAgICAgICAgIHZhciBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ0xJJyk7XHJcbiAgICAgICAgICAgICAgICBsaS5pbm5lckhUTUwgPSBpdGVtO1xyXG4gICAgICAgICAgICAgICAgbGkuYWRkQ2xhc3MoaXRlbSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5pdGVtc1tpdGVtXTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICBsaS5vbmNsaWNrID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgbWVudS5hcHBlbmQobGkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLnVwZGF0ZSgpO1xyXG4gICAgfTtcclxufSkoKSk7XHJcbiJdfQ==
