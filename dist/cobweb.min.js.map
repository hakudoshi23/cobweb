{"version":3,"sources":["ajax.js","array.js","html.js","obj.js","tree.js","events.js","logger.js","cobweb.js","modules.js","math/plane.js","math/ray.js","pane/pane-header.js","pane/pane-types.js","pane/panes.js","pane/surface/surface.js","pane/surface/interaction/common-interaction.js","pane/surface/interaction/object-interaction.js","pane/surface/interaction/surface-interaction.js","pane/surface/render/render-solid.js","pane/surface/render/surface-render.js","graphic.js","scene.js"],"names":["ajax","options","_extend","defaultAjaxOptions","xhttp","XMLHttpRequest","onreadystatechange","this","readyState","status","success","response","error","method","params","objToParams","data","urlWithParams","url","open","async","send","get","Ajax","getJSON","JSON","parse","post","obj","key","nextParam","encodeURIComponent","slice","defaults","prop","hasOwnProperty","value","window","safeExtend","prototype","property","Array","a","concat","i","length","j","splice","callback","s4","Math","floor","random","toString","substring","HTMLElement","oldClassNames","newClassNames","arguments","className","trim","replace","split","unique","join","queryClassNames","currentClassNames","index","name","indexOf","removeClassNames","removeEach","forEach","attr","__data_cache","WeakMap","elAttrs","undefined","set","setAttribute","getAttribute","removeAttribute","Element","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","s","matches","document","ownerDocument","querySelectorAll","item","query","parentElement","current","clientHeight","style","height","clientWidth","width","guid","overlap","querySelector","Object","newObj","clone","extend","TreeNode","parent","children","isRoot","add","child","constructor","push","remove","dfs","check","out","bfs","_TreeNode","call","create","EventHandler","isDebug","listeners","trigger","console","debug","apply","on","off","array","reset","own","keys","Logger","instance","handlers","addHandler","level","ALL","args","DEBUG","INFO","info","WARNING","warn","ERROR","log","warning","tmp","levelHandlers","handler","removeHandler","NONE","defaultOptions","container","selector","Cobweb","Error","addClass","logger","events","modules","Modules","onLoadedAll","names","topologicalSort","sortedNames","module","dependencies","depName","nextName","candidates","getInitialCandidates","dependant","dependantName","allDependenciesMet","loadedUntilNow","runCallback","callbacks","isFunction","all","init","ex","dependencyModule","moduleName","Plane","point","normal","vec3","normalize","Ray","start","direction","fromPoints","b","sub","onCreateCallback","pane","header","createHeader","append","div","createElement","oldPane","newPane","oldType","attrData","setType","types","typeCallbacks","onPaneType","paneHeader","onCreateHeader","dataset","paneType","onPaneCreate","onPaneSplit","origin","onPaneResize","internal","Pane","separator","size","root","onSurfacePaneType","canvas","id","surfaceIndex","surface","map","proj","mat4","center","rotation","distance","getViewMatrix","view","eye","getCameraPosition","lookAt","getUpDirection","rotateX","rotateY","getCameraDirection","getRayFromCamera","ray","canvasCoords","canvasSize","auxMat","multiply","invert","transformMat4","up","vRotation","PI","updateCanvasSize","onCreateSurfaceHeader","label","innerHTML","appendChild","context","getContext","headerHeight","imgData","createImageData","buffer","Uint8Array","perspective","DEG2RAD","addEventListener","event","surfaces","parentNode","combine","originalRotation","delta","upNormalMouseDown","clampRotations","getCoordsDelta","initial","rotations","pi2","mouseDownCoords","interactions","common","onMouseWheel","realCoords","target","max","min","wheelDelta","detail","onMouseMove","moving","onMouseDown","which","equals","isHit","hitPoint","scene","getObjects","node","geo","testRayBBox","mesh","bounding","model","selected","onMouseUp","onClick","object","setInteraction","getLocalCoordinates","type","layerX","layerY","onSurfaceEvent","getInteractionCallbacks","keepRunning","onContextMenu","preventDefault","interaction","interactionName","oncontextmenu","onmousewheel","onmousemove","onmousedown","onmouseup","onclick","initialValue","renderObject","shader","temp","uniforms","u_mvp","u_color","u_model","draw","primitive","firstSource","grid","Shader","graphics","gl","LINES","GL","Mesh","lines","renders","solid","lightDirection","u_lightvector","setRender","render","getRender","renderName","panes","drawRenderTarget","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","viewport","readPixels","RGBA","UNSIGNED_BYTE","putImageData","Graphics","screen","animate","ondraw","renderTargets","clearColor","enable","DEPTH_TEST","TRIANGLES","cube","color","intensity","getLights"],"mappings":"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","file":"cobweb.min.js","sourcesContent":["((function(){\r\n    'use strict';\r\n\r\n    var defaultAjaxOptions = {\r\n        method: 'GET',\r\n        url: '',\r\n        data: {},\r\n        async: true,\r\n        success: null,\r\n        error: null\r\n    };\r\n\r\n    function ajax (options) {\r\n        _extend(options || {}, defaultAjaxOptions);\r\n        var xhttp = new XMLHttpRequest();\r\n        xhttp.onreadystatechange = function() {\r\n            if (this.readyState == 4) {\r\n                if (this.status == 200) {\r\n                    if (options.success) options.success(this.response);\r\n                } else {\r\n                    if (options.error) error.success(this.response);\r\n                }\r\n            }\r\n        };\r\n        if (options.method === 'GET') {\r\n            var params = objToParams(options.data);\r\n            var urlWithParams = options.url + (params ? '?' + params : '');\r\n            xhttp.open(options.method, urlWithParams, options.async);\r\n            xhttp.send();\r\n        } else if (options.method === 'POST') {\r\n            xhttp.open(options.method, options.url, options.async);\r\n            xhttp.send(options.data);\r\n        }\r\n        return xhttp;\r\n    }\r\n\r\n    function get (url, data, success) {\r\n        if (!success) {\r\n            success = data;\r\n            data = null;\r\n        }\r\n        return Ajax.ajax({\r\n            url: url,\r\n            data: data,\r\n            success: success,\r\n            method: 'GET'\r\n        });\r\n    }\r\n\r\n    function getJSON (url, data, success) {\r\n        if (!success) {\r\n            success = data;\r\n            data = null;\r\n        }\r\n        return Ajax.ajax({\r\n            url: url,\r\n            data: data,\r\n            success: function (response) {\r\n                success(JSON.parse(response));\r\n            },\r\n            method: 'GET'\r\n        });\r\n    }\r\n\r\n    function post (url, data, success) {\r\n        if (!success) {\r\n            success = data;\r\n            data = null;\r\n        }\r\n        return Ajax.ajax({\r\n            url: url,\r\n            data: data,\r\n            success: success,\r\n            method: 'POST'\r\n        });\r\n    }\r\n\r\n    window.Ajax = {\r\n        ajax: ajax,\r\n        get: get,\r\n        getJSON: getJSON,\r\n        post: post\r\n    };\r\n\r\n    function objToParams (obj) {\r\n        var params = '';\r\n        for (var key in obj) {\r\n            var nextParam = key + '=' + encodeURIComponent(obj[key]);\r\n            params += '&' + nextParam;\r\n        }\r\n        return params.slice(1);\r\n    }\r\n\r\n    function _extend(options, defaults) {\r\n        for (var prop in defaults) {\r\n            if (prop && defaults.hasOwnProperty(prop)) {\r\n                var value = defaults[prop];\r\n                if (typeof value === 'object') {\r\n                    if (options[prop]) {\r\n                        _extend(options[prop], value);\r\n                    } else\r\n                        options[prop] = value;\r\n                } else if (typeof options[prop] === 'undefined')\r\n                    options[prop] = value;\r\n            }\r\n        }\r\n    }\r\n})());\r\n","((function(){\r\n    'use strict';\r\n\r\n    safeExtend(Array.prototype, 'unique', function() {\r\n        var a = this.concat();\r\n        for(var i = 0; i < a.length; ++i)\r\n            for(var j = i + 1; j < a.length; ++j)\r\n                if(a[i] === a[j]) a.splice(j--, 1);\r\n        return a;\r\n    });\r\n\r\n    safeExtend(Array.prototype, 'forEach', function(callback) {\r\n        for (var i = 0; i < this.length; i++)\r\n            callback(this[i], i, this);\r\n    });\r\n\r\n    function safeExtend(prototype, property, value) {\r\n        if(!prototype[property]) prototype[property] = value;\r\n    }\r\n})());\r\n","((function(){\r\n    'use strict';\r\n\r\n    safeExtend(HTMLElement.prototype, 'addClass', function () {\r\n        var oldClassNames, newClassNames;\r\n        for(var i in arguments){\r\n            oldClassNames = !this.className ? [] : this.className.trim().replace(/\\s+/g, ' ').split(' ');\r\n            newClassNames = !arguments[i] ? [] : arguments[i].trim().replace(/\\s+/g, ' ').split(' ');\r\n            this.className = oldClassNames.concat(newClassNames).unique().join(' ');\r\n        }\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'hasClass', function () {\r\n        var queryClassNames, currentClassNames = !this.className ? [] : this.className.trim().replace(/\\s+/g, ' ').split(' ');\r\n        for(var i in arguments){\r\n            queryClassNames = !arguments[i] ? [] : arguments[i].trim().replace(/\\s+/g, ' ').split(' ');\r\n            for (var index = 0; index < queryClassNames.length; index++) {\r\n                var name = queryClassNames[index];\r\n                if (currentClassNames.indexOf(name) == -1)\r\n                    return false;\r\n            }\r\n        }\r\n        return true;\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'removeClass', function () {\r\n        var index = 0, currentClassNames, removeClassNames;\r\n        var removeEach = function (name) {\r\n            index = currentClassNames.indexOf(name);\r\n            if (index != -1)\r\n                currentClassNames.splice(index, 1);\r\n        };\r\n        for(var i in arguments){\r\n            currentClassNames = !this.className ? [] : this.className.trim().replace(/\\s+/g, ' ').split(' ');\r\n            removeClassNames = !arguments[i] ? [] : arguments[i].trim().replace(/\\s+/g, ' ').split(' ');\r\n            removeClassNames.forEach(removeEach);\r\n            this.className = currentClassNames.unique().join(' ');\r\n        }\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'data', function (attr, value) {\r\n        if (!window.__data_cache) window.__data_cache = new WeakMap();\r\n        var elAttrs = window.__data_cache.get(this) || {};\r\n        if (value !== undefined) {\r\n            elAttrs[attr] = value;\r\n            window.__data_cache.set(this, elAttrs);\r\n        } else {\r\n            if (attr) return elAttrs && elAttrs[attr];\r\n            else return elAttrs;\r\n        }\r\n        return this;\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'setData', function (data) {\r\n        if (!window.__data_cache) window.__data_cache = new WeakMap();\r\n        window.__data_cache.set(this, data);\r\n        return this;\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'attr', function (name, value) {\r\n        if (value !== undefined)\r\n            this.setAttribute(name, value);\r\n        else if (value === null)\r\n            this.removeAttribute(name);\r\n        else\r\n            return this.getAttribute(name);\r\n        return this;\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'attrData', function (name, value) {\r\n        return this.attr('data-' + name, value);\r\n    });\r\n\r\n    safeExtend(Element.prototype, 'matches',\r\n        Element.prototype.matchesSelector ||\r\n        Element.prototype.mozMatchesSelector ||\r\n        Element.prototype.msMatchesSelector ||\r\n        Element.prototype.oMatchesSelector ||\r\n        Element.prototype.webkitMatchesSelector ||\r\n        function(s) {\r\n            var matches = (this.document || this.ownerDocument).querySelectorAll(s),\r\n                i = matches.length;\r\n            while (--i >= 0 && matches.item(i) !== this) {}\r\n            return i > -1;\r\n        }\r\n    );\r\n\r\n    safeExtend(HTMLElement.prototype, 'parent', function (query) {\r\n        if (!query) return this.parentElement;\r\n        var current = this.parentElement;\r\n        while (!current.matches(query))\r\n            current = current.parentElement;\r\n        return current;\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'height', function () {\r\n        if (arguments.length == 1) {\r\n            var value = arguments[0];\r\n            if (typeof value === 'number')\r\n                this.style.height = value + 'px';\r\n            else\r\n                this.style.height = value;\r\n        } else\r\n            return this.clientHeight;\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'width', function () {\r\n        if (arguments.length == 1) {\r\n            var value = arguments[0];\r\n            if (typeof value === 'number')\r\n                this.style.width = value + 'px';\r\n            else\r\n                this.style.width = value;\r\n        } else\r\n            return this.clientWidth;\r\n    });\r\n\r\n    safeExtend(window, 'guid', function () {\r\n        return 'GUID-' + s4() + '-' + s4() + '-' + s4();\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'guid', function () {\r\n        var guid = null, overlap = null;\r\n        do {\r\n            guid = window.guid();\r\n            overlap = document.querySelector('#' + guid);\r\n        } while(overlap);\r\n        this.attr('id', guid);\r\n        return guid;\r\n    });\r\n\r\n    function safeExtend(prototype, property, value) {\r\n        if(!prototype[property]) prototype[property] = value;\r\n    }\r\n\r\n    function s4() {\r\n        return Math.floor((1 + Math.random()) * 0x10000)\r\n            .toString(16).substring(1);\r\n    }\r\n})());\r\n","((function(){\r\n    'use strict';\r\n\r\n    safeExtend(Object, 'clone', function (obj) {\r\n        var newObj = {};\r\n        for (var property in obj)\r\n            if (obj.hasOwnProperty(property)) {\r\n                var value = obj[property];\r\n                if (typeof value === 'object')\r\n                    newObj[property] = Object.clone(obj[property]);\r\n                else\r\n                    newObj[property] = obj[property];\r\n            }\r\n        return newObj;\r\n    });\r\n\r\n    function safeExtend(prototype, property, value) {\r\n        if(!prototype[property]) prototype[property] = value;\r\n    }\r\n\r\n    window.extend = _extend;\r\n\r\n    function _extend(options, defaults) {\r\n        for (var prop in defaults) {\r\n            if (prop && defaults.hasOwnProperty(prop)) {\r\n                var value = defaults[prop];\r\n                if (typeof value === 'object') {\r\n                    if (options[prop]) {\r\n                        _extend(options[prop], value);\r\n                    } else\r\n                        options[prop] = value;\r\n                } else if (typeof options[prop] === 'undefined')\r\n                    options[prop] = value;\r\n            }\r\n        }\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var TreeNode = function (parent, data) {\r\n        this.data = data || {};\r\n        this.parent = parent;\r\n        this.children = [];\r\n    };\r\n\r\n    window.TreeNode = TreeNode;\r\n\r\n    TreeNode.prototype.isRoot = function () {\r\n        return !this.parent;\r\n    };\r\n\r\n    TreeNode.prototype.add = function (data) {\r\n        var child = new this.constructor(this, data);\r\n        this.children.push(child);\r\n        return child;\r\n    };\r\n\r\n    TreeNode.prototype.remove = function (index) {\r\n        this.children.slice(index, 1);\r\n        return this;\r\n    };\r\n\r\n    TreeNode.prototype.dfs = function (check) {\r\n        var out = [];\r\n        for (var i = 0; i < this.children.length; i++) {\r\n            if (!check || (check && check(this.children[i])))\r\n                out.push(this.children[i]);\r\n            out.concat(this.children[i].dfs(check));\r\n        }\r\n        return out;\r\n    };\r\n\r\n    TreeNode.prototype.bfs = function (check) {\r\n        var out = [], i;\r\n        for (i = 0; i < this.children.length; i++)\r\n            if (!check || (check && check(this.children[i])))\r\n                out.push(this.children[i]);\r\n        for (i = 0; i < this.children.length; i++)\r\n            out.concat(this.children[i].bfs(check));\r\n        return out;\r\n    };\r\n\r\n    TreeNode.extend = function (defaults) {\r\n        var _TreeNode = function (parent, data) {\r\n            TreeNode.call(this, parent, data);\r\n        };\r\n        _TreeNode.prototype = Object.create(TreeNode.prototype);\r\n        _TreeNode.prototype.constructor = _TreeNode;\r\n        extend(_TreeNode.prototype, defaults);\r\n        return new _TreeNode(null);\r\n    };\r\n})());\r\n","((function() {\r\n    'use strict';\r\n\r\n    var EventHandler = function (isDebug) {\r\n        this.isDebug = !!isDebug;\r\n        this.listeners = {};\r\n    };\r\n\r\n    EventHandler.prototype.trigger = function() {\r\n        var name = arguments[0];\r\n        var listeners = this.listeners[name] || [];\r\n        Array.prototype.splice.call(arguments, 0, 1);\r\n        if (this.isDebug) console.debug(name, arguments);\r\n        for (var i = 0; i < listeners.length; i++)\r\n            listeners[i].apply(null, arguments);\r\n    };\r\n\r\n    EventHandler.prototype.on = function(name, callback) {\r\n        if (!this.listeners[name]) this.listeners[name] = [];\r\n        this.listeners[name].push(callback);\r\n    };\r\n\r\n    EventHandler.prototype.off = function(name) {\r\n        delete this.listeners[name];\r\n    };\r\n\r\n    EventHandler.prototype.off = function(name, callback) {\r\n        if (this.listeners[name]) {\r\n            var array = this.listeners[name];\r\n            if (array.indexOf(callback) > -1) array.splice(index, 1);\r\n        }\r\n    };\r\n\r\n    EventHandler.prototype.reset = function() {\r\n        var own = this;\r\n        Object.keys(this.listeners).forEach(function(key) {\r\n            delete own.listeners[key];\r\n        });\r\n    };\r\n\r\n    window.EventHandler = EventHandler;\r\n})());\r\n","/* jshint loopfunc:true */\r\n\r\n((function(){\r\n    'use strict';\r\n\r\n    var Logger = function (instance) {\r\n        this.handlers = [];\r\n\r\n        this.addHandler(this.level.ALL, function (level, args) {\r\n            if (Logger.prototype.level.DEBUG === level) {\r\n                console.debug.apply(this, args);\r\n            } else if (Logger.prototype.level.INFO === level) {\r\n                console.info.apply(this, args);\r\n            } else if (Logger.prototype.level.WARNING === level) {\r\n                console.warn.apply(this, args);\r\n            } else if (Logger.prototype.level.ERROR === level) {\r\n                console.error.apply(this, args);\r\n            }\r\n        });\r\n    };\r\n\r\n    Logger.prototype.debug = function () {\r\n        this.log(Logger.prototype.level.DEBUG, arguments);\r\n    };\r\n\r\n    Logger.prototype.info = function () {\r\n        this.log(Logger.prototype.level.INFO, arguments);\r\n    };\r\n\r\n    Logger.prototype.warning = function () {\r\n        this.log(Logger.prototype.level.WARNING, arguments);\r\n    };\r\n\r\n    Logger.prototype.error = function () {\r\n        this.log(Logger.prototype.level.ERROR, arguments);\r\n    };\r\n\r\n    Logger.prototype.log = function (level, args) {\r\n        var tmp = level;\r\n        var levelHandlers = this.handlers[tmp] || [];\r\n        while (tmp >= 0) {\r\n            levelHandlers.forEach(function (handler) {\r\n                handler(level, args);\r\n            });\r\n            levelHandlers = this.handlers[--tmp] || [];\r\n        }\r\n    };\r\n\r\n    Logger.prototype.addHandler = function (level, callback) {\r\n        if (!this.handlers[level])\r\n            this.handlers[level] = [];\r\n        this.handlers[level].push(callback);\r\n    };\r\n\r\n    Logger.prototype.removeHandler = function (level, callback) {\r\n        var levelHandlers = this.handlers[level];\r\n        if (levelHandlers) {\r\n            var index = levelHandlers.indexOf(callback);\r\n            if (index > -1)\r\n                levelHandlers.splice(index, 1);\r\n        }\r\n    };\r\n\r\n    Logger.prototype.level = {\r\n        ALL: 0,\r\n        DEBUG: 1,\r\n        INFO: 2,\r\n        WARNING: 3,\r\n        ERROR: 4,\r\n        NONE: 5,\r\n    };\r\n\r\n    window.Logger = Logger;\r\n})());\r\n","(function(){\r\n    'use strict';\r\n\r\n    var defaultOptions = {\r\n        container: {\r\n            selector: '#cobweb',\r\n            className: 'cb-container'\r\n        }\r\n    };\r\n\r\n    var Cobweb = function (options) {\r\n        var instance = this;\r\n\r\n        this.options = options || {};\r\n        extend(this.options, defaultOptions);\r\n\r\n        this.container = document.querySelector(this.options.container.selector);\r\n        if (!this.container)\r\n            throw new Error('Invalid container selector: \\'' +\r\n                this.options.container.selector + '\\'');\r\n        this.container.addClass(this.options.container.className);\r\n        this.container.data('instance', this);\r\n\r\n        this.logger = new Logger(this, true);\r\n        this.events = new EventHandler(true);\r\n        this.modules = new Modules([this], {\r\n            onLoadedAll: function (names) {\r\n                instance.events.trigger('modules.loaded.all', names);\r\n                instance.events.trigger('app.loaded');\r\n            }\r\n        });\r\n    };\r\n\r\n    window.Cobweb = Cobweb;\r\n}());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var Modules = function (params, callbacks) {\r\n        callbacks = callbacks || {};\r\n        var modules = Modules.prototype.all;\r\n        try {\r\n            var sortedNames = topologicalSort(modules);\r\n            for (var i = 0; i < sortedNames.length; i++ ) {\r\n                var name = sortedNames[i];\r\n                var module = modules[name];\r\n                try {\r\n                    module.init.apply(this, params);\r\n                    runCallback(callbacks, 'onLoaded', [name, module]);\r\n                } catch (ex) {\r\n                    console.error('Error loading module:', name, ex);\r\n                    runCallback(callbacks, 'onError', [ex, name, module]);\r\n                }\r\n            }\r\n            runCallback(callbacks, 'onLoadedAll', [sortedNames]);\r\n        } catch (ex) {\r\n            console.error('Error loading modules:', ex);\r\n        }\r\n    };\r\n\r\n    Modules.prototype.all = {};\r\n    Modules.prototype.add = function (name, init, dependencies) {\r\n        dependencies = dependencies || [];\r\n\r\n        var dependant = [];\r\n        var dependencyModule, i;\r\n        for (var moduleName in this.all) {\r\n            var module = this.all[moduleName];\r\n            for (i = 0; i < module.dependencies.length; i++)\r\n                if (module.dependencies[i] === name)\r\n                    dependant.push(moduleName);\r\n        }\r\n        for (i = 0; i < dependencies.length; i++) {\r\n            dependencyModule = this.all[dependencies[i]];\r\n            if (dependencyModule) dependencyModule.dependant.push(name);\r\n        }\r\n\r\n        this.all[name] = {\r\n            dependencies: dependencies,\r\n            dependant: dependant,\r\n            init: init\r\n        };\r\n    };\r\n\r\n    window.Modules = Modules;\r\n\r\n    function topologicalSort (modules) {\r\n        var sortedNames = [];\r\n\r\n        var module = null, i = 0;\r\n        for (var name in modules) {\r\n            module = modules[name];\r\n            for (i = 0; i < module.dependencies.length; i++) {\r\n                var depName = module.dependencies[i];\r\n                if (!modules[depName])\r\n                    throw new Error('Missing module: ' + depName);\r\n            }\r\n        }\r\n\r\n        var nextName = null;\r\n        var candidates = getInitialCandidates(modules);\r\n        while (candidates.length > 0) {\r\n            nextName = candidates.splice(0, 1)[0];\r\n            module = modules[nextName];\r\n            if (module) {\r\n                sortedNames.push(nextName);\r\n                for (i = 0; i < module.dependant.length; i++) {\r\n                    var dependantName = module.dependant[i];\r\n                    if (allDependenciesMet(sortedNames, modules[dependantName]))\r\n                        candidates.push(dependantName);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (Object.keys(modules).length !== sortedNames.length)\r\n            throw new Error('Dependency cycle!');\r\n\r\n        return sortedNames;\r\n    }\r\n\r\n    function getInitialCandidates (modules) {\r\n        var candidates = [];\r\n        for (var name in modules)\r\n            if (modules[name].dependencies.length === 0)\r\n                candidates.push(name);\r\n        return candidates;\r\n    }\r\n\r\n    function allDependenciesMet (loadedUntilNow, module) {\r\n        for (var i = 0; i < module.dependencies.length; i++)\r\n            if (loadedUntilNow.indexOf(module.dependencies[i]) === -1) return false;\r\n        return true;\r\n    }\r\n\r\n    function runCallback (callbacks, name, params) {\r\n        var callback = callbacks[name];\r\n        var isFunction = typeof callback === 'function';\r\n        if (isFunction) callback.apply(null, params);\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    window.Math = window.Math || {};\r\n\r\n    var Plane = function (point, normal) {\r\n        this.normal = normal || [0, 1, 0];\r\n        this.point = point || vec3.create();\r\n        vec3.normalize(this.normal, this.normal);\r\n    };\r\n\r\n    window.Math.Plane = Plane;\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    window.Math = window.Math || {};\r\n\r\n    var Ray = function (start, direction) {\r\n        this.direction = direction || [0, 0, 1];\r\n        this.start = start || vec3.create();\r\n        vec3.normalize(this.direction, this.direction);\r\n    };\r\n\r\n    Ray.fromPoints = function (a, b) {\r\n        var direction = vec3.create();\r\n        vec3.sub(direction, b, a);\r\n        return new Ray(a, direction);\r\n    };\r\n\r\n    window.Math.Ray = Ray;\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('pane-header', function (instance) {\r\n        instance.events.on('pane.create', function (pane) {\r\n            onCreateCallback(pane, instance);\r\n        });\r\n    }, ['pane-types']);\r\n\r\n    function onCreateCallback (pane, instance) {\r\n        var header = createHeader();\r\n        pane.append(header);\r\n    }\r\n\r\n    function createHeader () {\r\n        var div = document.createElement('div');\r\n        div.className = 'pane-header';\r\n        return div;\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('pane-types', function (instance) {\r\n\r\n        instance.events.on('pane.split', function (oldPane, newPane) {\r\n            var oldType = oldPane.attrData('pane-type');\r\n            if (oldType) instance.pane.setType(newPane, oldType);\r\n        });\r\n\r\n        instance.pane.types = {};\r\n\r\n        instance.pane.setType = function (pane, name) {\r\n            if (this.types[name]) {\r\n                var typeCallbacks = this.types[name];\r\n                typeCallbacks.onPaneType(pane, instance);\r\n                var paneHeader = pane.querySelector('.pane-header');\r\n                typeCallbacks.onCreateHeader(paneHeader, instance);\r\n                pane.dataset.paneType = name;\r\n            }\r\n        };\r\n    }, ['pane']);\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('pane', function (instance) {\r\n        instance.events.on('app.loaded', function () {\r\n            instance.pane.internal = new Pane({\r\n                container: instance.options.container.selector,\r\n                separator: {\r\n                    size: 3\r\n                },\r\n                callbacks: {\r\n                    onPaneCreate: onPaneCreate,\r\n                    onPaneSplit: onPaneSplit,\r\n                    onPaneResize: onPaneResize,\r\n                    //onPaneMerge: onPaneMerge,\r\n                    //onPaneDestroy: onPaneDestroy,\r\n                }\r\n            });\r\n\r\n            var root = instance.pane.internal.container.querySelector('.pane');\r\n            instance.pane.setType(root, 'surface');\r\n        });\r\n\r\n        instance.pane = {};\r\n\r\n        function onPaneCreate (pane) {\r\n            instance.events.trigger('pane.create', pane);\r\n        }\r\n\r\n        function onPaneSplit (origin, newPane) {\r\n            instance.events.trigger('pane.split', origin, newPane);\r\n        }\r\n\r\n        function onPaneResize (pane) {\r\n            instance.events.trigger('pane.resize', pane);\r\n        }\r\n\r\n        function onPaneMerge (merger, toRemove) {\r\n            console.debug('onPaneMerge', merger, toRemove);\r\n        }\r\n\r\n        function onPaneDestroy (pane) {\r\n            console.debug('onPaneDestroy', pane);\r\n        }\r\n    });\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var surfaceIndex = 0;\r\n\r\n    Modules.prototype.add('surface', function (instance) {\r\n        instance.pane.types.surface = {\r\n            onPaneType: onSurfacePaneType,\r\n            onCreateHeader: onCreateSurfaceHeader\r\n        };\r\n\r\n        instance.events.on('pane.resize', function (pane) {\r\n            if (pane.attrData('pane-type') === 'surface')\r\n                updateCanvasSize(instance, pane);\r\n        });\r\n\r\n        window.addEventListener('resize', function (event) {\r\n            var surfaces = instance.pane.internal.container\r\n                .querySelectorAll('.pane canvas');\r\n            for (var i = 0; i < surfaces.length; i++) {\r\n                updateCanvasSize(instance, surfaces[i].parentNode);\r\n            }\r\n        });\r\n\r\n        instance.surface = {};\r\n    }, ['pane-types']);\r\n\r\n    function onSurfacePaneType (pane, instance) {\r\n        var canvas = document.createElement('canvas');\r\n        canvas.id = 'surface' + (surfaceIndex++);\r\n        canvas.className = 'surface';\r\n        pane.append(canvas);\r\n\r\n        instance.surface.map = instance.surface.map || {};\r\n        instance.surface.map[canvas.id] = {};\r\n        instance.surface.map[canvas.id].surface = {\r\n            proj: mat4.create(),\r\n            center: [0, 0, 0],\r\n            rotation: [-0.5, -0.5],\r\n            distance: 12,\r\n            getViewMatrix: function (view) {\r\n                view = view || mat4.create();\r\n                var eye = [0, 0, 0];\r\n                this.getCameraPosition(eye);\r\n                mat4.lookAt(view, eye, this.center, this.getUpDirection());\r\n                return view;\r\n            },\r\n            getCameraPosition: function (eye) {\r\n                eye = eye || vec3.create();\r\n                vec3.set(eye, 0, 0, -this.distance);\r\n                vec3.rotateX(eye, eye, this.rotation[1]);\r\n                vec3.rotateY(eye, eye, -this.rotation[0]);\r\n                return eye;\r\n            },\r\n            getCameraDirection: function (direction) {\r\n                direction = direction || vec3.create();\r\n                var eye = this.getCameraPosition();\r\n                vec3.sub(direction, this.center, eye);\r\n                vec3.normalize(direction, direction);\r\n                return direction;\r\n            },\r\n            getRayFromCamera: function (ray, canvasCoords, canvasSize) {\r\n                ray = ray || new Math.Ray();\r\n                this.getCameraPosition(ray.start);\r\n                vec3.set(ray.direction, canvasCoords[0] / (canvasSize[0] * 0.5) - 1.0,\r\n                    canvasCoords[1] / (canvasSize[1] * 0.5) - 1.0, 1);\r\n                var auxMat = mat4.create();\r\n                mat4.multiply(auxMat, this.proj, this.getViewMatrix());\r\n                mat4.invert(auxMat, auxMat);\r\n                vec3.transformMat4(ray.direction, ray.direction, auxMat);\r\n                vec3.normalize(ray.direction, ray.direction);\r\n                return ray;\r\n            },\r\n            getUpDirection: function (up) {\r\n                up = up || vec3.create();\r\n                var vRotation = this.rotation[1];\r\n                if (vRotation >= Math.PI / 2 &&\r\n                    vRotation <= ((Math.PI * 3) / 2))\r\n                    vec3.set(up, 0, -1, 0);\r\n                else vec3.set(up, 0, 1, 0);\r\n                return up;\r\n            }\r\n        };\r\n\r\n        updateCanvasSize(instance, pane);\r\n\r\n        instance.events.trigger('surface.create', canvas);\r\n    }\r\n\r\n    function onCreateSurfaceHeader (header, instance) {\r\n        var label = document.createElement('label');\r\n        label.innerHTML = 'Surface Pane';\r\n        header.appendChild(label);\r\n    }\r\n\r\n    function updateCanvasSize (instance, pane) {\r\n        var canvas = pane.querySelector('canvas');\r\n        var context = canvas.getContext('2d');\r\n        var data = instance.surface.map[canvas.id];\r\n\r\n        var header = pane.querySelector('.pane-header');\r\n        var headerHeight = header ? header.height() : 0;\r\n\r\n        var width = pane.width(), height = pane.height() - headerHeight;\r\n        data.imgData = context.createImageData(width, height);\r\n        data.buffer = new Uint8Array(width * height * 4);\r\n\r\n        canvas.height = height;\r\n        canvas.width = width;\r\n\r\n        mat4.perspective(data.surface.proj, 45 * DEG2RAD, width / height, 0.1, 1000);\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var originalRotation = null;\r\n    var mouseDownCoords = null;\r\n\r\n    Modules.prototype.add('common-interaction', function (instance) {\r\n        instance.surface.interactions.common = {\n            onMouseWheel: function (event, realCoords) {\r\n                var canvas = event.target;\r\n                var delta = Math.max(-1, Math.min(1, (event.wheelDelta || -event.detail)));\r\n                delta /= 2;\r\n\r\n                var data = instance.surface.map[canvas.id];\r\n\r\n                if (data.surface.distance < 5) delta /= 5;\r\n                data.surface.distance -= delta;\r\n\r\n                data.surface.distance = Math.max(data.surface.distance, 0);\r\n\r\n                return true;\n            },\r\n            onMouseMove: function (event, realCoords) {\r\n                if (event.target.dataset.moving) {\r\n                    var canvas = event.target;\r\n                    var data = instance.surface.map[canvas.id];\r\n                    if (data) {\r\n                        var delta = getCoordsDelta(mouseDownCoords, realCoords);\r\n                        combine(data.surface, originalRotation, delta);\r\n                    }\r\n                }\r\n                return false;\r\n            },\r\n            onMouseDown: function (event, realCoords) {\r\n                var canvas = event.target;\r\n                var data = instance.surface.map[canvas.id];\r\n                if (event.which === 2) {\r\n                    event.target.dataset.moving = 'true';\r\n                    upNormalMouseDown = vec3.equals(data.surface.getUpDirection(), [0, 1, 0]);\r\n                    originalRotation = data.surface.rotation.slice();\r\n                    mouseDownCoords = realCoords;\r\n                } else if (event.which === 1) {\r\n                    var surface = data.surface;\r\n\r\n                    var ray = surface.getRayFromCamera(null, realCoords,\r\n                        [canvas.width, canvas.height]);\r\n                    console.debug(realCoords);\r\n\r\n                    var isHit = false, hitPoint = vec3.create();\r\n                    instance.scene.getObjects().forEach(function (node) {\r\n                        isHit = geo.testRayBBox(ray.start, ray.direction, node.data.mesh.bounding, node.data.model, hitPoint);\r\n                        if (isHit) {\r\n                            console.debug(hitPoint, node.data);\r\n                            node.data.selected = true;\r\n                        } else delete node.data.selected;\r\n                    });\r\n                }\r\n                return true;\r\n            },\r\n            onMouseUp: function (event, realCoords) {\r\n                if (event.which === 2) {\r\n                    delete event.target.dataset.moving;\r\n                    var data = instance.surface.map[event.target.id];\r\n                    mouseDownCoords = null;\r\n                }\r\n                return true;\r\n            },\r\n            onClick: function (event, realCoords) {\r\n                return true;\r\n            }\r\n        };\r\n    }, ['surface-interaction']);\r\n\r\n    var upNormalMouseDown = true;\r\n    function combine (surface, originalRotation, delta) {\r\n        if (!originalRotation) return;\r\n        if (!upNormalMouseDown) delta[0] = -delta[0];\r\n\r\n        var rotation = surface.rotation;\r\n        rotation[0] = originalRotation[0] + delta[0] * 0.005;\r\n        rotation[1] = originalRotation[1] + delta[1] * 0.005;\r\n        clampRotations(rotation);\r\n    }\r\n\r\n    function getCoordsDelta (initial, current) {\r\n        if (!initial) return [0, 0];\r\n        return [\r\n            initial[0] - current[0],\r\n            initial[1] - current[1]\r\n        ];\r\n    }\r\n\r\n    function clampRotations (rotations) {\r\n        var pi2 = Math.PI * 2;\r\n        if (rotations[0] < 0) rotations[0] = pi2 + rotations[0];\r\n        if (rotations[0] >= pi2) rotations[0] = rotations[0] - pi2;\r\n        if (rotations[1] < 0) rotations[1] = pi2 + rotations[1];\r\n        if (rotations[1] >= pi2) rotations[1] = rotations[1] - pi2;\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('object-interaction', function (instance) {\r\n        instance.surface.interactions.object = {\r\n            onMouseWheel: function (event, realCoords) {\r\n                return true;\r\n            },\r\n            onMouseMove: function (event, realCoords) {\r\n                return true;\r\n            },\r\n            onMouseDown: function (event, realCoords) {\r\n                return true;\r\n            },\r\n            onMouseUp: function (event, realCoords) {\r\n                return true;\r\n            },\r\n            onClick: function (event, realCoords) {\r\n                return true;\r\n            }\r\n        };\r\n\r\n        instance.events.on('surface.create', function (surface) {\r\n            instance.surface.setInteraction(surface, 'object');\r\n        });\r\n\r\n    }, ['surface-interaction']);\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('surface-interaction', function (instance) {\r\n        instance.surface.interactions = {};\r\n\r\n        instance.surface.setInteraction = function (surface, name) {\r\n            surface.dataset.interaction = name;\r\n        };\r\n\r\n        instance.surface.getInteractionCallbacks = function (surface) {\r\n            var interactionName = surface.dataset.interaction;\r\n            return instance.surface.interactions[interactionName];\r\n        };\r\n\r\n        instance.events.on('surface.create', function (surface) {\r\n            surface.oncontextmenu = onContextMenu;\r\n            surface.onmousewheel = onSurfaceEvent;\r\n            surface.onmousemove = onSurfaceEvent;\r\n            surface.onmousedown = onSurfaceEvent;\r\n            surface.onmouseup = onSurfaceEvent;\r\n            surface.onclick = onSurfaceEvent;\r\n        });\r\n\r\n        function onSurfaceEvent (event) {\r\n            var callbacks = instance.surface.getInteractionCallbacks(event.target);\r\n            var keepRunning = runCallback(callbacks, event);\r\n            if (keepRunning) {\r\n                var common = instance.surface.interactions.common;\r\n                runCallback(common, event);\r\n            }\r\n        }\r\n\r\n        function onContextMenu (event) {\r\n            event.preventDefault();\r\n            return false;\r\n        }\r\n\r\n        instance.events.on('pane.split', function (oldPane, newPane) {\r\n            var initialValue = oldPane.dataset.interaction;\r\n            newPane.dataset.interaction = initialValue;\r\n        });\r\n    }, ['surface']);\r\n\r\n    function runCallback (callbacks, event) {\r\n        var realCoords = getLocalCoordinates(event);\r\n        switch (event.type) {\r\n            case 'mousewheel': return callbacks.onMouseWheel(event, realCoords);\r\n            case 'mousemove': return callbacks.onMouseMove(event, realCoords);\r\n            case 'mousedown': return callbacks.onMouseDown(event, realCoords);\r\n            case 'mouseup': return callbacks.onMouseUp(event, realCoords);\r\n            case 'click': return callbacks.onClick(event, realCoords);\r\n        }\r\n    }\r\n\r\n    function getLocalCoordinates (event) {\r\n        return [event.layerX, event.layerY];\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('render-solid', function (instance) {\r\n        var shader = null;\r\n        var firstSource = null;\r\n        var vertSource = Ajax.get('shader/solid.vert', function (response) {\r\n            if (firstSource) {\r\n                shader = new Shader(response, firstSource);\r\n            } firstSource = response;\r\n        });\r\n        var fragSource = Ajax.get('shader/solid.frag', function (response) {\r\n            if (firstSource) {\r\n                shader = new Shader(firstSource, response);\r\n            } firstSource = response;\r\n        });\r\n\r\n        var grid = {\r\n            type: 'object',\r\n            primitive: instance.graphics.gl.LINES,\r\n            mesh: GL.Mesh.grid({\r\n                lines: 17,\r\n                size: 8\r\n            }),\r\n            model: mat4.create(),\r\n        };\r\n\r\n        instance.surface.renders.solid = function (surface) {\r\n            var lightDirection = vec3.create();\r\n            surface.getCameraPosition(lightDirection);\r\n            vec3.add(lightDirection, lightDirection, [1, 2, 0]);\r\n            vec3.normalize(lightDirection, lightDirection);\r\n            uniforms.u_lightvector = lightDirection;\r\n\r\n            renderObject(surface, grid, shader);\r\n            instance.scene.getObjects().forEach(function (node) {\r\n                renderObject(surface, node.data, shader);\r\n            });\r\n        };\r\n\r\n        instance.events.on('surface.create', function (surface) {\r\n            instance.surface.setRender(surface, 'solid');\r\n        });\r\n    }, ['surface-render']);\r\n\r\n    var uniforms = {\r\n        u_color: [0.7, 0.7, 0.7, 1],\r\n        u_lightvector: null,\r\n        u_model: null,\r\n        u_mvp: mat4.create()\r\n    };\r\n\r\n    var temp = mat4.create();\r\n    function renderObject (surface, obj, shader) {\r\n        surface.getViewMatrix(temp);\r\n        mat4.multiply(temp, surface.proj, temp);\r\n        mat4.multiply(uniforms.u_mvp, temp, obj.model);\r\n\r\n        uniforms.u_color = obj.selected ? [1,0,0,1] : [0.7, 0.7, 0.7, 1];\r\n\r\n        uniforms.u_model = obj.model;\r\n        if (shader) shader.uniforms(uniforms).draw(obj.mesh, obj.primitive);\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('surface-render', function (instance) {\r\n        instance.surface.renders = {};\r\n\r\n        instance.surface.setRender = function (surface, name) {\r\n            surface.dataset.render = name;\r\n        };\r\n\r\n        instance.surface.getRender = function (surface) {\r\n            var renderName = surface.dataset.render;\r\n            return instance.surface.renders[renderName];\r\n        };\r\n\r\n        var panes = document.querySelectorAll('.pane');\r\n        for (var i = 0; i < panes.length; i++) {\r\n            if (panes[i].dataset.paneType == 'surface') {\r\n                var canvas = panes[i].querySelector('canvas');\r\n                canvas.dataset.render = 'solid';\r\n            }\r\n        }\r\n\r\n        instance.events.on('pane.split', function (oldPane, newPane) {\r\n            newPane.attrData('surface-render', oldPane.attrData('surface-render'));\r\n        });\r\n    }, ['surface']);\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var Graphics = function (instance) {\r\n        this.gl = GL.create({\r\n            height: screen.height,\r\n            width: screen.width\r\n        });\r\n        this.gl.animate();\r\n        this.gl.ondraw = function () {\r\n            var renderTargets = document.querySelectorAll('canvas');\r\n            for (var i = 0; i < renderTargets.length; i++)\r\n                drawRenderTarget(instance, renderTargets[i]);\r\n        };\r\n        this.gl.clearColor(0.349, 0.349, 0.349, 1);\r\n        this.gl.enable(this.gl.DEPTH_TEST);\r\n    };\r\n\r\n    Modules.prototype.add('graphics', function (instance) {\r\n        instance.graphics = new Graphics(instance);\r\n    });\r\n\r\n    function drawRenderTarget (instance, canvas) {\r\n        var data = instance.surface.map[canvas.id];\r\n        var gl = instance.graphics.gl;\r\n\r\n        var width  = canvas.clientWidth, height = canvas.clientHeight;\r\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n        gl.viewport(0, 0, width, height);\r\n\r\n        var render = instance.surface.getRender(canvas);\r\n        if (render) render(data.surface);\r\n\r\n        var context = canvas.getContext('2d');\r\n        if (context) {\r\n            gl.readPixels(0, 0, width, height, gl.RGBA, gl.UNSIGNED_BYTE, data.buffer);\r\n            data.imgData.data.set(data.buffer);\r\n            context.putImageData(data.imgData, 0, 0);\r\n        }\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('scene', function (instance) {\r\n        instance.scene = TreeNode.extend({});\r\n\r\n        instance.scene.add({\r\n            type: 'object',\r\n            primitive: instance.graphics.gl.TRIANGLES,\r\n            mesh: GL.Mesh.cube(),\r\n            model: mat4.create(),\r\n        });\r\n        instance.scene.add({\r\n            type: 'light',\r\n            color: [1, 1, 1],\r\n            intensity: 1\r\n        });\r\n\r\n        instance.scene.getObjects = function () {\r\n            return this.dfs(function (node) {\r\n                return node.data.type === 'object';\r\n            });\r\n        };\r\n\r\n        instance.scene.getLights = function () {\r\n            return this.dfs(function (node) {\r\n                return node.data.type === 'light';\r\n            });\r\n        };\r\n    }, ['graphics']);\r\n})());\r\n"]}