{"version":3,"sources":["ajax.js","array.js","html.js","obj.js","tree.js","events.js","logger.js","cobweb.js","modules.js","asset/shader.js","math/camera.js","math/octree.js","math/plane.js","math/ray.js","pane/pane-header.js","pane/pane-types.js","pane/panes.js","math/geometry/geometry.js","math/halfEdge/halfEdge-cube.js","math/halfEdge/halfEdge-mesh.js","pane/surface/surface.js","pane/surface/interaction/common-interaction.js","pane/surface/interaction/edit-interaction-render.js","pane/surface/interaction/edit-interaction-select.js","pane/surface/interaction/edit-interaction.js","pane/surface/interaction/object-interaction.js","pane/surface/interaction/surface-interaction.js","pane/surface/render/render-solid.js","pane/surface/render/surface-render.js","graphic.js","scene.js"],"names":["ajax","options","Object","assign","defaultAjaxOptions","xhttp","XMLHttpRequest","onreadystatechange","this","readyState","status","success","response","error","method","params","objToParams","data","urlWithParams","url","open","async","send","get","Ajax","getJSON","JSON","parse","post","obj","key","nextParam","encodeURIComponent","slice","window","safeExtend","prototype","property","value","Array","a","concat","i","length","j","splice","callback","s4","Math","floor","random","toString","substring","HTMLElement","oldClassNames","newClassNames","arguments","className","trim","replace","split","unique","join","queryClassNames","currentClassNames","index","name","indexOf","removeClassNames","removeEach","forEach","attr","__data_cache","WeakMap","elAttrs","undefined","set","setAttribute","getAttribute","removeAttribute","Element","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","s","matches","document","ownerDocument","querySelectorAll","item","query","parentElement","current","clientHeight","style","height","clientWidth","width","guid","overlap","querySelector","newObj","hasOwnProperty","clone","target","varArgs","TypeError","to","nextSource","nextKey","call","defaults","TreeNode","parent","children","isRoot","add","child","constructor","push","remove","dfs","check","out","bfs","extend","_TreeNode","create","EventHandler","isDebug","listeners","trigger","console","debug","apply","on","off","array","reset","own","keys","Logger","instance","handlers","addHandler","level","ALL","args","DEBUG","INFO","info","WARNING","warn","ERROR","log","warning","tmp","levelHandlers","handler","removeHandler","NONE","defaultOptions","container","selector","Cobweb","Error","addClass","logger","events","modules","Modules","onLoadedAll","names","topologicalSort","sortedNames","module","dependencies","depName","nextName","candidates","getInitialCandidates","dependant","dependantName","allDependenciesMet","loadedUntilNow","runCallback","callbacks","isFunction","all","init","ex","dependencyModule","moduleName","asset","shader","firstSource","Shader","Camera","center","rotation","distance","projection","mat4","getViewMatrix","view","eye","getPosition","lookAt","getUpDirection","vec3","rotateX","rotateY","getDirection","direction","sub","normalize","getRay","ray","canvasCoords","canvasSize","Ray","start","auxMat","multiply","invert","transformMat4","up","vRotation","PI","isContained","aabb","min","max","updateRootBounds","items","maxItems","maxDepth","OctreeNode","depth","root","getAllItems","allItems","addItems","result","addItem","contains","splitIfNeeded","updateDimensions","pop","removeItem","mergeIfNeeded","getCollidingNodes","nodes","collidingPoint","geo","rayAABBCollision","getCollidingItems","node","parentAabb","half","ref","Octree","_addItems","growIfNeeded","newItems","shrinkIfNeeded","Plane","point","normal","fromPoints","b","onCreateCallback","pane","header","createHeader","appendChild","div","createElement","oldPane","newPane","oldType","attrData","setType","types","typeCallbacks","onPaneType","paneHeader","onCreateHeader","dataset","paneType","onPaneCreate","onPaneSplit","origin","onPaneResize","internal","Pane","separator","size","getBarycentricCoordinates","p1","p2","p3","v0","getVectorFromPoints","v1","v2","d00","dot","d01","d11","d20","d21","denom","getNormal","v3","tmp1","tmp2","cross","output","EPSILON","rayFaceCollision","vertices","triangles","triangulateFace","triangle","rayTriangleCollision","triangleNormal","rayPlaneCollision","bary","planePoint","planeNormal","numer","abs","t","scale","minB","maxB","whichPlane","inside","quadrant","Float32Array","maxT","candidatePlane","copy","Number","MAX_VALUE","rayPointDistance","aux","len","pointPointDistance","triangulated","findClosestFace","position","faces","computeCenter","closestFace","newDistance","cube","mesh","HalfEdgeMesh","vhandle","addVertices","face_vhandles","addFace","HalfEdgeCube","buildEdge","end","face","edge","vertex","HalfEdgeFace","opposite","findOppositeEdge","next","_halfEdge","outEdges","opposites","filter","he","VertexGetFaces","map","VertexComputeNormal","getFaces","computeRawNormal","computeNormal","halfEdges","bounds","bump","lastBump","Date","now","isArray","ownIndex","he1","he2","last","prev","onVertexChange","buffer","vertexBuffers","onVertexChangeIndex","indices","clear","hitPoints","uniqueFaces","collidingFaces","getVerticesTriangulated","hitPoint","getFace","smallerIndex","lastDistance","dist","halfEdge","getEdges","getVertices","triplet","reduce","p","onSurfacePaneType","canvas","id","surfaceIndex","surface","camera","updateCanvasSize","onCreateSurfaceHeader","label","innerHTML","context","getContext","headerHeight","imgData","createImageData","Uint8Array","perspective","DEG2RAD","addEventListener","event","surfaces","parentNode","combine","originalRotation","delta","upNormalMouseDown","clampRotations","getCoordsDelta","initial","rotations","pi2","mouseDownCoords","interactions","common","onMouseWheel","realCoords","wheelDelta","detail","onMouseMove","moving","onMouseDown","which","equals","onMouseUp","onClick","onRender","getCachedVBOMesh","halfEdgeMesh","_cache","cacheKey","time","buildMeshFromHalfEdges","buffers","colors","color","_selected","lines","Uint16Array","GL","Mesh","load","uniforms","u_mvp","temp","edit","scene","getObjects","model","graphics","gl","lineWidth","draw","LINES","toggleVertex","selection","object","toggle","toggleFace","arrayName","initObjectIfNeeded","objects","delObjectIfNeeded","edges","objSelection","getEdgesFromVertices","getFacesFromVertices","uniqueEdges","isEmpty","isMouseDown","initialHitPoint","cameraDirection","diff","originalPosition","setInteraction","isHit","testRayBBox","bounding","selected","getLocalCoordinates","type","layerX","layerY","onSurfaceEvent","getInteractionCallbacks","keepRunning","onContextMenu","preventDefault","interaction","interactionName","oncontextmenu","onmousewheel","onmousemove","onmousedown","onmouseup","onclick","initialValue","renderObject","u_model","primitive","normals","faceNormal","grid","renders","solid","lightDirection","u_lightvector","setRender","u_color","render","getRender","renderName","panes","drawRenderTarget","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","viewport","mainRender","readPixels","RGBA","UNSIGNED_BYTE","putImageData","Graphics","screen","animate","ondraw","renderTargets","clearColor","enable","DEPTH_TEST","objectCount","lightCount","addObject","TRIANGLES","addLight","intensity","getLights"],"mappings":"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","file":"cobweb.min.js","sourcesContent":["((function(){\r\n    'use strict';\r\n\r\n    var defaultAjaxOptions = {\r\n        method: 'GET',\r\n        url: '',\r\n        data: {},\r\n        async: true,\r\n        success: null,\r\n        error: null\r\n    };\r\n\r\n    function ajax (options) {\r\n        options = Object.assign({}, defaultAjaxOptions, options);\r\n        var xhttp = new XMLHttpRequest();\r\n        xhttp.onreadystatechange = function() {\r\n            if (this.readyState == 4) {\r\n                if (this.status == 200) {\r\n                    if (options.success) options.success(this.response);\r\n                } else {\r\n                    if (options.error) error.success(this.response);\r\n                }\r\n            }\r\n        };\r\n        if (options.method === 'GET') {\r\n            var params = objToParams(options.data);\r\n            var urlWithParams = options.url + (params ? '?' + params : '');\r\n            xhttp.open(options.method, urlWithParams, options.async);\r\n            xhttp.send();\r\n        } else if (options.method === 'POST') {\r\n            xhttp.open(options.method, options.url, options.async);\r\n            xhttp.send(options.data);\r\n        }\r\n        return xhttp;\r\n    }\r\n\r\n    function get (url, data, success) {\r\n        if (!success) {\r\n            success = data;\r\n            data = null;\r\n        }\r\n        return Ajax.ajax({\r\n            url: url,\r\n            data: data,\r\n            success: success,\r\n            method: 'GET'\r\n        });\r\n    }\r\n\r\n    function getJSON (url, data, success) {\r\n        if (!success) {\r\n            success = data;\r\n            data = null;\r\n        }\r\n        return Ajax.ajax({\r\n            url: url,\r\n            data: data,\r\n            success: function (response) {\r\n                success(JSON.parse(response));\r\n            },\r\n            method: 'GET'\r\n        });\r\n    }\r\n\r\n    function post (url, data, success) {\r\n        if (!success) {\r\n            success = data;\r\n            data = null;\r\n        }\r\n        return Ajax.ajax({\r\n            url: url,\r\n            data: data,\r\n            success: success,\r\n            method: 'POST'\r\n        });\r\n    }\r\n\r\n    window.Ajax = {\r\n        ajax: ajax,\r\n        get: get,\r\n        getJSON: getJSON,\r\n        post: post\r\n    };\r\n\r\n    function objToParams (obj) {\r\n        var params = '';\r\n        for (var key in obj) {\r\n            var nextParam = key + '=' + encodeURIComponent(obj[key]);\r\n            params += '&' + nextParam;\r\n        }\r\n        return params.slice(1);\r\n    }\r\n})());\r\n","((function(){\r\n    'use strict';\r\n\r\n    safeExtend(Array.prototype, 'unique', function() {\r\n        var a = this.concat();\r\n        for(var i = 0; i < a.length; ++i)\r\n            for(var j = i + 1; j < a.length; ++j)\r\n                if(a[i] === a[j]) a.splice(j--, 1);\r\n        return a;\r\n    });\r\n\r\n    safeExtend(Array.prototype, 'forEach', function(callback) {\r\n        for (var i = 0; i < this.length; i++)\r\n            callback(this[i], i, this);\r\n    });\r\n\r\n    function safeExtend(prototype, property, value) {\r\n        if(!prototype[property]) prototype[property] = value;\r\n    }\r\n})());\r\n","((function(){\r\n    'use strict';\r\n\r\n    safeExtend(HTMLElement.prototype, 'addClass', function () {\r\n        var oldClassNames, newClassNames;\r\n        for(var i in arguments){\r\n            oldClassNames = !this.className ? [] : this.className.trim().replace(/\\s+/g, ' ').split(' ');\r\n            newClassNames = !arguments[i] ? [] : arguments[i].trim().replace(/\\s+/g, ' ').split(' ');\r\n            this.className = oldClassNames.concat(newClassNames).unique().join(' ');\r\n        }\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'hasClass', function () {\r\n        var queryClassNames, currentClassNames = !this.className ? [] : this.className.trim().replace(/\\s+/g, ' ').split(' ');\r\n        for(var i in arguments){\r\n            queryClassNames = !arguments[i] ? [] : arguments[i].trim().replace(/\\s+/g, ' ').split(' ');\r\n            for (var index = 0; index < queryClassNames.length; index++) {\r\n                var name = queryClassNames[index];\r\n                if (currentClassNames.indexOf(name) == -1)\r\n                    return false;\r\n            }\r\n        }\r\n        return true;\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'removeClass', function () {\r\n        var index = 0, currentClassNames, removeClassNames;\r\n        var removeEach = function (name) {\r\n            index = currentClassNames.indexOf(name);\r\n            if (index != -1)\r\n                currentClassNames.splice(index, 1);\r\n        };\r\n        for(var i in arguments){\r\n            currentClassNames = !this.className ? [] : this.className.trim().replace(/\\s+/g, ' ').split(' ');\r\n            removeClassNames = !arguments[i] ? [] : arguments[i].trim().replace(/\\s+/g, ' ').split(' ');\r\n            removeClassNames.forEach(removeEach);\r\n            this.className = currentClassNames.unique().join(' ');\r\n        }\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'data', function (attr, value) {\r\n        if (!window.__data_cache) window.__data_cache = new WeakMap();\r\n        var elAttrs = window.__data_cache.get(this) || {};\r\n        if (value !== undefined) {\r\n            elAttrs[attr] = value;\r\n            window.__data_cache.set(this, elAttrs);\r\n        } else {\r\n            if (attr) return elAttrs && elAttrs[attr];\r\n            else return elAttrs;\r\n        }\r\n        return this;\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'setData', function (data) {\r\n        if (!window.__data_cache) window.__data_cache = new WeakMap();\r\n        window.__data_cache.set(this, data);\r\n        return this;\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'attr', function (name, value) {\r\n        if (value !== undefined)\r\n            this.setAttribute(name, value);\r\n        else if (value === null)\r\n            this.removeAttribute(name);\r\n        else\r\n            return this.getAttribute(name);\r\n        return this;\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'attrData', function (name, value) {\r\n        return this.attr('data-' + name, value);\r\n    });\r\n\r\n    safeExtend(Element.prototype, 'matches',\r\n        Element.prototype.matchesSelector ||\r\n        Element.prototype.mozMatchesSelector ||\r\n        Element.prototype.msMatchesSelector ||\r\n        Element.prototype.oMatchesSelector ||\r\n        Element.prototype.webkitMatchesSelector ||\r\n        function(s) {\r\n            var matches = (this.document || this.ownerDocument).querySelectorAll(s),\r\n                i = matches.length;\r\n            while (--i >= 0 && matches.item(i) !== this) {}\r\n            return i > -1;\r\n        }\r\n    );\r\n\r\n    safeExtend(HTMLElement.prototype, 'parent', function (query) {\r\n        if (!query) return this.parentElement;\r\n        var current = this.parentElement;\r\n        while (!current.matches(query))\r\n            current = current.parentElement;\r\n        return current;\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'height', function () {\r\n        if (arguments.length == 1) {\r\n            var value = arguments[0];\r\n            if (typeof value === 'number')\r\n                this.style.height = value + 'px';\r\n            else\r\n                this.style.height = value;\r\n        } else\r\n            return this.clientHeight;\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'width', function () {\r\n        if (arguments.length == 1) {\r\n            var value = arguments[0];\r\n            if (typeof value === 'number')\r\n                this.style.width = value + 'px';\r\n            else\r\n                this.style.width = value;\r\n        } else\r\n            return this.clientWidth;\r\n    });\r\n\r\n    safeExtend(window, 'guid', function () {\r\n        return 'GUID-' + s4() + '-' + s4() + '-' + s4();\r\n    });\r\n\r\n    safeExtend(HTMLElement.prototype, 'guid', function () {\r\n        var guid = null, overlap = null;\r\n        do {\r\n            guid = window.guid();\r\n            overlap = document.querySelector('#' + guid);\r\n        } while(overlap);\r\n        this.attr('id', guid);\r\n        return guid;\r\n    });\r\n\r\n    function safeExtend(prototype, property, value) {\r\n        if(!prototype[property]) prototype[property] = value;\r\n    }\r\n\r\n    function s4() {\r\n        return Math.floor((1 + Math.random()) * 0x10000)\r\n            .toString(16).substring(1);\r\n    }\r\n})());\r\n","((function(){\r\n    'use strict';\r\n\r\n    safeExtend(Object, 'clone', function (obj) {\r\n        var newObj = {};\r\n        for (var property in obj)\r\n            if (obj.hasOwnProperty(property)) {\r\n                var value = obj[property];\r\n                if (typeof value === 'object')\r\n                    newObj[property] = Object.clone(obj[property]);\r\n                else\r\n                    newObj[property] = obj[property];\r\n            }\r\n        return newObj;\r\n    });\r\n\r\n    safeExtend(Object, 'assign', function(target, varArgs) {\r\n        if (target === null)\r\n            throw new TypeError('Cannot convert undefined or null to object');\r\n        var to = Object(target);\r\n        var hasOwnProperty = Object.prototype.hasOwnProperty;\r\n        for (var index = 1; index < arguments.length; index++) {\r\n            var nextSource = arguments[index];\r\n            if (nextSource !== null) {\r\n                for (var nextKey in nextSource) {\r\n                    if (hasOwnProperty.call(nextSource, nextKey)) {\r\n                        to[nextKey] = nextSource[nextKey];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        return to;\r\n    });\r\n\r\n    safeExtend(Object, 'extend', function(options, defaults) {\r\n        return Object.assign({}, defaults, options);\r\n    });\r\n\r\n    function safeExtend(prototype, property, value) {\r\n        if(!prototype[property]) prototype[property] = value;\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var TreeNode = function (parent, data) {\r\n        this.parent = parent || null;\r\n        this.data = data || {};\r\n        this.children = [];\r\n    };\r\n\r\n    window.TreeNode = TreeNode;\r\n\r\n    TreeNode.prototype.isRoot = function () {\r\n        return !this.parent;\r\n    };\r\n\r\n    TreeNode.prototype.add = function (data) {\r\n        var child = new this.constructor(this, data);\r\n        this.children.push(child);\r\n        return child;\r\n    };\r\n\r\n    TreeNode.prototype.remove = function (index) {\r\n        this.children.slice(index, 1);\r\n        return this;\r\n    };\r\n\r\n    TreeNode.prototype.dfs = function (check) {\r\n        var out = [];\r\n        for (var i = 0; i < this.children.length; i++) {\r\n            if (!check || (check && check(this.children[i])))\r\n                out.push(this.children[i]);\r\n            out.concat(this.children[i].dfs(check));\r\n        }\r\n        return out;\r\n    };\r\n\r\n    TreeNode.prototype.bfs = function (check) {\r\n        var out = [], i;\r\n        for (i = 0; i < this.children.length; i++)\r\n            if (!check || (check && check(this.children[i])))\r\n                out.push(this.children[i]);\r\n        for (i = 0; i < this.children.length; i++)\r\n            out.concat(this.children[i].bfs(check));\r\n        return out;\r\n    };\r\n\r\n    TreeNode.extend = function () {\r\n        var _TreeNode = function (parent, data) {\r\n            TreeNode.call(this, parent, data);\r\n        };\r\n        _TreeNode.prototype = Object.create(TreeNode.prototype);\r\n        _TreeNode.prototype.constructor = _TreeNode;\r\n        return new _TreeNode();\r\n    };\r\n})());\r\n","((function() {\r\n    'use strict';\r\n\r\n    var EventHandler = function (isDebug) {\r\n        this.isDebug = !!isDebug;\r\n        this.listeners = {};\r\n    };\r\n\r\n    EventHandler.prototype.trigger = function() {\r\n        var name = arguments[0];\r\n        var listeners = this.listeners[name] || [];\r\n        Array.prototype.splice.call(arguments, 0, 1);\r\n        if (this.isDebug) console.debug(name, arguments);\r\n        for (var i = 0; i < listeners.length; i++)\r\n            listeners[i].apply(null, arguments);\r\n    };\r\n\r\n    EventHandler.prototype.on = function(name, callback) {\r\n        if (!this.listeners[name]) this.listeners[name] = [];\r\n        this.listeners[name].push(callback);\r\n    };\r\n\r\n    EventHandler.prototype.off = function(name) {\r\n        delete this.listeners[name];\r\n    };\r\n\r\n    EventHandler.prototype.off = function(name, callback) {\r\n        if (this.listeners[name]) {\r\n            var array = this.listeners[name];\r\n            if (array.indexOf(callback) > -1) array.splice(index, 1);\r\n        }\r\n    };\r\n\r\n    EventHandler.prototype.reset = function() {\r\n        var own = this;\r\n        Object.keys(this.listeners).forEach(function(key) {\r\n            delete own.listeners[key];\r\n        });\r\n    };\r\n\r\n    window.EventHandler = EventHandler;\r\n})());\r\n","/* jshint loopfunc:true */\r\n\r\n((function(){\r\n    'use strict';\r\n\r\n    var Logger = function (instance) {\r\n        this.handlers = [];\r\n\r\n        this.addHandler(this.level.ALL, function (level, args) {\r\n            if (Logger.prototype.level.DEBUG === level) {\r\n                console.debug.apply(this, args);\r\n            } else if (Logger.prototype.level.INFO === level) {\r\n                console.info.apply(this, args);\r\n            } else if (Logger.prototype.level.WARNING === level) {\r\n                console.warn.apply(this, args);\r\n            } else if (Logger.prototype.level.ERROR === level) {\r\n                console.error.apply(this, args);\r\n            }\r\n        });\r\n    };\r\n\r\n    Logger.prototype.debug = function () {\r\n        this.log(Logger.prototype.level.DEBUG, arguments);\r\n    };\r\n\r\n    Logger.prototype.info = function () {\r\n        this.log(Logger.prototype.level.INFO, arguments);\r\n    };\r\n\r\n    Logger.prototype.warning = function () {\r\n        this.log(Logger.prototype.level.WARNING, arguments);\r\n    };\r\n\r\n    Logger.prototype.error = function () {\r\n        this.log(Logger.prototype.level.ERROR, arguments);\r\n    };\r\n\r\n    Logger.prototype.log = function (level, args) {\r\n        var tmp = level;\r\n        var levelHandlers = this.handlers[tmp] || [];\r\n        while (tmp >= 0) {\r\n            levelHandlers.forEach(function (handler) {\r\n                handler(level, args);\r\n            });\r\n            levelHandlers = this.handlers[--tmp] || [];\r\n        }\r\n    };\r\n\r\n    Logger.prototype.addHandler = function (level, callback) {\r\n        if (!this.handlers[level])\r\n            this.handlers[level] = [];\r\n        this.handlers[level].push(callback);\r\n    };\r\n\r\n    Logger.prototype.removeHandler = function (level, callback) {\r\n        var levelHandlers = this.handlers[level];\r\n        if (levelHandlers) {\r\n            var index = levelHandlers.indexOf(callback);\r\n            if (index > -1)\r\n                levelHandlers.splice(index, 1);\r\n        }\r\n    };\r\n\r\n    Logger.prototype.level = {\r\n        ALL: 0,\r\n        DEBUG: 1,\r\n        INFO: 2,\r\n        WARNING: 3,\r\n        ERROR: 4,\r\n        NONE: 5,\r\n    };\r\n\r\n    window.Logger = Logger;\r\n})());\r\n","(function(){\r\n    'use strict';\r\n\r\n    var defaultOptions = {\r\n        container: {\r\n            selector: '#cobweb'\r\n        }\r\n    };\r\n\r\n    var Cobweb = function (options) {\r\n        this.options = Object.assign({}, defaultOptions, options);\r\n        var instance = this;\r\n\r\n        this.container = document.querySelector(this.options.container.selector);\r\n        if (!this.container)\r\n            throw new Error('Invalid container selector: \\'' +\r\n                this.options.container.selector + '\\'');\r\n        this.container.addClass('cb-container');\r\n        this.container.data('instance', this);\r\n\r\n        this.logger = new Logger(this, true);\r\n        this.events = new EventHandler(true);\r\n        this.modules = new Modules([this], {\r\n            onLoadedAll: function (names) {\r\n                instance.events.trigger('modules.loaded.all', names);\r\n                instance.events.trigger('app.loaded');\r\n            }\r\n        });\r\n    };\r\n\r\n    window.Cobweb = Cobweb;\r\n}());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var Modules = function (params, callbacks) {\r\n        callbacks = callbacks || {};\r\n        var modules = Modules.prototype.all;\r\n        try {\r\n            var sortedNames = topologicalSort(modules);\r\n            for (var i = 0; i < sortedNames.length; i++ ) {\r\n                var name = sortedNames[i];\r\n                var module = modules[name];\r\n                try {\r\n                    module.init.apply(this, params);\r\n                    runCallback(callbacks, 'onLoaded', [name, module]);\r\n                } catch (ex) {\r\n                    console.error('Error loading module:', name, ex);\r\n                    runCallback(callbacks, 'onError', [ex, name, module]);\r\n                }\r\n            }\r\n            runCallback(callbacks, 'onLoadedAll', [sortedNames]);\r\n        } catch (ex) {\r\n            console.error('Error loading modules:', ex);\r\n        }\r\n    };\r\n\r\n    Modules.prototype.all = {};\r\n    Modules.prototype.add = function (name, init, dependencies) {\r\n        dependencies = dependencies || [];\r\n\r\n        var dependant = [];\r\n        var dependencyModule, i;\r\n        for (var moduleName in this.all) {\r\n            var module = this.all[moduleName];\r\n            for (i = 0; i < module.dependencies.length; i++)\r\n                if (module.dependencies[i] === name)\r\n                    dependant.push(moduleName);\r\n        }\r\n        for (i = 0; i < dependencies.length; i++) {\r\n            dependencyModule = this.all[dependencies[i]];\r\n            if (dependencyModule) dependencyModule.dependant.push(name);\r\n        }\r\n\r\n        this.all[name] = {\r\n            dependencies: dependencies,\r\n            dependant: dependant,\r\n            init: init\r\n        };\r\n    };\r\n\r\n    window.Modules = Modules;\r\n\r\n    function topologicalSort (modules) {\r\n        var sortedNames = [];\r\n\r\n        var module = null, i = 0;\r\n        for (var name in modules) {\r\n            module = modules[name];\r\n            for (i = 0; i < module.dependencies.length; i++) {\r\n                var depName = module.dependencies[i];\r\n                if (!modules[depName])\r\n                    throw new Error('Missing module: ' + depName);\r\n            }\r\n        }\r\n\r\n        var nextName = null;\r\n        var candidates = getInitialCandidates(modules);\r\n        while (candidates.length > 0) {\r\n            nextName = candidates.splice(0, 1)[0];\r\n            module = modules[nextName];\r\n            if (module) {\r\n                sortedNames.push(nextName);\r\n                for (i = 0; i < module.dependant.length; i++) {\r\n                    var dependantName = module.dependant[i];\r\n                    if (allDependenciesMet(sortedNames, modules[dependantName]))\r\n                        candidates.push(dependantName);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (Object.keys(modules).length !== sortedNames.length)\r\n            throw new Error('Dependency cycle!');\r\n\r\n        return sortedNames;\r\n    }\r\n\r\n    function getInitialCandidates (modules) {\r\n        var candidates = [];\r\n        for (var name in modules)\r\n            if (modules[name].dependencies.length === 0)\r\n                candidates.push(name);\r\n        return candidates;\r\n    }\r\n\r\n    function allDependenciesMet (loadedUntilNow, module) {\r\n        for (var i = 0; i < module.dependencies.length; i++)\r\n            if (loadedUntilNow.indexOf(module.dependencies[i]) === -1) return false;\r\n        return true;\r\n    }\r\n\r\n    function runCallback (callbacks, name, params) {\r\n        var callback = callbacks[name];\r\n        var isFunction = typeof callback === 'function';\r\n        if (isFunction) callback.apply(null, params);\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('shader', function (instance) {\r\n        instance.asset = instance.asset || {};\r\n        instance.asset.shader = {\r\n            get: function (name, callback) {\r\n                var shader = null, firstSource = null;\r\n                var vertSource = Ajax.get('shader/' + name + '.vert', function (response) {\r\n                    if (firstSource) {\r\n                        shader = new Shader(response, firstSource);\r\n                        callback(shader);\r\n                    } firstSource = response;\r\n                });\r\n                var fragSource = Ajax.get('shader/' + name + '.frag', function (response) {\r\n                    if (firstSource) {\r\n                        shader = new Shader(firstSource, response);\r\n                        callback(shader);\r\n                    } firstSource = response;\r\n                });\r\n            }\r\n        };\r\n    }, ['surface-interaction']);\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var Camera = function (center, rotation, distance) {\r\n        this.center = center || [0, 0, 0];\r\n        this.rotation = rotation || [-0.5, -0.5];\r\n        this.distance = distance || 12;\r\n        this.projection = mat4.create();\r\n    };\r\n\r\n    Camera.prototype.getViewMatrix = function (view) {\r\n        view = view || mat4.create();\r\n        var eye = [0, 0, 0];\r\n        this.getPosition(eye);\r\n        mat4.lookAt(view, eye, this.center, this.getUpDirection());\r\n        return view;\r\n    };\r\n\r\n    Camera.prototype.getPosition = function (eye) {\r\n        eye = eye || vec3.create();\r\n        vec3.set(eye, 0, 0, -this.distance);\r\n        vec3.rotateX(eye, eye, this.rotation[1]);\r\n        vec3.rotateY(eye, eye, -this.rotation[0]);\r\n        return eye;\r\n    };\r\n\r\n    Camera.prototype.getDirection = function (direction) {\r\n        direction = direction || vec3.create();\r\n        var eye = this.getPosition();\r\n        vec3.sub(direction, this.center, eye);\r\n        vec3.normalize(direction, direction);\r\n        return direction;\r\n    };\r\n\r\n    Camera.prototype.getRay = function (ray, canvasCoords, canvasSize) {\r\n        ray = ray || new Math.Ray();\r\n        this.getPosition(ray.start);\r\n        vec3.set(ray.direction, canvasCoords[0] / (canvasSize[0] * 0.5) - 1.0,\r\n            canvasCoords[1] / (canvasSize[1] * 0.5) - 1.0, 1);\r\n        var auxMat = mat4.create();\r\n        mat4.multiply(auxMat, this.projection, this.getViewMatrix());\r\n        mat4.invert(auxMat, auxMat);\r\n        vec3.transformMat4(ray.direction, ray.direction, auxMat);\r\n        vec3.normalize(ray.direction, ray.direction);\r\n        return ray;\r\n    };\r\n\r\n    Camera.prototype.getUpDirection = function (up) {\r\n        up = up || vec3.create();\r\n        var vRotation = this.rotation[1];\r\n        if (vRotation >= Math.PI / 2 &&\r\n            vRotation <= ((Math.PI * 3) / 2))\r\n            vec3.set(up, 0, -1, 0);\r\n        else vec3.set(up, 0, 1, 0);\r\n        return up;\r\n    };\r\n\r\n    window.Math.Camera = Camera;\r\n})());\r\n","(function () {\r\n\t'use strict';\r\n\r\n\tvar defaultOptions = {\r\n\t\tmaxItems: 5,\r\n\t\tmaxDepth: 5,\r\n\t};\r\n\r\n\tvar OctreeNode = function (parent, depth) {\r\n\t\tthis.items = [];\r\n\t\tthis.children = null;\r\n\t\tthis.depth = depth || 0;\r\n\t\tthis.parent = parent || null;\r\n\t\tthis.aabb = { max: [0, 0, 0], min: [0, 0, 0] };\r\n\r\n\t\tthis.root = this;\r\n\t\twhile (this.root.parent !== null)\r\n\t\t\tthis.root = this.root.parent;\r\n\t};\r\n\r\n\tOctreeNode.prototype.getAllItems = function () {\r\n        if (!this.children) return this.items;\r\n        else {\r\n            var allItems = [];\r\n            for (var i = 0; i < this.children.length; i++)\r\n                allItems = allItems.concat(this.children[i].getAllItems());\r\n            return allItems;\r\n        }\r\n\t};\r\n\r\n\tOctreeNode.prototype.addItems = function (items) {\r\n\t\tvar result = false;\r\n\t\tfor (var i = 0; i < items.length; i++) {\r\n\t\t\tvar item = items[i];\r\n\t\t\tresult |= this.addItem(item);\r\n\t\t}\r\n\t\treturn result;\r\n\t};\r\n\r\n\tOctreeNode.prototype.addItem = function (item) {\r\n\t\tif (this.contains(item)) {\r\n\t\t\tif (this.children) {\r\n\t\t\t\tfor (var i = 0; i < 8; i++)\r\n\t\t\t\t\tif (this.children[i].addItem(item))\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tthis.items.push(item);\r\n\t\t\t\tthis.splitIfNeeded();\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\r\n\tOctreeNode.prototype.splitIfNeeded = function () {\r\n\t\tif (this.root.options.maxItems < this.items.length &&\r\n\t\t\tthis.root.options.maxDepth >= this.depth) {\r\n\t\t\tthis.children = [];\r\n\t\t\tfor (var i = 0; i < 8; i++) {\r\n\t\t\t\tthis.children[i] = new OctreeNode(this, this.depth + 1);\r\n\t\t\t\tthis.children[i].updateDimensions(this.aabb, i);\r\n\t\t\t}\r\n\t\t\twhile (this.items.length > 0) {\r\n\t\t\t\tvar item = this.items.pop();\r\n\t\t\t\tfor (i = 0; i < 8; i++) {\r\n\t\t\t\t\tvar child = this.children[i];\r\n\t\t\t\t\tif (child.addItem(item)) break;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tOctreeNode.prototype.removeItem = function (item) {\r\n\t\tvar index = this.items.indexOf(item);\r\n\t\tif (index > -1) {\r\n\t\t\tthis.items.splice(index, 1);\r\n\t\t\tthis.mergeIfNeeded();\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t};\r\n\r\n\tOctreeNode.prototype.mergeIfNeeded = function () {\r\n\t\t//TODO: implement\r\n\t};\r\n\r\n\tOctreeNode.prototype.contains = function (item) {\r\n\t\treturn isContained(item, this.aabb);\r\n\t};\r\n\r\n\tOctreeNode.prototype.getCollidingNodes = function (ray) {\r\n\t\tvar nodes = [];\r\n\t\tvar aabb = this.aabb;\r\n\t\tvar collidingPoint = [0, 0, 0];\r\n\t\tif (Math.geo.rayAABBCollision(ray.start, ray.direction,\r\n\t\t\tthis.aabb.min, this.aabb.max, collidingPoint)) {\r\n\t\t\tif (this.children) {\r\n\t\t\t\tfor (var i = 0; i < this.children.length; i++) {\r\n\t\t\t\t\tvar child = this.children[i];\r\n\t\t\t\t\tnodes = nodes.concat(child.getCollidingNodes(ray));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tnodes.push(this);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn nodes;\r\n\t};\r\n\r\n\tOctreeNode.prototype.getCollidingItems = function (ray) {\r\n\t\tvar items = [];\r\n\t\tthis.getCollidingNodes(ray).forEach(function (node) {\r\n\t\t\titems = items.concat(node.items);\r\n\t\t});\r\n\t\treturn items;\r\n\t};\r\n\r\n\tOctreeNode.prototype.updateDimensions = function (parentAabb, index) {\r\n\t\tvar half = [\r\n\t\t\t(parentAabb.max[0] - parentAabb.min[0]) * 0.5,\r\n\t\t\t(parentAabb.max[1] - parentAabb.min[1]) * 0.5,\r\n\t\t\t(parentAabb.max[2] - parentAabb.min[2]) * 0.5\r\n\t\t];\r\n\t\tvar ref = [!(index & 1), !(index & 2), !(index & 4)];\r\n\t\tthis.aabb.min = [\r\n\t\t\tparentAabb.min[0] + half[0] * ref[0],\r\n\t\t\tparentAabb.min[1] + half[1] * ref[1],\r\n\t\t\tparentAabb.min[2] + half[2] * ref[2]\r\n\t\t];\r\n\t\tthis.aabb.max = [\r\n\t\t\tthis.aabb.min[0] + half[0],\r\n\t\t\tthis.aabb.min[1] + half[1],\r\n\t\t\tthis.aabb.min[2] + half[2]\r\n\t\t];\r\n\t};\r\n\r\n\tvar Octree = function (options) {\r\n\t\tthis.options = Object.assign({}, defaultOptions, options);\r\n\t\tOctreeNode.call(this);\r\n\t};\r\n\r\n\tOctree.prototype = Object.create(OctreeNode.prototype);\r\n\tOctree.prototype.constructor = OctreeNode;\r\n\r\n\tvar _addItems = Octree.prototype.addItems;\r\n\tOctree.prototype.addItems = function (items) {\r\n\t\tthis.growIfNeeded(items);\r\n\t\t_addItems.call(this, items);\r\n\t};\r\n\r\n\tOctree.prototype.updateDimensions = function (newItems) {\r\n\t\tvar allItems = this.getAllItems();\r\n\t\tif (newItems) allItems.push(newItems);\r\n\t\tthis.shrinkIfNeeded(allItems);\r\n\t\tthis.growIfNeeded(allItems);\r\n\t\tif (this.children) {\r\n\t\t\tfor (var i = 0; i < this.children.length; i++) {\r\n\t\t\t\tthis.children[i].updateDimensions(this.aabb, i);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tOctree.prototype.shrinkIfNeeded = function (allItems) {\r\n\t\tconsole.debug('shrinkIfNeeded');\r\n\t};\r\n\r\n\tOctree.prototype.growIfNeeded = function (allItems) {\r\n\t\tupdateRootBounds(allItems, this.aabb);\r\n\t};\r\n\r\n\tMath.Octree = Octree;\r\n\r\n\tfunction isContained (item, aabb) {\r\n\t\tfor (var j = 0; j < 3; j++) {\r\n\t\t\tif (item[j] < aabb.min[j]) return false;\r\n\t\t\tif (item[j] > aabb.max[j]) return false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tfunction updateRootBounds (items, aabb) {\r\n\t\tfor (var i = 0; i < items.length; i++) {\r\n\t\t\tvar item = items[i];\r\n\t\t\tfor (var j = 0; j < 3; j++) {\r\n\t\t\t\tif (item[j] < aabb.min[j]) aabb.min[j] = item[j];\r\n\t\t\t\tif (item[j] > aabb.max[j]) aabb.max[j] = item[j];\r\n\t\t\t}\r\n\t\t}\r\n\t\tvec3.add(aabb.max, aabb.max, [0.5, 0.5, 0.5]);\r\n\t\tvec3.sub(aabb.min, aabb.min, [0.5, 0.5, 0.5]);\r\n\t}\r\n})();\r\n","((function () {\r\n    'use strict';\r\n\r\n    var Plane = function (point, normal) {\r\n        this.normal = normal || [0, 1, 0];\r\n        this.point = point || vec3.create();\r\n        vec3.normalize(this.normal, this.normal);\r\n    };\r\n\r\n    window.Math.Plane = Plane;\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var Ray = function (start, direction) {\r\n        this.direction = direction || [0, 0, 1];\r\n        this.start = start || vec3.create();\r\n        vec3.normalize(this.direction, this.direction);\r\n    };\r\n\r\n    Ray.fromPoints = function (a, b) {\r\n        var direction = vec3.create();\r\n        vec3.sub(direction, b, a);\r\n        return new Ray(a, direction);\r\n    };\r\n\r\n    window.Math.Ray = Ray;\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('pane-header', function (instance) {\r\n        instance.events.on('pane.create', function (pane) {\r\n            onCreateCallback(pane, instance);\r\n        });\r\n    }, ['pane-types']);\r\n\r\n    function onCreateCallback (pane, instance) {\r\n        var header = createHeader();\r\n        pane.appendChild(header);\r\n    }\r\n\r\n    function createHeader () {\r\n        var div = document.createElement('div');\r\n        div.className = 'pane-header';\r\n        return div;\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('pane-types', function (instance) {\r\n\r\n        instance.events.on('pane.split', function (oldPane, newPane) {\r\n            var oldType = oldPane.attrData('pane-type');\r\n            if (oldType) instance.pane.setType(newPane, oldType);\r\n        });\r\n\r\n        instance.pane.types = {};\r\n\r\n        instance.pane.setType = function (pane, name) {\r\n            if (this.types[name]) {\r\n                var typeCallbacks = this.types[name];\r\n                typeCallbacks.onPaneType(pane, instance);\r\n                var paneHeader = pane.querySelector('.pane-header');\r\n                typeCallbacks.onCreateHeader(paneHeader, instance);\r\n                pane.dataset.paneType = name;\r\n            }\r\n        };\r\n    }, ['pane']);\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('pane', function (instance) {\r\n        instance.events.on('app.loaded', function () {\r\n            instance.pane.internal = new Pane({\r\n                container: instance.options.container.selector,\r\n                separator: {\r\n                    size: 3\r\n                },\r\n                callbacks: {\r\n                    onPaneCreate: onPaneCreate,\r\n                    onPaneSplit: onPaneSplit,\r\n                    onPaneResize: onPaneResize,\r\n                    //onPaneMerge: onPaneMerge,\r\n                    //onPaneDestroy: onPaneDestroy,\r\n                }\r\n            });\r\n\r\n            var root = instance.pane.internal.container.querySelector('.pane');\r\n            instance.pane.setType(root, 'surface');\r\n        });\r\n\r\n        instance.pane = {};\r\n\r\n        function onPaneCreate (pane) {\r\n            instance.events.trigger('pane.create', pane);\r\n        }\r\n\r\n        function onPaneSplit (origin, newPane) {\r\n            instance.events.trigger('pane.split', origin, newPane);\r\n        }\r\n\r\n        function onPaneResize (pane) {\r\n            instance.events.trigger('pane.resize', pane);\r\n        }\r\n\r\n        function onPaneMerge (merger, toRemove) {\r\n            console.debug('onPaneMerge', merger, toRemove);\r\n        }\r\n\r\n        function onPaneDestroy (pane) {\r\n            console.debug('onPaneDestroy', pane);\r\n        }\r\n    });\r\n})());\r\n","(function () {\r\n    'use strict';\r\n\r\n    var EPSILON = 0.000001;\r\n\r\n    Math.geo = Math.geo || {};\r\n\r\n    Math.geo.rayFaceCollision = function (start, direction, vertices, result) {\r\n        var triangles = Math.geo.triangulateFace(vertices);\r\n        for (var i = 0; i < triangles.length; i++) {\r\n            var triangle = triangles[i];\r\n            if (Math.geo.rayTriangleCollision(start, direction,\r\n                triangle[0], triangle[1], triangle[2], result))\r\n                return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    Math.geo.rayTriangleCollision = function (start, direction, v1, v2, v3, result) {\r\n        result = result || [0, 0, 0];\r\n    \tvar triangleNormal = getNormal(v1, v2, v3);\r\n        if (Math.geo.rayPlaneCollision(start, direction, v1, triangleNormal, result)) {\r\n            var bary = getBarycentricCoordinates(v1, v2, v3, result);\r\n        \treturn (bary[0] <= 1 && bary[0] >= 0) &&\r\n                (bary[1] <= 1 && bary[1] >= 0) &&\r\n                (bary[2] <= 1 && bary[2] >= 0);\r\n        }\r\n    \treturn false;\r\n    };\r\n\r\n    Math.geo.rayPlaneCollision = function (start, direction, planePoint, planeNormal, result) {\r\n\t\tvar numer = vec3.dot(planePoint, planeNormal) -\r\n            vec3.dot(planeNormal, start);\r\n\t\tvar denom = vec3.dot(planeNormal, direction);\r\n\t\tif (Math.abs(denom) < EPSILON) return false;\r\n\t\tvar t = numer / denom;\r\n\t\tif (t < 0.0) return false;\r\n\t\tif (result) {\r\n            vec3.scale(result, direction, t);\r\n            vec3.add(result, start, result);\r\n        }\r\n\t\treturn true;\r\n    };\r\n\r\n    Math.geo.rayAABBCollision = function (start, direction, minB, maxB, result) {\r\n        result = result || vec3.create();\r\n\r\n\t\tvar inside = true;\r\n\t\tvar quadrant = new Float32Array(3);\r\n\t\tvar i = 0|0;\r\n\t\tvar whichPlane;\r\n\t\tvar maxT = new Float32Array(3);\r\n\t\tvar candidatePlane = new Float32Array(3);\r\n\r\n\t\t/* Find candidate planes; this loop can be avoided if\r\n\t\trays cast all from the eye(assume perpsective view) */\r\n\t\tfor (i=0; i < 3; ++i)\r\n\t\t\tif(start[i] < minB[i]) {\r\n\t\t\t\tquadrant[i] = 1;\r\n\t\t\t\tcandidatePlane[i] = minB[i];\r\n\t\t\t\tinside = false;\r\n\t\t\t}else if (start[i] > maxB[i]) {\r\n\t\t\t\tquadrant[i] = 0;\r\n\t\t\t\tcandidatePlane[i] = maxB[i];\r\n\t\t\t\tinside = false;\r\n\t\t\t}else\t{\r\n\t\t\t\tquadrant[i] = 2;\r\n\t\t\t}\r\n\r\n\t\t/* Ray origin inside bounding box */\r\n\t\tif(inside)\t{\r\n\t\t\tvec3.copy(result, start);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t/* Calculate T distances to candidate planes */\r\n\t\tfor (i = 0; i < 3; ++i)\r\n\t\t\tif (quadrant[i] !== 2 && direction[i] !== 0)\r\n\t\t\t\tmaxT[i] = (candidatePlane[i] - start[i]) / direction[i];\r\n\t\t\telse\r\n\t\t\t\tmaxT[i] = -1;\r\n\r\n\t\t/* Get largest of the maxT's for final choice of intersection */\r\n\t\twhichPlane = 0;\r\n\t\tfor (i = 1; i < 3; i++)\r\n\t\t\tif (maxT[whichPlane] < maxT[i])\r\n\t\t\t\twhichPlane = i;\r\n\r\n\t\t/* Check final candidate actually inside box */\r\n\t\tif (maxT[whichPlane] < 0) return false;\r\n\t\tif (maxT[whichPlane] > Number.MAX_VALUE) return false; //NOT TESTED\r\n\r\n\t\tfor (i = 0; i < 3; ++i)\r\n\t\t\tif (whichPlane != i) {\r\n\t\t\t\tresult[i] = start[i] + maxT[whichPlane] * direction[i];\r\n\t\t\t\tif (result[i] < minB[i] || result[i] > maxB[i])\r\n\t\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tresult[i] = candidatePlane[i];\r\n\t\t\t}\r\n\t\treturn true;\r\n    };\r\n\r\n    Math.geo.rayPointDistance = function (start, direction, point) {\r\n        var aux = [0, 0, 0];\r\n        vec3.sub(aux, point, start);\r\n        vec3.cross(aux, direction, aux);\r\n        return vec3.len(aux);\r\n    };\r\n\r\n    Math.geo.pointPointDistance = function (p1, p2) {\r\n        var aux = [0, 0, 0];\r\n        vec3.sub(aux, p2, p1);\r\n        return vec3.len(aux);\r\n    };\r\n\r\n    Math.geo.triangulateFace = function (vertices) {\r\n        var triangulated = [];\r\n        for (var i = 0; i < vertices.length - 2; i++) {\r\n            triangulated.push([vertices[0], vertices[i + 1], vertices[i + 2]]);\r\n        }\r\n        return triangulated;\r\n    };\r\n\r\n    Math.geo.findClosestFace = function (position, faces) {\r\n        if (!faces.length) return null;\r\n        var distance = Math.geo.pointPointDistance(position, faces[0].computeCenter());\r\n        var closestFace = faces[0];\r\n        for (var i = 1; i < faces.length; i++) {\r\n            var newDistance = Math.geo.pointPointDistance(position, faces[i].computeCenter());\r\n            if (newDistance < distance) {\r\n                distance = newDistance;\r\n                closestFace = faces[i];\r\n            }\r\n        }\r\n        return closestFace;\r\n    };\r\n\r\n    function getBarycentricCoordinates (p1, p2, p3, point) {\r\n        var v0 = getVectorFromPoints(p1, p2);\r\n        var v1 = getVectorFromPoints(p1, p3);\r\n        var v2 = getVectorFromPoints(p1, point);\r\n\r\n    \tvar d00 = vec3.dot(v0, v0);\r\n    \tvar d01 = vec3.dot(v0, v1);\r\n    \tvar d11 = vec3.dot(v1, v1);\r\n    \tvar d20 = vec3.dot(v2, v0);\r\n    \tvar d21 = vec3.dot(v2, v1);\r\n    \tvar denom = d00 * d11 - d01 * d01;\r\n\r\n        var result = [(d11 * d20 - d01 * d21) / denom,\r\n            (d00 * d21 - d01 * d20) / denom, 0];\r\n        result[2] = 1 - result[0] - result[1];\r\n    \treturn result;\r\n    }\r\n\r\n    function getNormal (v1, v2, v3) {\r\n        var tmp1 = vec3.create();\r\n        var tmp2 = vec3.create();\r\n        vec3.sub(tmp1, v2, v1);\r\n        vec3.sub(tmp2, v3, v1);\r\n        vec3.cross(tmp1, tmp1, tmp2);\r\n        return tmp1;\r\n    }\r\n\r\n    function getVectorFromPoints (a, b) {\r\n        var output = vec3.create();\r\n        vec3.sub(output, b, a);\r\n        return output;\r\n    }\r\n})();\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('math-halfEdge-cube', function (instance) {\r\n        function cube () {\r\n            var mesh = new Math.HalfEdgeMesh();\r\n\r\n            var vhandle = [];\r\n            vhandle[0] = [-1, -1,  1];\r\n            vhandle[1] = [ 1, -1,  1];\r\n            vhandle[2] = [ 1,  1,  1];\r\n            vhandle[3] = [-1,  1,  1];\r\n            vhandle[4] = [-1, -1, -1];\r\n            vhandle[5] = [ 1, -1, -1];\r\n            vhandle[6] = [ 1,  1, -1];\r\n            vhandle[7] = [-1,  1, -1];\r\n            mesh.addVertices(vhandle);\r\n\r\n            var face_vhandles = [];\r\n            face_vhandles.push(vhandle[0]);\r\n            face_vhandles.push(vhandle[1]);\r\n            face_vhandles.push(vhandle[2]);\r\n            face_vhandles.push(vhandle[3]);\r\n            mesh.addFace(face_vhandles);\r\n\r\n            face_vhandles = [];\r\n            face_vhandles.push(vhandle[7]);\r\n            face_vhandles.push(vhandle[6]);\r\n            face_vhandles.push(vhandle[5]);\r\n            face_vhandles.push(vhandle[4]);\r\n            mesh.addFace(face_vhandles);\r\n\r\n            face_vhandles = [];\r\n            face_vhandles.push(vhandle[1]);\r\n            face_vhandles.push(vhandle[0]);\r\n            face_vhandles.push(vhandle[4]);\r\n            face_vhandles.push(vhandle[5]);\r\n            mesh.addFace(face_vhandles);\r\n\r\n            face_vhandles = [];\r\n            face_vhandles.push(vhandle[2]);\r\n            face_vhandles.push(vhandle[1]);\r\n            face_vhandles.push(vhandle[5]);\r\n            face_vhandles.push(vhandle[6]);\r\n            mesh.addFace(face_vhandles);\r\n\r\n            face_vhandles = [];\r\n            face_vhandles.push(vhandle[3]);\r\n            face_vhandles.push(vhandle[2]);\r\n            face_vhandles.push(vhandle[6]);\r\n            face_vhandles.push(vhandle[7]);\r\n            mesh.addFace(face_vhandles);\r\n\r\n            face_vhandles = [];\r\n            face_vhandles.push(vhandle[0]);\r\n            face_vhandles.push(vhandle[3]);\r\n            face_vhandles.push(vhandle[7]);\r\n            face_vhandles.push(vhandle[4]);\r\n            mesh.addFace(face_vhandles);\r\n\r\n            return mesh;\r\n        }\r\n\r\n        Math.HalfEdgeCube = cube;\r\n    }, ['math-halfEdge']);\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('math-halfEdge', function (instance) {\r\n        Math.HalfEdgeMesh = HalfEdgeMesh;\r\n    });\r\n\r\n    var HalfEdgeMesh = function () {\r\n        this.halfEdges = [];\r\n        this.vertices = [];\r\n        this.faces = [];\r\n\r\n        this.bounds = new Math.Octree();\r\n        this.bump();\r\n    };\r\n\r\n    HalfEdgeMesh.prototype.bump = function () {\r\n        this.lastBump = Date.now();\r\n    };\r\n\r\n    HalfEdgeMesh.prototype.addVertices = function (vertices) {\r\n        if (arguments.length > 1) this.addVertices.apply(this, arguments);\r\n        if (!Array.isArray(vertices)) return;\r\n        this.bounds.addItems(vertices);\r\n        for (var i = 0; i < vertices.length; i++) {\r\n            var vertex = vertices[i];\r\n            var index = this.vertices.indexOf(vertex);\r\n            if (index < 0) {\r\n                var _halfEdge = {};\r\n                _halfEdge.computeNormal = VertexComputeNormal;\r\n                _halfEdge.ownIndex = this.vertices.length;\r\n                _halfEdge.getFaces = VertexGetFaces;\r\n                _halfEdge.outEdges = [];\r\n                vertex._halfEdge = _halfEdge;\r\n                this.vertices.push(vertex);\r\n            } else {\r\n                console.error('addVertices: Adding vertex twice!', vertex);\r\n            }\r\n        }\r\n    };\r\n\r\n    HalfEdgeMesh.prototype.addFace = function (vertices) {\r\n        if (arguments.length > 1) this.addFace.apply(this, arguments);\r\n        if (!Array.isArray(vertices)) return;\r\n        if (vertices.length >= 3) {\r\n            var he1 = buildEdge(vertices[0], vertices[1]);\r\n            var he2 = buildEdge(vertices[1], vertices[2], he1.face);\r\n            he1.next = he2;\r\n            this.halfEdges.push(he1, he2);\r\n            if (vertices.length > 3) {\r\n                var last, prev = he2;\r\n                for (var i = 2; i < vertices.length - 1; i++) {\r\n                    last = buildEdge(vertices[i], vertices[i + 1], he1.face);\r\n                    if (!he2.next) he2.next = last;\r\n                    last.next = prev;\r\n                    this.halfEdges.push(last);\r\n                    prev = last;\r\n                }\r\n                last = buildEdge(vertices[i], vertices[0], he1.face);\r\n                last.next = he1;\r\n                this.halfEdges.push(last);\r\n                prev.next = last;\r\n            }\r\n            this.faces.push(he1.face);\r\n        } else {\r\n            console.error('addFace: 3 or more vertices needed to form a face!');\r\n        }\r\n    };\r\n\r\n    HalfEdgeMesh.prototype.onVertexChange = function (vertices) {\r\n        if (arguments.length > 1) this.onVertexChange.apply(this, arguments);\r\n        if (this.mesh !== null) {\r\n            for (var i = 0; i < vertices.length; i++) {\r\n                var vertex = vertices[i];\r\n                var buffer = this.mesh.vertexBuffers.vertices.data;\r\n                buffer[vertex._halfEdge.ownIndex * 3 + 0] = vertex[0];\r\n                buffer[vertex._halfEdge.ownIndex * 3 + 1] = vertex[1];\r\n                buffer[vertex._halfEdge.ownIndex * 3 + 2] = vertex[2];\r\n            }\r\n        }\r\n    };\r\n\r\n    HalfEdgeMesh.prototype.onVertexChangeIndex = function (indices) {\r\n        if (arguments.length > 1) this.onVertexChangeIndex.apply(this, arguments);\r\n        var vertices = this.vertices;\r\n        this.onVertexChange(indices.map(function (index) {\r\n            return vertices[index];\r\n        }));\r\n    };\r\n\r\n    HalfEdgeMesh.prototype.clear = function () {\r\n        this.halfEdges = [];\r\n        this.vertices = [];\r\n        this.faces = [];\r\n    };\r\n\r\n    HalfEdgeMesh.prototype.getFaces = function (ray, hitPoints) {\r\n        var uniqueFaces = [], collidingFaces = [];\r\n        var vertices = this.bounds.getCollidingItems(ray);\r\n        vertices.forEach(function (item) {\r\n            item._halfEdge.getFaces().forEach(function (face) {\r\n                if (uniqueFaces.indexOf(face) === -1)\r\n                    uniqueFaces.push(face);\r\n            });\r\n        });\r\n        uniqueFaces.forEach(function (face) {\r\n            var triangles = face.getVerticesTriangulated();\r\n            for (var i = 0; i < triangles.length; i++) {\r\n                var triangle = triangles[i], hitPoint = [0, 0, 0];\r\n                if (Math.geo.rayTriangleCollision(ray.start, ray.direction,\r\n                    triangle[0], triangle[1], triangle[2], hitPoint)) {\r\n                    collidingFaces.push(face);\r\n                    hitPoints.push(hitPoint);\r\n                    break;\r\n                }\r\n            }\r\n        });\r\n        return collidingFaces;\r\n    };\r\n\r\n    HalfEdgeMesh.prototype.getFace = function (ray, hitPoint) {\r\n        var hitPoints = [];\r\n        var uniqueFaces = this.getFaces(ray, hitPoints);\r\n        if (uniqueFaces.length === 0) return null;\r\n        var smallerIndex = 0, lastDistance = Number.MAX_VALUE;\r\n        uniqueFaces.forEach(function (face, index) {\r\n            var distance = vec3.dist(face.computeCenter(), ray.start);\r\n            if (distance < lastDistance) {\r\n                lastDistance = distance;\r\n                smallerIndex = index;\r\n            }\r\n        });\r\n        vec3.copy(hitPoint, hitPoints[smallerIndex]);\r\n        return uniqueFaces[smallerIndex];\r\n    };\r\n\r\n    function buildEdge (start, end, face) {\r\n        var edge = {};\r\n        edge.vertex = end;\r\n        edge.face = face ? face : new HalfEdgeFace(edge);\r\n        edge.opposite = findOppositeEdge(start, end) || edge;\r\n        edge.next = null;\r\n        start._halfEdge.outEdges.push(edge);\r\n        return edge;\r\n    }\r\n\r\n    function findOppositeEdge(start, end) {\r\n        var opposites = end._halfEdge.outEdges.filter(function (he) {\r\n            return he.vertex === start;\r\n        });\r\n        return (opposites && opposites[0]) ? opposites[0] : null;\r\n    }\r\n\r\n    function VertexGetFaces () {\r\n        return this.outEdges.map(function (edge) {\r\n            return edge.face;\r\n        });\r\n    }\r\n\r\n    function VertexComputeNormal () {\r\n        var normal = [0, 0, 0];\r\n        this.getFaces().forEach(function (face) {\r\n            vec3.add(normal, normal, face.computeRawNormal());\r\n        });\r\n        vec3.normalize(normal, normal);\r\n        return normal;\r\n    }\r\n\r\n    var HalfEdgeFace = function (halfEdge) {\r\n        this.halfEdge = halfEdge;\r\n    };\r\n\r\n    HalfEdgeFace.prototype.getEdges = function () {\r\n        var output = [];\r\n        var he = this.halfEdge;\r\n        while (he.next !== this.halfEdge) {\r\n            output.push(he);\r\n            he = he.next;\r\n        }\r\n        output.push(he);\r\n        return output;\r\n    };\r\n\r\n    HalfEdgeFace.prototype.getVertices = function () {\r\n        return this.getEdges().map(function (edge) {\r\n            return edge.vertex;\r\n        });\r\n    };\r\n\r\n    HalfEdgeFace.prototype.getVerticesTriangulated = function () {\r\n        var triangulated = [];\r\n        var vertices = this.getVertices();\r\n        for (var i = 0; i < vertices.length - 2; i++) {\r\n            triangulated.push([vertices[0], vertices[i + 1], vertices[i + 2]]);\r\n        }\r\n        return triangulated;\r\n    };\r\n\r\n    HalfEdgeFace.prototype.computeRawNormal = function () {\r\n        var normal = [0, 0, 0];\r\n        this.getVerticesTriangulated().forEach(function (triplet) {\r\n            var triangleNormal = computeNormal(triplet[0], triplet[1], triplet[2]);\r\n            vec3.add(normal, normal, triangleNormal);\r\n        });\r\n        return normal;\r\n    };\r\n\r\n    HalfEdgeFace.prototype.computeNormal = function () {\r\n        var normal = this.computeRawNormal();\r\n        vec3.normalize(normal, normal);\r\n        return normal;\r\n    };\r\n\r\n    HalfEdgeFace.prototype.computeCenter = function () {\r\n        var vertices = this.getVertices();\r\n        var center = vertices.reduce(function(center, p, i) {\r\n            vec3.add(center, center, p);\r\n            return center;\r\n        }, [0, 0, 0]);\r\n        vec3.scale(center, center, 1 / vertices.length);\r\n        return center;\r\n    };\r\n\r\n    function computeNormal (v1, v2, v3) {\r\n        var tmp1 = vec3.create();\r\n        var tmp2 = vec3.create();\r\n        vec3.sub(tmp1, v2, v1);\r\n        vec3.sub(tmp2, v3, v1);\r\n        vec3.cross(tmp1, tmp1, tmp2);\r\n        return tmp1;\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n    \r\n    Modules.prototype.add('surface', function (instance) {\r\n        instance.pane.types.surface = {\r\n            onPaneType: onSurfacePaneType,\r\n            onCreateHeader: onCreateSurfaceHeader\r\n        };\r\n\r\n        instance.events.on('pane.resize', function (pane) {\r\n            if (pane.attrData('pane-type') === 'surface')\r\n                updateCanvasSize(instance, pane);\r\n        });\r\n\r\n        window.addEventListener('resize', function (event) {\r\n            var surfaces = instance.pane.internal.container\r\n                .querySelectorAll('.pane canvas');\r\n            for (var i = 0; i < surfaces.length; i++) {\r\n                updateCanvasSize(instance, surfaces[i].parentNode);\r\n            }\r\n        });\r\n\r\n        instance.surface = {};\r\n    }, ['pane-types']);\r\n\r\n    var surfaceIndex = 0;\r\n    function onSurfacePaneType (pane, instance) {\r\n        var canvas = document.createElement('canvas');\r\n        canvas.id = 'surface' + (surfaceIndex++);\r\n        canvas.className = 'surface';\r\n        pane.appendChild(canvas);\r\n\r\n        instance.surface.map = instance.surface.map || {};\r\n        instance.surface.map[canvas.id] = {\r\n            camera: new Math.Camera()\r\n        };\r\n\r\n        updateCanvasSize(instance, pane);\r\n\r\n        instance.events.trigger('surface.create', canvas);\r\n    }\r\n\r\n    function onCreateSurfaceHeader (header, instance) {\r\n        var label = document.createElement('label');\r\n        label.innerHTML = 'Surface Pane';\r\n        header.appendChild(label);\r\n    }\r\n\r\n    function updateCanvasSize (instance, pane) {\r\n        var canvas = pane.querySelector('canvas');\r\n        var context = canvas.getContext('2d');\r\n        var data = instance.surface.map[canvas.id];\r\n\r\n        var header = pane.querySelector('.pane-header');\r\n        var headerHeight = header ? header.height() : 0;\r\n\r\n        var width = pane.width(), height = pane.height() - headerHeight;\r\n        data.imgData = context.createImageData(width, height);\r\n        data.buffer = new Uint8Array(width * height * 4);\r\n\r\n        canvas.height = height;\r\n        canvas.width = width;\r\n\r\n        mat4.perspective(data.camera.projection, 45 * DEG2RAD, width / height, 0.1, 1000);\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var originalRotation = null;\r\n    var mouseDownCoords = null;\r\n\r\n    Modules.prototype.add('common-interaction', function (instance) {\r\n        instance.surface.interactions.common = {\r\n            onMouseWheel: function (event, realCoords) {\r\n                var canvas = event.target;\r\n                var delta = Math.max(-1, Math.min(1, (event.wheelDelta || -event.detail)));\r\n                delta /= 2;\r\n\r\n                var data = instance.surface.map[canvas.id];\r\n                data.camera.distance -= delta;\r\n                data.camera.distance = Math.max(data.camera.distance, 0);\r\n\r\n                return true;\r\n            },\r\n            onMouseMove: function (event, realCoords) {\r\n                if (event.target.dataset.moving) {\r\n                    var canvas = event.target;\r\n                    var data = instance.surface.map[canvas.id];\r\n                    if (data) {\r\n                        var delta = getCoordsDelta(mouseDownCoords, realCoords);\r\n                        combine(data.camera, originalRotation, delta);\r\n                    }\r\n                }\r\n                return false;\r\n            },\r\n            onMouseDown: function (event, realCoords) {\r\n                var canvas = event.target;\r\n                var data = instance.surface.map[canvas.id];\r\n                if (event.which === 3) {\r\n                    event.target.dataset.moving = 'true';\r\n                    upNormalMouseDown = vec3.equals(data.camera.getUpDirection(), [0, 1, 0]);\r\n                    originalRotation = data.camera.rotation.slice();\r\n                    mouseDownCoords = realCoords;\r\n                    return false;\r\n                }\r\n                return true;\r\n            },\r\n            onMouseUp: function (event, realCoords) {\r\n                if (event.which === 3) {\r\n                    delete event.target.dataset.moving;\r\n                    var data = instance.surface.map[event.target.id];\r\n                    mouseDownCoords = null;\r\n                }\r\n                return true;\r\n            },\r\n            onClick: function (event, realCoords) {\r\n                return true;\r\n            },\r\n            onRender: function (surface) {}\r\n        };\r\n    }, ['surface-interaction']);\r\n\r\n    var upNormalMouseDown = true;\r\n    function combine (surface, originalRotation, delta) {\r\n        if (!originalRotation) return;\r\n        if (!upNormalMouseDown) delta[0] = -delta[0];\r\n\r\n        var rotation = surface.rotation;\r\n        rotation[0] = originalRotation[0] + delta[0] * 0.005;\r\n        rotation[1] = originalRotation[1] + delta[1] * 0.005;\r\n        clampRotations(rotation);\r\n    }\r\n\r\n    function getCoordsDelta (initial, current) {\r\n        if (!initial) return [0, 0];\r\n        return [\r\n            initial[0] - current[0],\r\n            initial[1] - current[1]\r\n        ];\r\n    }\r\n\r\n    function clampRotations (rotations) {\r\n        var pi2 = Math.PI * 2;\r\n        if (rotations[0] < 0) rotations[0] = pi2 + rotations[0];\r\n        if (rotations[0] >= pi2) rotations[0] = rotations[0] - pi2;\r\n        if (rotations[1] < 0) rotations[1] = pi2 + rotations[1];\r\n        if (rotations[1] >= pi2) rotations[1] = rotations[1] - pi2;\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('edit-interaction-render', function (instance) {\r\n        var shader = null;\r\n        instance.asset.shader.get('wireframe', function (s) {\r\n            shader = s;\r\n        });\r\n\r\n        var uniforms = {\r\n            u_mvp: mat4.create()\r\n        };\r\n\r\n        var temp = mat4.create();\r\n        instance.surface.interactions.edit.onRender = function (surface) {\r\n            instance.scene.getObjects().forEach(function (node) {\r\n                var obj = node.data;\r\n\r\n                surface.camera.getViewMatrix(temp);\r\n                mat4.multiply(temp, surface.camera.projection, temp);\r\n                mat4.multiply(uniforms.u_mvp, temp, obj.model);\r\n\r\n                if (shader) {\r\n                    shader.uniforms(uniforms);\r\n                    if (obj.mesh instanceof Math.HalfEdgeMesh) {\r\n                        instance.graphics.gl.lineWidth(5);\r\n                        var mesh = getCachedVBOMesh(obj.mesh);\r\n                        shader.draw(mesh, instance.graphics.gl.LINES);\r\n                    }\r\n                }\r\n            });\r\n        };\r\n    }, ['edit-interaction', 'shader']);\r\n\r\n    var cacheKey = 'edit-interaction-render';\r\n    function getCachedVBOMesh (halfEdgeMesh) {\r\n        halfEdgeMesh._cache = halfEdgeMesh._cache || {};\r\n        if (halfEdgeMesh._cache[cacheKey]) {\r\n            if (halfEdgeMesh._cache[cacheKey].time <= halfEdgeMesh.lastBump) {\r\n                halfEdgeMesh._cache[cacheKey] = buildMeshFromHalfEdges(halfEdgeMesh);\r\n                halfEdgeMesh._cache[cacheKey].time = Date.now();\r\n            }\r\n        } else {\r\n            halfEdgeMesh._cache[cacheKey] = buildMeshFromHalfEdges(halfEdgeMesh);\r\n            halfEdgeMesh._cache[cacheKey].time = Date.now();\r\n        }\r\n        return halfEdgeMesh._cache[cacheKey];\r\n    }\r\n\r\n    function buildMeshFromHalfEdges (halfEdgeMesh) {\r\n        var buffers = {};\r\n\r\n        buffers.vertices = new Float32Array(halfEdgeMesh.vertices.length * 3);\r\n        halfEdgeMesh.vertices.forEach(function (vertex, i) {\r\n            buffers.vertices[i * 3 + 0] = vertex[0];\r\n            buffers.vertices[i * 3 + 1] = vertex[1];\r\n            buffers.vertices[i * 3 + 2] = vertex[2];\r\n        });\r\n        buffers.colors = new Float32Array(halfEdgeMesh.vertices.length * 4);\r\n        halfEdgeMesh.vertices.forEach(function (vertex, i) {\r\n            var color = vertex._selected ? [1, 0.4, 0.1, 1] : [0, 0, 0, 1];\r\n            for (var j = 0; j < 4; j++)\r\n                buffers.colors[i * 4 + j] = color[j];\r\n        });\r\n\r\n        var indices = [];\r\n        halfEdgeMesh.faces.forEach(function (face) {\r\n            face.getVertices().forEach(function (vertex, i, array) {\r\n                var index = i >= array.length - 1 ? 0 : i + 1;\r\n                indices.push(vertex._halfEdge.ownIndex);\r\n                indices.push(array[index]._halfEdge.ownIndex);\r\n            });\r\n        });\r\n        buffers.lines = new Uint16Array(indices);\r\n\r\n        return GL.Mesh.load(buffers);\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('edit-interaction-selection', function (instance) {\r\n        instance.surface.interactions.edit.selection = {\r\n            objects: {},\r\n            add: function (ray, object, position) {\r\n                position = position || [0, 0, 0];\r\n                var selection = this;\r\n\r\n                var vertices = object.mesh.bounds.getCollidingItems(ray);\r\n                vertices.forEach(function (vertex) {\r\n                    if (Math.geo.rayPointDistance(ray.start, ray.direction, vertex) <= 0.2) {\r\n                        toggleVertex(selection, object, vertex);\r\n                    }\r\n                });\r\n\r\n                var uniqueEdges = getEdgesFromVertices(vertices);\r\n                uniqueEdges.forEach(function (edge) {\r\n                    //TODO: check edge distance to ray -> if close -> add\r\n                });\r\n\r\n                var uniqueFaces = getFacesFromVertices(vertices);\r\n                uniqueFaces = uniqueFaces.filter(function (face) {\r\n                    return Math.geo.rayFaceCollision(ray.start, ray.direction,\r\n                        face.getVertices());\r\n                });\r\n                toggleFace(selection, object, Math.geo.findClosestFace(position, uniqueFaces));\r\n            },\r\n            clear: function () {\r\n                this.objects = {};\r\n            },\r\n            isEmpty: function () {\r\n                return true;\r\n            }\r\n        };\r\n\r\n    }, ['edit-interaction']);\r\n\r\n    function toggleVertex (selection, object, vertex) {\r\n        if (vertex) {\r\n            if (toggle(selection, object, vertex, 'vertices')) {\r\n                vertex._selected = true;\r\n            } else delete vertex._selected;\r\n        }\r\n    }\r\n\r\n    function toggleEdge (selection, object, edge) {\r\n        if (edge) {\r\n            if (toggle(selection, object, edge, 'edges')) {\r\n                edge._selected = true;\r\n            } else delete edge._selected;\r\n        }\r\n    }\r\n\r\n    function toggleFace (selection, object, face) {\r\n        if (face) {\r\n            if (toggle(selection, object, face, 'faces')) {\r\n                face._selected = true;\r\n            } else delete face._selected;\r\n        }\r\n    }\r\n\r\n    function toggle (selection, object, item, arrayName) {\r\n        initObjectIfNeeded(selection, object);\r\n        var array = selection.objects[object.name][arrayName];\r\n        var index = array.indexOf(item);\r\n        if (index >= 0) {\r\n            array.splice(index, 1);\r\n            delObjectIfNeeded(selection, object);\r\n            return false;\r\n        } else {\r\n            array.push(item);\r\n            return true;\r\n        }\r\n    }\r\n\r\n    function initObjectIfNeeded (selection, object) {\r\n        var name = object.name;\r\n        if (!selection.objects[name]) {\r\n            selection.objects[name] = {\r\n                faces: [],\r\n                edges: [],\r\n                vertices: []\r\n            };\r\n        }\r\n    }\r\n\r\n    function delObjectIfNeeded (selection, object) {\r\n        var name = object.name;\r\n        if (selection.objects[name]) {\r\n            var objSelection = selection.objects[name];\r\n            if (!objSelection.vertices.length &&\r\n                !objSelection.vertices.length &&\r\n                !objSelection.vertices.length)\r\n                delete selection.objects[name];\r\n        }\r\n    }\r\n\r\n    function getEdgesFromVertices (vertices) {\r\n        var edges = [];\r\n        vertices.forEach(function (vertex) {\r\n            vertex._halfEdge.outEdges.forEach(function (edge) {\r\n                if (edges.indexOf(edge) === -1)\r\n                    edges.push(edge);\r\n            });\r\n        });\r\n        return edges;\r\n    }\r\n\r\n    function getFacesFromVertices (vertices) {\r\n        var faces = [];\r\n        vertices.forEach(function (vertex) {\r\n            vertex._halfEdge.getFaces().forEach(function (face) {\r\n                if (faces.indexOf(face) === -1)\r\n                    faces.push(face);\r\n            });\r\n        });\r\n        return faces;\r\n    }\r\n\r\n    function saveOriginalVertexPosition (vertices) {\r\n        vertices.forEach(function (vertex) {\r\n            vertex.originalPosition = vertex.slice();\r\n        });\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var isMouseDown = false;\r\n    var initialHitPoint = [0, 0, 0];\r\n\r\n    Modules.prototype.add('edit-interaction', function (instance) {\r\n        instance.surface.interactions.edit = {\r\n            onMouseWheel: function (event, realCoords) {\r\n                return true;\r\n            },\r\n            onMouseMove: function (event, realCoords) {\r\n                if (isMouseDown && !this.selection.isEmpty()) {\r\n                    var canvas = event.target;\r\n                    var data = instance.surface.map[canvas.id];\r\n                    var object = this.selection.objects[0];\r\n\n                    var ray = data.camera.getRay(null, realCoords,\r\n                        [canvas.width, canvas.height]);\r\n                    var cameraDirection = data.camera.getDirection();\r\n                    var face = this.selection.faces[0];\r\n\r\n                    var hitPoint = [0, 0, 0];\r\n                    if (Math.geo.rayPlaneCollision(ray.start, ray.direction, initialHitPoint, cameraDirection, hitPoint)) {\r\n                        var diff = [0, 0, 0];\r\n                        vec3.sub(diff, hitPoint, initialHitPoint);\r\n                        face.getVertices().forEach(function (vertex) {\r\n                            vec3.add(vertex, vertex.originalPosition, diff);\r\n                            object.bounds.updateDimensions();\r\n                            object.bump();\r\n                        });\r\n                    }\r\n                }\r\n                return true;\r\n            },\r\n            onMouseDown: function (event, realCoords) {\r\n                var canvas = event.target;\r\n                var data = instance.surface.map[canvas.id];\r\n                if (event.which === 1) {\r\n                    isMouseDown = true;\r\n\r\n                    var ray = data.camera.getRay(null, realCoords,\r\n                        [canvas.width, canvas.height]);\r\n\r\n                    var selection = this.selection;\r\n                    instance.scene.getObjects().forEach(function (node) {\r\n                        //selection.clear();\r\n                        selection.add(ray, node.data, data.camera.position);\r\n                        node.data.mesh.bump();\r\n                    });\r\n                    return false;\r\n                }\r\n                return true;\r\n            },\r\n            onMouseUp: function (event, realCoords) {\r\n                isMouseDown = false;\r\n                return true;\r\n            },\r\n            onClick: function (event, realCoords) {\r\n                return true;\r\n            }\r\n        };\r\n\r\n        instance.events.on('surface.create', function (surface) {\n            instance.surface.setInteraction(surface, 'edit');\n        });\n\n    }, ['surface-interaction']);\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('object-interaction', function (instance) {\r\n        instance.surface.interactions.object = {\r\n            onMouseWheel: function (event, realCoords) {\r\n                return true;\r\n            },\r\n            onMouseMove: function (event, realCoords) {\r\n                return true;\r\n            },\r\n            onMouseDown: function (event, realCoords) {\r\n                var canvas = event.target;\r\n                var data = instance.surface.map[canvas.id];\r\n                if (event.which === 1) {\r\n                    var ray = data.camera.getRay(null, realCoords,\r\n                        [canvas.width, canvas.height]);\r\n\r\n                    var isHit = false, hitPoint = vec3.create();\r\n                    instance.scene.getObjects().forEach(function (node) {\r\n                        isHit = geo.testRayBBox(ray.start, ray.direction, node.data.mesh.bounding, node.data.model, hitPoint);\r\n                        if (isHit) {\r\n                            node.data.selected = true;\r\n                        } else delete node.data.selected;\r\n                    });\r\n                    return false;\r\n                }\r\n                return true;\r\n            },\r\n            onMouseUp: function (event, realCoords) {\r\n                return true;\r\n            },\r\n            onClick: function (event, realCoords) {\r\n                return true;\r\n            },\r\n            onRender: function (surface) {}\r\n        };\r\n\r\n    }, ['surface-interaction']);\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('surface-interaction', function (instance) {\r\n        instance.surface.interactions = {};\r\n\r\n        instance.surface.setInteraction = function (surface, name) {\r\n            surface.dataset.interaction = name;\r\n        };\r\n\r\n        instance.surface.getInteractionCallbacks = function (surface) {\r\n            var interactionName = surface.dataset.interaction;\r\n            return instance.surface.interactions[interactionName];\r\n        };\r\n\r\n        instance.surface.onRender = function (canvas, surface) {\r\n            var keepRunning = true;\r\n            var callbacks = instance.surface.getInteractionCallbacks(canvas);\r\n            if (callbacks.onRender) keepRunning = callbacks.onRender(surface);\r\n            if (keepRunning) {\r\n                var common = instance.surface.interactions.common;\r\n                common.onRender(surface);\r\n            }\r\n        };\r\n\r\n        instance.events.on('surface.create', function (surface) {\r\n            surface.oncontextmenu = onContextMenu;\r\n            surface.onmousewheel = onSurfaceEvent;\r\n            surface.onmousemove = onSurfaceEvent;\r\n            surface.onmousedown = onSurfaceEvent;\r\n            surface.onmouseup = onSurfaceEvent;\r\n            surface.onclick = onSurfaceEvent;\r\n        });\r\n\r\n        function onSurfaceEvent (event) {\r\n            var callbacks = instance.surface.getInteractionCallbacks(event.target);\r\n            var keepRunning = runCallback(callbacks, event);\r\n            if (keepRunning) {\r\n                var common = instance.surface.interactions.common;\r\n                runCallback(common, event);\r\n            }\r\n        }\r\n\r\n        function onContextMenu (event) {\r\n            event.preventDefault();\r\n            return false;\r\n        }\r\n\r\n        instance.events.on('pane.split', function (oldPane, newPane) {\r\n            var initialValue = oldPane.dataset.interaction;\r\n            newPane.dataset.interaction = initialValue;\r\n        });\r\n    }, ['surface']);\r\n\r\n    function runCallback (callbacks, event) {\r\n        var realCoords = getLocalCoordinates(event);\r\n        switch (event.type) {\r\n            case 'mousewheel': return callbacks.onMouseWheel(event, realCoords);\r\n            case 'mousemove': return callbacks.onMouseMove(event, realCoords);\r\n            case 'mousedown': return callbacks.onMouseDown(event, realCoords);\r\n            case 'mouseup': return callbacks.onMouseUp(event, realCoords);\r\n            case 'click': return callbacks.onClick(event, realCoords);\r\n        }\r\n    }\r\n\r\n    function getLocalCoordinates (event) {\r\n        return [event.layerX, event.layerY];\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('render-solid', function (instance) {\r\n        var shader = null;\r\n        instance.asset.shader.get('solid', function (s) {\r\n            shader = s;\r\n        });\r\n\r\n        var grid = {\r\n            type: 'object',\r\n            primitive: instance.graphics.gl.LINES,\r\n            mesh: GL.Mesh.grid({\r\n                lines: 11,\r\n                size: 10\r\n            }),\r\n            model: mat4.create(),\r\n        };\r\n\r\n        instance.surface.renders.solid = function (surface) {\r\n            var lightDirection = vec3.create();\r\n            surface.camera.getPosition(lightDirection);\r\n            vec3.add(lightDirection, lightDirection, [1, 2, 0]);\r\n            vec3.normalize(lightDirection, lightDirection);\r\n            uniforms.u_lightvector = lightDirection;\r\n\r\n            renderObject(surface, grid, shader);\r\n            instance.scene.getObjects().forEach(function (node) {\r\n                renderObject(surface, node.data, shader);\r\n            });\r\n        };\r\n\r\n        instance.events.on('surface.create', function (surface) {\r\n            instance.surface.setRender(surface, 'solid');\r\n        });\r\n    }, ['surface-render', 'shader']);\r\n\r\n    var uniforms = {\r\n        u_color: [0.7, 0.7, 0.7, 1],\r\n        u_lightvector: null,\r\n        u_model: null,\r\n        u_mvp: mat4.create()\r\n    };\r\n\r\n    var temp = mat4.create();\r\n    function renderObject (surface, obj, shader) {\r\n        surface.camera.getViewMatrix(temp);\r\n        mat4.multiply(temp, surface.camera.projection, temp);\r\n        mat4.multiply(uniforms.u_mvp, temp, obj.model);\r\n\r\n        uniforms.u_model = obj.model;\r\n\r\n        if (shader) {\r\n            shader.uniforms(uniforms);\r\n            if (obj.mesh instanceof Math.HalfEdgeMesh) {\r\n                var mesh = getCachedVBOMesh(obj.mesh);\r\n                shader.draw(mesh, obj.primitive);\r\n            } else {\r\n                shader.draw(obj.mesh, obj.primitive);\r\n            }\r\n        }\r\n    }\r\n\r\n    var cacheKey = 'render-solid';\r\n    function getCachedVBOMesh (halfEdgeMesh) {\r\n        halfEdgeMesh._cache = halfEdgeMesh._cache || {};\r\n        if (halfEdgeMesh._cache[cacheKey]) {\r\n            if (halfEdgeMesh._cache[cacheKey].time <= halfEdgeMesh.lastBump) {\r\n                halfEdgeMesh._cache[cacheKey] = buildMeshFromHalfEdges(halfEdgeMesh);\r\n                halfEdgeMesh._cache[cacheKey].time = Date.now();\r\n            }\r\n        } else {\r\n            halfEdgeMesh._cache[cacheKey] = buildMeshFromHalfEdges(halfEdgeMesh);\r\n            halfEdgeMesh._cache[cacheKey].time = Date.now();\r\n        }\r\n        return halfEdgeMesh._cache[cacheKey];\r\n    }\r\n\r\n    function buildMeshFromHalfEdges (halfEdgeMesh) {\r\n        var buffers = {};\r\n\r\n        var vertices = [], normals = [];\r\n        halfEdgeMesh.faces.forEach(function (face) {\r\n            var faceNormal = face.computeNormal();\r\n            face.getVerticesTriangulated().forEach(function (triangles) {\r\n                triangles.forEach(function (triangle) {\r\n                    vertices.push(triangle[0], triangle[1], triangle[2]);\r\n                    normals.push(faceNormal[0], faceNormal[1], faceNormal[2]);\r\n                });\r\n            });\r\n        });\r\n\r\n        buffers.vertices = new Float32Array(vertices);\r\n        buffers.normals = new Float32Array(normals);\r\n        return GL.Mesh.load(buffers);\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    Modules.prototype.add('surface-render', function (instance) {\r\n        instance.surface.renders = {};\r\n\r\n        instance.surface.setRender = function (surface, name) {\r\n            surface.dataset.render = name;\r\n        };\r\n\r\n        instance.surface.getRender = function (surface) {\r\n            var renderName = surface.dataset.render;\r\n            return instance.surface.renders[renderName];\r\n        };\r\n\r\n        var panes = document.querySelectorAll('.pane');\r\n        for (var i = 0; i < panes.length; i++) {\r\n            if (panes[i].dataset.paneType == 'surface') {\r\n                var canvas = panes[i].querySelector('canvas');\r\n                canvas.dataset.render = 'solid';\r\n            }\r\n        }\r\n\r\n        instance.events.on('pane.split', function (oldPane, newPane) {\r\n            newPane.attrData('surface-render', oldPane.attrData('surface-render'));\r\n        });\r\n    }, ['surface']);\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var Graphics = function (instance) {\r\n        this.gl = GL.create({\r\n            height: screen.height,\r\n            width: screen.width\r\n        });\r\n        this.gl.animate();\r\n        this.gl.ondraw = function () {\r\n            var renderTargets = document.querySelectorAll('canvas');\r\n            for (var i = 0; i < renderTargets.length; i++)\r\n                drawRenderTarget(instance, renderTargets[i]);\r\n        };\r\n        this.gl.clearColor(0.349, 0.349, 0.349, 1);\r\n        this.gl.enable(this.gl.DEPTH_TEST);\r\n    };\r\n\r\n    Modules.prototype.add('graphics', function (instance) {\r\n        instance.graphics = new Graphics(instance);\r\n    });\r\n\r\n    function drawRenderTarget (instance, canvas) {\r\n        var data = instance.surface.map[canvas.id];\r\n        var gl = instance.graphics.gl;\r\n\r\n        var width  = canvas.clientWidth, height = canvas.clientHeight;\r\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n        gl.viewport(0, 0, width, height);\r\n\r\n        var mainRender = instance.surface.getRender(canvas);\r\n        if (mainRender) mainRender(data);\r\n        instance.surface.onRender(canvas, data);\r\n\r\n        var context = canvas.getContext('2d');\r\n        if (context) {\r\n            gl.readPixels(0, 0, width, height, gl.RGBA, gl.UNSIGNED_BYTE, data.buffer);\r\n            data.imgData.data.set(data.buffer);\r\n            context.putImageData(data.imgData, 0, 0);\r\n        }\r\n    }\r\n})());\r\n","((function () {\r\n    'use strict';\r\n\r\n    var objectCount = 0;\r\n    var lightCount = 0;\r\n\r\n    Modules.prototype.add('scene', function (instance) {\r\n        instance.scene = TreeNode.extend();\r\n\r\n        instance.scene.addObject = function (info) {\r\n            if (!info.primitive) info.primitive = instance.graphics.gl.TRIANGLES;\r\n            if (!info.model) info.model = mat4.create();\r\n            if (!info.type) info.type = 'object';\r\n            if (!info.name) info.name = 'object_' + (objectCount++);\r\n            this.add(info);\r\n        };\r\n\r\n        instance.scene.addLight = function (info) {\r\n            if (!info.model) info.position = [0, 0, 0];\r\n            if (!info.color) info.color = [1, 1, 1];\r\n            if (!info.intensity) info.intensity = 1;\r\n            if (!info.type) info.type = 'light';\r\n            if (!info.name) info.name = 'light_' + (lightCount++);\r\n            this.add(info);\r\n        };\r\n\r\n        instance.scene.getObjects = function () {\r\n            return this.dfs(function (node) {\r\n                return node.data.type === 'object';\r\n            });\r\n        };\r\n\r\n        instance.scene.getLights = function () {\r\n            return this.dfs(function (node) {\r\n                return node.data.type === 'light';\r\n            });\r\n        };\r\n\r\n        instance.scene.addObject({mesh: Math.HalfEdgeCube()});\r\n        instance.scene.addLight({position: [0, 10, 5]});\r\n    }, ['graphics', 'math-halfEdge-cube']);\r\n})());\r\n"]}