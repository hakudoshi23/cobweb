"use strict";!function(){function t(t,e,n){t[e]||(t[e]=n)}t(Array.prototype,"unique",function(){for(var t=this.concat(),e=0;e<t.length;++e)for(var n=e+1;n<t.length;++n)t[e]===t[n]&&t.splice(n--,1);return t}),t(HTMLElement.prototype,"addClass",function(){for(var t in arguments){var e=this.className?this.className.trim().replace(/\s+/g," ").split(" "):[],n=arguments[t]?arguments[t].trim().replace(/\s+/g," ").split(" "):[];this.className=e.concat(n).unique().join(" ")}}),t(HTMLElement.prototype,"height",function(){return this.getBoundingClientRect().height}),t(HTMLElement.prototype,"width",function(){return this.getBoundingClientRect().width})}(),function(){var t=function(){this.listeners={}};t.prototype.trigger=function(){for(var t=arguments[0],e=this.listeners[t]||[],n=0;n<e.length;n++)Array.prototype.splice.call(arguments,0,1),e[n].apply(null,arguments)},t.prototype.on=function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},t.prototype.off=function(t){delete this.listeners[t]},t.prototype.off=function(t,e){if(this.listeners[t]){var n=this.listeners[t];n.indexOf(e)>-1&&n.splice(index,1)}},window.EventHandler=t}(),function(){function t(e,n){for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];"object"==typeof o?t(e[i],n[i]):e[i]=n[i]}}var e=function(n){this.options={container:{selector:"#cobweb",className:"cb-container"},menu:{className:"cb-menu"},logger:{className:"cb-logger"}},n&&"object"==typeof n&&t(this.options,n),this.container=document.querySelector(this.options.container.selector),this.container.addClass(this.options.container.className),this.gl=GL.create({height:container.height(),width:container.width()}),this.container.append(this.gl.canvas),this.events=new EventHandler,e.prototype.enablePlugins(this),this.events.on("resize",function(t){t.gl.canvas.height=t.container.height(),t.gl.canvas.width=t.container.width()});var i=this;window.addEventListener("resize",function(t){i.events.trigger("resize",i)})};e.prototype.plugins={},e.prototype.enablePlugins=function(t){for(var n in e.prototype.plugins)t[n]=new e.prototype.plugins[n](t)},window.Cobweb=e}(),function(){var t=function(t){var e=document.createElement("DIV");e.addClass(t.options.logger.className),t.container.append(e);var n=document.createElement("DIV");n.innerHTML="Lorem ipsum...",n.addClass("info"),e.append(n),this.info=function(t){n.innerHTML=t},t.events.on("logger.info",this.info)};Cobweb.prototype.plugins.logger=t}(),function(){var t=function(t){this.container=document.createElement("DIV"),this.container.addClass(t.options.menu.className),t.container.append(this.container);var e=document.createElement("UL");e.addClass("main-menu"),this.container.append(e),this.items={File:[{"Load...":function(){console.log("item click!")}}],"Alert!":function(){t.events.trigger("logger.info","LOOK AT ME! O_O"),window.setTimeout(function(){t.events.trigger("logger.info","STAPH!")},2e3)},Help:[{"About WebMesh":function(){console.log("About what?!")}}]},this.update()};t.prototype.update=function(){for(var t in this.items){var e=document.createElement("LI");e.innerHTML=t,e.addClass(t);var n=this.items[t];"function"==typeof n&&(e.onclick=n);var i=this.container.querySelector(".main-menu");i.append(e)}},Cobweb.prototype.plugins.menu=t}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInV0aWxzLmpzIiwiZXZlbnRzLmpzIiwiY29id2ViLmpzIiwibG9nZ2VyLmpzIiwibWVudS5qcyJdLCJuYW1lcyI6WyJzYWZlT3ZlcnJpZGUiLCJwcm90b3R5cGUiLCJwcm9wZXJ0eSIsInZhbHVlIiwiQXJyYXkiLCJhIiwidGhpcyIsImNvbmNhdCIsImkiLCJsZW5ndGgiLCJqIiwic3BsaWNlIiwiSFRNTEVsZW1lbnQiLCJhcmd1bWVudHMiLCJvbGRDbGFzc05hbWVzIiwiY2xhc3NOYW1lIiwidHJpbSIsInJlcGxhY2UiLCJzcGxpdCIsIm5ld0NsYXNzTmFtZXMiLCJ1bmlxdWUiLCJqb2luIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwiaGVpZ2h0Iiwid2lkdGgiLCJFdmVudEhhbmRsZXIiLCJsaXN0ZW5lcnMiLCJ0cmlnZ2VyIiwibmFtZSIsImNhbGwiLCJhcHBseSIsIm9uIiwiY2FsbGJhY2siLCJwdXNoIiwib2ZmIiwiYXJyYXkiLCJpbmRleE9mIiwiaW5kZXgiLCJ3aW5kb3ciLCJleHRlbmQiLCJzb3VyY2UiLCJwcm9wZXJ0aWVzIiwiaGFzT3duUHJvcGVydHkiLCJDb2J3ZWIiLCJvcHRpb25zIiwiY29udGFpbmVyIiwic2VsZWN0b3IiLCJtZW51IiwibG9nZ2VyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWRkQ2xhc3MiLCJnbCIsIkdMIiwiY3JlYXRlIiwiYXBwZW5kIiwiY2FudmFzIiwiZXZlbnRzIiwiZW5hYmxlUGx1Z2lucyIsImluc3RhbmNlIiwic2NvcGUiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJwbHVnaW5zIiwiTG9nZ2VyIiwiY3JlYXRlRWxlbWVudCIsImluZm8iLCJpbm5lckhUTUwiLCJ0ZXh0IiwiTWVudSIsIml0ZW1zIiwiRmlsZSIsIkxvYWQuLi4iLCJjb25zb2xlIiwibG9nIiwiQWxlcnQhIiwic2V0VGltZW91dCIsIkhlbHAiLCJBYm91dCBXZWJNZXNoIiwidXBkYXRlIiwiaXRlbSIsImxpIiwib25jbGlj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LE9BRUFDLFVBQUEsV0FDQUMsUUFBQUMsSUFBQSxrQkFJQUMsU0FBQSxXQUNBaEIsRUFBQUYsT0FBQTlCLFFBQUEsY0FBQSxtQkFDQVcsT0FBQXNDLFdBQUEsV0FDQWpCLEVBQUFGLE9BQUE5QixRQUFBLGNBQUEsV0FDQSxNQUVBa0QsT0FFQUMsZ0JBQUEsV0FDQUwsUUFBQUMsSUFBQSxvQkFNQXBFLEtBQUF5RSxTQUdBVixHQUFBcEUsVUFBQThFLE9BQUEsV0FDQSxJQUFBLEdBQUFDLEtBQUExRSxNQUFBZ0UsTUFBQSxDQUNBLEdBQUFXLEdBQUFoQyxTQUFBZ0IsY0FBQSxLQUNBZ0IsR0FBQWQsVUFBQWEsRUFDQUMsRUFBQTlCLFNBQUE2QixFQUVBLElBQUE3RSxHQUFBRyxLQUFBZ0UsTUFBQVUsRUFDQSxtQkFBQTdFLEtBQ0E4RSxFQUFBQyxRQUFBL0UsRUFHQSxJQUFBZ0YsR0FBQTdFLEtBQUF1QyxVQUFBSyxjQUFBLGFBQ0FpQyxHQUFBNUIsT0FBQTBCLEtBSUF0QyxPQUFBMUMsVUFBQThELFFBQUEsS0FBQU0iLCJmaWxlIjoiY29id2ViLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcclxuXHJcbigoZnVuY3Rpb24oKXtcclxuICAgIHNhZmVPdmVycmlkZShBcnJheS5wcm90b3R5cGUsICd1bmlxdWUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgYSA9IHRoaXMuY29uY2F0KCk7XHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGEubGVuZ3RoOyArK2kpIHtcclxuICAgICAgICAgICAgZm9yKHZhciBqID0gaSArIDE7IGogPCBhLmxlbmd0aDsgKytqKSB7XHJcbiAgICAgICAgICAgICAgICBpZihhW2ldID09PSBhW2pdKSBhLnNwbGljZShqLS0sIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc2FmZU92ZXJyaWRlKEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ2FkZENsYXNzJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgZm9yKHZhciBpIGluIGFyZ3VtZW50cyl7XHJcbiAgICAgICAgICAgIHZhciBvbGRDbGFzc05hbWVzID0gIXRoaXMuY2xhc3NOYW1lID8gW10gOiB0aGlzLmNsYXNzTmFtZS50cmltKCkucmVwbGFjZSgvXFxzKy9nLCAnICcpLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgIHZhciBuZXdDbGFzc05hbWVzID0gIWFyZ3VtZW50c1tpXSA/IFtdIDogYXJndW1lbnRzW2ldLnRyaW0oKS5yZXBsYWNlKC9cXHMrL2csICcgJykuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSBvbGRDbGFzc05hbWVzLmNvbmNhdChuZXdDbGFzc05hbWVzKS51bmlxdWUoKS5qb2luKCcgJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgc2FmZU92ZXJyaWRlKEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ2hlaWdodCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmhlaWdodDtcclxuICAgIH0pO1xyXG5cclxuICAgIHNhZmVPdmVycmlkZShIVE1MRWxlbWVudC5wcm90b3R5cGUsICd3aWR0aCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZnVuY3Rpb24gc2FmZU92ZXJyaWRlKHByb3RvdHlwZSwgcHJvcGVydHksIHZhbHVlKSB7XHJcbiAgICAgICAgaWYoIXByb3RvdHlwZVtwcm9wZXJ0eV0pIHByb3RvdHlwZVtwcm9wZXJ0eV0gPSB2YWx1ZTtcclxuICAgIH1cclxufSkoKSk7XHJcbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbigoZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgRXZlbnRIYW5kbGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSB7fTtcclxuICAgIH07XHJcblxyXG4gICAgRXZlbnRIYW5kbGVyLnByb3RvdHlwZS50cmlnZ2VyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIG5hbWUgPSBhcmd1bWVudHNbMF07XHJcbiAgICAgICAgdmFyIGxpc3RlbmVycyA9IHRoaXMubGlzdGVuZXJzW25hbWVdIHx8IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlzdGVuZXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5zcGxpY2UuY2FsbChhcmd1bWVudHMsIDAsIDEpO1xyXG4gICAgICAgICAgICBsaXN0ZW5lcnNbaV0uYXBwbHkobnVsbCwgYXJndW1lbnRzKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIEV2ZW50SGFuZGxlci5wcm90b3R5cGUub24gPSBmdW5jdGlvbihuYW1lLCBjYWxsYmFjaykge1xyXG4gICAgICAgIGlmICghdGhpcy5saXN0ZW5lcnNbbmFtZV0pIHRoaXMubGlzdGVuZXJzW25hbWVdID0gW107XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lcnNbbmFtZV0ucHVzaChjYWxsYmFjayk7XHJcbiAgICB9O1xyXG5cclxuICAgIEV2ZW50SGFuZGxlci5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLmxpc3RlbmVyc1tuYW1lXTtcclxuICAgIH07XHJcblxyXG4gICAgRXZlbnRIYW5kbGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbihuYW1lLCBjYWxsYmFjaykge1xyXG4gICAgICAgIGlmICh0aGlzLmxpc3RlbmVyc1tuYW1lXSkge1xyXG4gICAgICAgICAgICB2YXIgYXJyYXkgPSB0aGlzLmxpc3RlbmVyc1tuYW1lXTtcclxuICAgICAgICAgICAgaWYgKGFycmF5LmluZGV4T2YoY2FsbGJhY2spID4gLTEpIGFycmF5LnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB3aW5kb3cuRXZlbnRIYW5kbGVyID0gRXZlbnRIYW5kbGVyO1xyXG59KSgpKTtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuKGZ1bmN0aW9uKCl7XHJcbiAgICB2YXIgQ29id2ViID0gZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gICAgICAgIHRoaXMub3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgY29udGFpbmVyOiB7XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RvcjogJyNjb2J3ZWInLFxyXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lOiAnY2ItY29udGFpbmVyJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBtZW51OiB7XHJcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdjYi1tZW51J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBsb2dnZXI6IHtcclxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ2NiLWxvZ2dlcidcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgdHlwZW9mIG9wdGlvbnMgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIGV4dGVuZCh0aGlzLm9wdGlvbnMsIG9wdGlvbnMpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMub3B0aW9ucy5jb250YWluZXIuc2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFkZENsYXNzKHRoaXMub3B0aW9ucy5jb250YWluZXIuY2xhc3NOYW1lKTtcclxuXHJcbiAgICAgICAgdGhpcy5nbCA9IEdMLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGhlaWdodDogY29udGFpbmVyLmhlaWdodCgpLFxyXG4gICAgICAgICAgICB3aWR0aDogY29udGFpbmVyLndpZHRoKClcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kKHRoaXMuZ2wuY2FudmFzKTtcclxuXHJcbiAgICAgICAgdGhpcy5ldmVudHMgPSBuZXcgRXZlbnRIYW5kbGVyKCk7XHJcbiAgICAgICAgQ29id2ViLnByb3RvdHlwZS5lbmFibGVQbHVnaW5zKHRoaXMpO1xyXG5cclxuICAgICAgICB0aGlzLmV2ZW50cy5vbigncmVzaXplJywgZnVuY3Rpb24oaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UuZ2wuY2FudmFzLmhlaWdodCA9IGluc3RhbmNlLmNvbnRhaW5lci5oZWlnaHQoKTtcclxuICAgICAgICAgICAgaW5zdGFuY2UuZ2wuY2FudmFzLndpZHRoID0gaW5zdGFuY2UuY29udGFpbmVyLndpZHRoKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciBzY29wZSA9IHRoaXM7XHJcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIHNjb3BlLmV2ZW50cy50cmlnZ2VyKCdyZXNpemUnLCBzY29wZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG5cclxuICAgIENvYndlYi5wcm90b3R5cGUucGx1Z2lucyA9IHt9O1xyXG5cclxuICAgIENvYndlYi5wcm90b3R5cGUuZW5hYmxlUGx1Z2lucyA9IGZ1bmN0aW9uKGluc3RhbmNlKSB7XHJcbiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBDb2J3ZWIucHJvdG90eXBlLnBsdWdpbnMpXHJcbiAgICAgICAgICAgIGluc3RhbmNlW25hbWVdID0gbmV3IENvYndlYi5wcm90b3R5cGUucGx1Z2luc1tuYW1lXShpbnN0YW5jZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGZ1bmN0aW9uIGV4dGVuZChzb3VyY2UsIHByb3BlcnRpZXMpe1xyXG4gICAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIHByb3BlcnRpZXMpIHtcclxuICAgICAgICAgICAgaWYgKHByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkocHJvcGVydHkpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBwcm9wZXJ0aWVzW3Byb3BlcnR5XTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXh0ZW5kKHNvdXJjZVtwcm9wZXJ0eV0sIHByb3BlcnRpZXNbcHJvcGVydHldKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc291cmNlW3Byb3BlcnR5XSA9IHByb3BlcnRpZXNbcHJvcGVydHldO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHdpbmRvdy5Db2J3ZWIgPSBDb2J3ZWI7XHJcbn0oKSk7XHJcbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbigoZnVuY3Rpb24oKXtcclxuICAgIHZhciBMb2dnZXIgPSBmdW5jdGlvbihpbnN0YW5jZSkge1xyXG4gICAgICAgIHZhciBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdESVYnKTtcclxuICAgICAgICBjb250YWluZXIuYWRkQ2xhc3MoaW5zdGFuY2Uub3B0aW9ucy5sb2dnZXIuY2xhc3NOYW1lKTtcclxuICAgICAgICBpbnN0YW5jZS5jb250YWluZXIuYXBwZW5kKGNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgIHZhciBpbmZvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XHJcbiAgICAgICAgaW5mby5pbm5lckhUTUwgPSAnTG9yZW0gaXBzdW0uLi4nO1xyXG4gICAgICAgIGluZm8uYWRkQ2xhc3MoJ2luZm8nKTtcclxuICAgICAgICBjb250YWluZXIuYXBwZW5kKGluZm8pO1xyXG5cclxuICAgICAgICB0aGlzLmluZm8gPSBmdW5jdGlvbih0ZXh0KSB7XHJcbiAgICAgICAgICAgIGluZm8uaW5uZXJIVE1MID0gdGV4dDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGluc3RhbmNlLmV2ZW50cy5vbignbG9nZ2VyLmluZm8nLCB0aGlzLmluZm8pO1xyXG4gICAgfTtcclxuXHJcbiAgICBDb2J3ZWIucHJvdG90eXBlLnBsdWdpbnNbJ2xvZ2dlciddID0gTG9nZ2VyO1xyXG59KSgpKTtcclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuKChmdW5jdGlvbigpe1xyXG4gICAgdmFyIE1lbnUgPSBmdW5jdGlvbihpbnN0YW5jZSkge1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2xhc3MoaW5zdGFuY2Uub3B0aW9ucy5tZW51LmNsYXNzTmFtZSk7XHJcbiAgICAgICAgaW5zdGFuY2UuY29udGFpbmVyLmFwcGVuZCh0aGlzLmNvbnRhaW5lcik7XHJcblxyXG4gICAgICAgIHZhciBtZW51ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnVUwnKTtcclxuICAgICAgICBtZW51LmFkZENsYXNzKCdtYWluLW1lbnUnKTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmQobWVudSk7XHJcblxyXG4gICAgICAgIHRoaXMuaXRlbXMgPSB7XHJcbiAgICAgICAgICAgICdGaWxlJzogW1xyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICdMb2FkLi4uJzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpdGVtIGNsaWNrIScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgJ0FsZXJ0ISc6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuZXZlbnRzLnRyaWdnZXIoJ2xvZ2dlci5pbmZvJywgJ0xPT0sgQVQgTUUhIE9fTycpO1xyXG4gICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5ldmVudHMudHJpZ2dlcignbG9nZ2VyLmluZm8nLCAnU1RBUEghJyk7XHJcbiAgICAgICAgICAgICAgICB9LCAyMDAwKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ0hlbHAnOiBbXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgJ0Fib3V0IFdlYk1lc2gnOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Fib3V0IHdoYXQ/IScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIE1lbnUucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGZvcih2YXIgaXRlbSBpbiB0aGlzLml0ZW1zKXtcclxuICAgICAgICAgICAgdmFyIGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnTEknKTtcclxuICAgICAgICAgICAgbGkuaW5uZXJIVE1MID0gaXRlbTtcclxuICAgICAgICAgICAgbGkuYWRkQ2xhc3MoaXRlbSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLml0ZW1zW2l0ZW1dO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICBsaS5vbmNsaWNrID0gdmFsdWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBtYWluTWVudSA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5tYWluLW1lbnUnKTtcclxuICAgICAgICAgICAgbWFpbk1lbnUuYXBwZW5kKGxpKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIENvYndlYi5wcm90b3R5cGUucGx1Z2luc1snbWVudSddID0gTWVudTtcclxufSkoKSk7XHJcbiJdfQ==
