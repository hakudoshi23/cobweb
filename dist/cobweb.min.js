!function(){"use strict";function e(e,t,n){e[t]||(e[t]=n)}e(Array.prototype,"unique",function(){for(var e=this.concat(),t=0;t<e.length;++t)for(var n=t+1;n<e.length;++n)e[t]===e[n]&&e.splice(n--,1);return e}),e(Array.prototype,"forEach",function(e){for(var t=0;t<this.length;t++)e(this[t],t,this)})}(),function(){"use strict";function e(e,t,n){e[t]||(e[t]=n)}function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}e(HTMLElement.prototype,"addClass",function(){var e,t;for(var n in arguments)e=this.className?this.className.trim().replace(/\s+/g," ").split(" "):[],t=arguments[n]?arguments[n].trim().replace(/\s+/g," ").split(" "):[],this.className=e.concat(t).unique().join(" ")}),e(HTMLElement.prototype,"hasClass",function(){var e,t=this.className?this.className.trim().replace(/\s+/g," ").split(" "):[];for(var n in arguments){e=arguments[n]?arguments[n].trim().replace(/\s+/g," ").split(" "):[];for(var r=0;r<e.length;r++){var i=e[r];if(t.indexOf(i)==-1)return!1}}return!0}),e(HTMLElement.prototype,"removeClass",function(){var e,t,n=0,r=function(t){n=e.indexOf(t),n!=-1&&e.splice(n,1)};for(var i in arguments)e=this.className?this.className.trim().replace(/\s+/g," ").split(" "):[],t=arguments[i]?arguments[i].trim().replace(/\s+/g," ").split(" "):[],t.forEach(r),this.className=e.unique().join(" ")}),e(HTMLElement.prototype,"data",function(e,t){window.__data_cache||(window.__data_cache=new WeakMap);var n=window.__data_cache.get(this)||{};return void 0===t?e?n&&n[e]:n:(n[e]=t,window.__data_cache.set(this,n),this)}),e(HTMLElement.prototype,"setData",function(e){return window.__data_cache||(window.__data_cache=new WeakMap),window.__data_cache.set(this,e),this}),e(HTMLElement.prototype,"attr",function(e,t){if(void 0!==t)this.setAttribute(e,t);else{if(null!==t)return this.getAttribute(e);this.removeAttribute(e)}return this}),e(HTMLElement.prototype,"attrData",function(e,t){return this.attr("data-"+e,t)}),e(Element.prototype,"matches",Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1}),e(HTMLElement.prototype,"parent",function(e){if(!e)return this.parentElement;for(var t=this.parentElement;!t.matches(e);)t=t.parentElement;return t}),e(HTMLElement.prototype,"height",function(){if(1!=arguments.length)return this.clientHeight;var e=arguments[0];"number"==typeof e?this.style.height=e+"px":this.style.height=e}),e(HTMLElement.prototype,"width",function(){if(1!=arguments.length)return this.clientWidth;var e=arguments[0];"number"==typeof e?this.style.width=e+"px":this.style.width=e}),e(window,"guid",function(){return"GUID-"+t()+"-"+t()+"-"+t()}),e(HTMLElement.prototype,"guid",function(){var e=null,t=null;do e=window.guid(),t=document.querySelector("#"+e);while(t);return this.attr("id",e),e})}(),function(){"use strict";function e(e,t,n){e[t]||(e[t]=n)}window.extend=function(e,t){for(var n in t)if(n&&t.hasOwnProperty(n)){var r=t[n];"object"==typeof r?extend(e[n],t[n]):e[n]=t[n]}},e(Object,"clone",function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];"object"==typeof r?t[n]=Object.clone(e[n]):t[n]=e[n]}return t})}(),function(){"use strict";var e=function(e,t){this.data=t||{},this.parent=e,this.children=[]};window.TreeNode=e,e.prototype.isRoot=function(){return!this.parent},e.prototype.add=function(e){var t=new this.constructor(this,e);return this.children.push(t),t},e.prototype.remove=function(e){return this.children.slice(e,1),this},e.prototype.dfs=function(e){for(var t=[],n=0;n<this.children.length;n++)(!e||e&&e(this.children[n]))&&t.push(this.children[n]),t.concat(this.children[n].dfs(e));return t},e.prototype.bfs=function(e){var t,n=[];for(t=0;t<this.children.length;t++)(!e||e&&e(this.children[t]))&&n.push(this.children[t]);for(t=0;t<this.children.length;t++)n.concat(this.children[t].bfs(e));return n},e.extend=function(t){var n=function(t,n){e.call(this,t,n)};return n.prototype=Object.create(e.prototype),n.prototype.constructor=n,extend(n.prototype,t),new n(null)}}(),function(){"use strict";var e=function(e){this.instance=e,this.listeners={}};e.prototype.trigger=function(){var e=arguments[0],t=this.listeners[e]||[];Array.prototype.splice.call(arguments,0,1);for(var n=0;n<t.length;n++)t[n].apply(null,arguments);this.instance.logger.debug(e,arguments)},e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e){delete this.listeners[e]},e.prototype.off=function(e,t){if(this.listeners[e]){var n=this.listeners[e];n.indexOf(t)>-1&&n.splice(index,1)}},window.EventHandler=e}(),function(){"use strict";var e=function(){},t=function(t,n){this.debug=n?console.debug.bind():e,this.info=n?console.info.bind():e,this.warn=console.warn.bind(),this.error=console.error.bind()};window.Logger=t}(),function(){"use strict";var e={container:{selector:"#cobweb",className:"cb-container"}},t=function(n){if(this.options=e,extend(this.options,n||{}),this.container=document.querySelector(this.options.container.selector),!this.container)throw new Error("Invalid container selector: '"+this.options.container.selector+"'");this.container.addClass(this.options.container.className),this.container.data("instance",this),this.logger=new Logger(this,!0),this.events=new EventHandler(this),t.prototype.modules.load(this)};window.Cobweb=t}(),function(){"use strict";function e(e){for(var t in e){var n=e[t];if(n.dependant||(n.dependant=[]),n.dependencies.length>0)for(var r=0;r<n.dependencies.length;r++){var i=e[n.dependencies[r]];i.dependant||(i.dependant=[]),i.dependant.push(t)}}}function t(e,t){var r=[],i=[];for(var o in t)0===t[o].dependencies.length&&r.push(o);for(;r.length>0;){var a=r[0];if(r.splice(0,1),t[a]){var s=t[a];i.push(a);for(var c=0;c<s.dependant.length;c++){var l=s.dependant[c];n(i,t[l])&&r.push(l)}}else e.events.trigger("modules.error.missing",a),e.logger.warning("Missing module '"+a+"'")}return Object.keys(t).length!==i.length&&(e.events.trigger("modules.error.cycle"),e.logger.error("Dependency cycle found in modules")),i}function n(e,t){for(var n=0;n<t.dependencies.length;n++)if(e.indexOf(t.dependencies[n])===-1)return!1;return!0}Cobweb.prototype.modules={all:{},add:function(e,t,n){n=n||[],this.all[e]={dependencies:n,init:t}},load:function(n){this.instance=n,e(this.all);for(var r=t(n,this.all),i=0;i<r.length;i++){var o=r[i];try{this.all[o].init(n),n.events.trigger("modules.loaded",o)}catch(e){n.logger.error("Loading module "+o,e),n.events.trigger("modules.error",o,e)}}n.events.trigger("modules.loaded.all",r)},print:function(e){if(e)for(var t in this.all){var n=this.all[t];e.logger.debug("Name: ",t),e.logger.debug("\tDependencies: ",n.dependencies),e.logger.debug("\tDependant: ",n.dependant)}else console.error('Error: "load" should be called before "print"')}}}(),function(){"use strict";Cobweb.prototype.modules.add("pane-types",function(e){var t={all:{},add:function(e,t){this.all[e]=t},get:function(e){return this.all[e]},remove:function(e){delete this.all[e]},has:function(e){return!!this.all[e]}};t.add("default",function(e,t){t.logger.debug("Default pane type (this does nothing)")}),e.events.on("pane.split",function(t,n){var r=t.attrData("pane-type");r&&e.pane.setType(n,r)}),e.pane.types=t,e.pane.setType=function(t,n){this.types.has(n)&&(this.types.get(n)(t,e),t.attrData("pane-type",n))}},["pane"])}(),function(){"use strict";Cobweb.prototype.modules.add("pane",function(e){function t(t,n){e.events.trigger("pane.split",t,n)}function n(t){e.events.trigger("pane.resize",t)}e.pane=new Pane({container:e.options.container.selector,separator:{size:3},callbacks:{onPaneSplit:t,onPaneResize:n}})})}(),function(){"use strict";function e(e){var t=e.querySelector("canvas"),n=t.getContext("2d"),r=e.width(),i=e.height();e.data("buffer",new Uint8Array(r*i*4)),e.data("imgData",n.createImageData(r,i)),t.height=i,t.width=r;var o=e.data("surface");mat4.perspective(o.proj,-45*DEG2RAD,r/i,.1,1e3)}Cobweb.prototype.modules.add("surface",function(t){t.pane.types.add("surface",function(t,n){var r=document.createElement("canvas");t.append(r);var i={proj:mat4.create(),view:mat4.create()};mat4.perspective(i.proj,-45*DEG2RAD,r.width/r.height,.1,1e3),mat4.lookAt(i.view,[0,2,4],[0,0,0],[0,1,0]),mat4.scale(i.view,i.view,[1,1.2,1]),t.data("surface",i),e(t)}),t.events.on("pane.resize",function(t){"surface"===t.attrData("pane-type")&&e(t)});var n=document.querySelector(".pane");t.pane.setType(n,"surface"),t.pane.setRender(n,"solid")},["pane-types","surface-render"])}(),function(){"use strict";Cobweb.prototype.modules.add("object-interaction",function(e){e.interaction.add("object",{onMouseDown:function(t){e.logger.debug("onMouseDown",t)},onMouseUp:function(t){e.logger.debug("onMouseUp",t)},onMouseMove:function(t){e.logger.debug("onMouseMove",t)}})},["surface-render"])}(),function(){"use strict";Cobweb.prototype.modules.add("surface-interaction",function(e){e.pane.setInteraction=function(t,n){var r=e.interaction;r.has(n)&&t.attrData("surface-interaction",n)},e.pane.getInteraction=function(t){var n=e.interaction,r=t.attrData("surface-interaction");return n.get(r)},e.events.on("pane.split",function(e,t){t.attrData("surface-interaction",e.attrData("surface-interaction"))})},["interaction-mode"])}(),function(){"use strict";Cobweb.prototype.modules.add("render-solid",function(e){var t=new Shader("precision highp float;attribute vec3 a_vertex;attribute vec3 a_normal;varying vec3 v_normal;uniform mat4 u_mvp;uniform mat4 u_model;void main() {    v_normal = (u_model * vec4(a_normal,0.0)).xyz;    gl_Position = u_mvp * vec4(a_vertex,1.0);}","precision highp float;varying vec3 v_normal;uniform vec3 u_lightvector;uniform vec4 u_color;void main() {  vec3 N = normalize(v_normal);  gl_FragColor = u_color * max(0.0, dot(u_lightvector,N));}"),n=mat4.create(),r=mat4.create(),i={u_color:[1,1,1,1],u_lightvector:vec3.normalize(vec3.create(),[1,2,3]),u_model:null,u_mvp:r};e.graphics.renders.add("solid",function(o){for(var a=e.scene.root.dfs(),s=0;s<a.length;s++){var c=a[s].data;mat4.multiply(n,o.view,c.model),mat4.multiply(r,o.proj,n),i.u_model=c.model,t.uniforms(i).draw(c.mesh,c.primitive)}})},["graphics-render"])}(),function(){"use strict";Cobweb.prototype.modules.add("surface-render",function(e){e.pane.setRender=function(t,n){var r=e.graphics.renders;r.has(n)&&t.attrData("surface-render",n)},e.pane.getRender=function(t){var n=e.graphics.renders,r=t.attrData("surface-render");return n.get(r)},e.events.on("pane.split",function(e,t){t.attrData("surface-render",e.attrData("surface-render"))})},["graphics-render"])}(),function(){"use strict";Cobweb.prototype.modules.add("graphics-render",function(e){e.graphics.renders={all:{},add:function(e,t){this.all[e]=t},get:function(e){return this.all[e]},remove:function(e){delete this.all[e]},has:function(e){return!!this.all[e]}}},["graphics"])}(),function(){"use strict";function e(e,t){var n=t.parent(".pane"),r=n.data("imgData"),i=n.data("surface"),o=n.data("buffer"),a=e.graphics.gl,s=t.clientWidth,c=t.clientHeight;a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.viewport(0,0,s,c);var l=e.pane.getRender(n);l&&l(i);var u=t.getContext("2d");u&&(a.readPixels(0,0,s,c,a.RGBA,a.UNSIGNED_BYTE,o),r.data.set(o),u.putImageData(r,0,0))}var t=function(t){this.instance=t,this.gl=GL.create({height:screen.height,width:screen.width}),this.gl.animate(),this.gl.ondraw=function(){for(var n=document.querySelectorAll("canvas"),r=0;r<n.length;r++)e(t,n[r])},this.gl.clearColor(.4,.4,.4,1),this.gl.enable(this.gl.DEPTH_TEST)};Cobweb.prototype.modules.add("graphics",function(e){e.graphics=new t(e)})}(),function(){"use strict";Cobweb.prototype.modules.add("interaction-mode",function(e){var t={all:{},add:function(e,t){this.all[e]=t},get:function(e){return this.all[e]},remove:function(e){delete this.all[e]},has:function(e){return!!this.all[e]}};e.interaction=t})}(),function(){"use strict";Cobweb.prototype.modules.add("scene",function(e){e.scene={root:TreeNode.extend({})};var t=mat4.create();mat4.rotateY(t,t,.8),e.scene.root.add({type:"object",primitive:e.graphics.gl.TRIANGLES,mesh:GL.Mesh.cube(),model:t})},["graphics"])}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFycmF5LmpzIiwiaHRtbC5qcyIsIm9iai5qcyIsInRyZWUuanMiLCJldmVudHMuanMiLCJsb2dnZXIuanMiLCJjb2J3ZWIuanMiLCJtb2R1bGVzLmpzIiwicGFuZS9wYW5lLXR5cGVzLmpzIiwicGFuZS9wYW5lcy5qcyIsInBhbmUvc3VyZmFjZS9zdXJmYWNlLmpzIiwicGFuZS9zdXJmYWNlL2ludGVyYWN0aW9uL29iamVjdC1pbnRlcmFjdGlvbi5qcyIsInBhbmUvc3VyZmFjZS9pbnRlcmFjdGlvbi9zdXJmYWNlLWludGVyYWN0aW9uLmpzIiwicGFuZS9zdXJmYWNlL3JlbmRlci9yZW5kZXItc29saWQuanMiLCJwYW5lL3N1cmZhY2UvcmVuZGVyL3N1cmZhY2UtcmVuZGVyLmpzIiwiZ3JhcGhpYy1yZW5kZXIuanMiLCJncmFwaGljLmpzIiwiaW50ZXJhY3Rpb24tbW9kZXMuanMiLCJzY2VuZS5qcyJdLCJuYW1lcyI6WyJzYWZlRXh0ZW5kIiwicHJvdG90eXBlIiwicHJvcGVydHkiLCJ2YWx1ZSIsIkFycmF5IiwiYSIsInRoaXMiLCJjb25jYXQiLCJpIiwibGVuZ3RoIiwiaiIsInNwbGljZSIsImNhbGxiYWNrIiwiczQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0cmluZyIsIkhUTUxFbGVtZW50Iiwib2xkQ2xhc3NOYW1lcyIsIm5ld0NsYXNzTmFtZXMiLCJhcmd1bWVudHMiLCJjbGFzc05hbWUiLCJ0cmltIiwicmVwbGFjZSIsInNwbGl0IiwidW5pcXVlIiwiam9pbiIsInF1ZXJ5Q2xhc3NOYW1lcyIsImN1cnJlbnRDbGFzc05hbWVzIiwiaW5kZXgiLCJuYW1lIiwiaW5kZXhPZiIsInJlbW92ZUNsYXNzTmFtZXMiLCJyZW1vdmVFYWNoIiwiZm9yRWFjaCIsImF0dHIiLCJ3aW5kb3ciLCJfX2RhdGFfY2FjaGUiLCJXZWFrTWFwIiwiZWxBdHRycyIsImdldCIsInVuZGVmaW5lZCIsInNldCIsImRhdGEiLCJzZXRBdHRyaWJ1dGUiLCJnZXRBdHRyaWJ1dGUiLCJyZW1vdmVBdHRyaWJ1dGUiLCJFbGVtZW50IiwibWF0Y2hlc1NlbGVjdG9yIiwibW96TWF0Y2hlc1NlbGVjdG9yIiwibXNNYXRjaGVzU2VsZWN0b3IiLCJvTWF0Y2hlc1NlbGVjdG9yIiwid2Via2l0TWF0Y2hlc1NlbGVjdG9yIiwicyIsIm1hdGNoZXMiLCJkb2N1bWVudCIsIm93bmVyRG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiaXRlbSIsInF1ZXJ5IiwicGFyZW50RWxlbWVudCIsImN1cnJlbnQiLCJjbGllbnRIZWlnaHQiLCJzdHlsZSIsImhlaWdodCIsImNsaWVudFdpZHRoIiwid2lkdGgiLCJndWlkIiwib3ZlcmxhcCIsInF1ZXJ5U2VsZWN0b3IiLCJleHRlbmQiLCJkZWZhdWx0cyIsInByb3BlcnRpZXMiLCJoYXNPd25Qcm9wZXJ0eSIsIk9iamVjdCIsIm9iaiIsIm5ld09iaiIsImNsb25lIiwiVHJlZU5vZGUiLCJwYXJlbnQiLCJjaGlsZHJlbiIsImlzUm9vdCIsImFkZCIsImNoaWxkIiwiY29uc3RydWN0b3IiLCJwdXNoIiwicmVtb3ZlIiwic2xpY2UiLCJkZnMiLCJjaGVjayIsIm91dCIsImJmcyIsIl9UcmVlTm9kZSIsImNhbGwiLCJjcmVhdGUiLCJFdmVudEhhbmRsZXIiLCJpbnN0YW5jZSIsImxpc3RlbmVycyIsInRyaWdnZXIiLCJhcHBseSIsImxvZ2dlciIsImRlYnVnIiwib24iLCJvZmYiLCJhcnJheSIsImVtcHR5RnVuY3Rpb24iLCJMb2dnZXIiLCJpc0RlYnVnIiwiY29uc29sZSIsImJpbmQiLCJpbmZvIiwid2FybiIsImVycm9yIiwiZGVmYXVsdE9wdGlvbnMiLCJjb250YWluZXIiLCJzZWxlY3RvciIsIkNvYndlYiIsIm9wdGlvbnMiLCJFcnJvciIsImFkZENsYXNzIiwiZXZlbnRzIiwibW9kdWxlcyIsImxvYWQiLCJhZGRSZXZlcnNlRGVwZW5kZW5jaWVzIiwibW9kdWxlIiwiZGVwZW5kYW50IiwiZGVwZW5kZW5jaWVzIiwiZGVwUGx1Z2luIiwidG9wb2xvZ2ljYWxTb3J0IiwiY2FuZGlkYXRlcyIsInNvcnRlZE5hbWVzIiwibmV4dE5hbWUiLCJkZXBOYW1lIiwiYWxsRGVwZW5kZW5jaWVzTWV0Iiwid2FybmluZyIsImtleXMiLCJsb2FkZWRVbnRpbE5vdyIsImFsbCIsImluaXQiLCJleCIsInByaW50IiwicGFuZVR5cGVzIiwiaGFzIiwicGFuZSIsIm9sZFBhbmUiLCJuZXdQYW5lIiwib2xkVHlwZSIsImF0dHJEYXRhIiwic2V0VHlwZSIsInR5cGVzIiwib25QYW5lU3BsaXQiLCJvcmlnaW4iLCJvblBhbmVSZXNpemUiLCJQYW5lIiwic2VwYXJhdG9yIiwic2l6ZSIsImNhbGxiYWNrcyIsInVwZGF0ZUNhbnZhc1NpemUiLCJjYW52YXMiLCJjb250ZXh0IiwiZ2V0Q29udGV4dCIsIlVpbnQ4QXJyYXkiLCJjcmVhdGVJbWFnZURhdGEiLCJtYXQ0IiwicGVyc3BlY3RpdmUiLCJwcm9qIiwiREVHMlJBRCIsImNyZWF0ZUVsZW1lbnQiLCJhcHBlbmQiLCJ2aWV3IiwibG9va0F0Iiwic2NhbGUiLCJyb290Iiwic2V0UmVuZGVyIiwiaW50ZXJhY3Rpb24iLCJvbk1vdXNlRG93biIsImV2ZW50Iiwib25Nb3VzZVVwIiwib25Nb3VzZU1vdmUiLCJzZXRJbnRlcmFjdGlvbiIsImludGVyYWN0aW9ucyIsImdldEludGVyYWN0aW9uIiwic2hhZGVyIiwiU2hhZGVyIiwidGVtcCIsIm12cCIsInVuaWZvcm1zIiwidV9jb2xvciIsInVfbGlnaHR2ZWN0b3IiLCJ2ZWMzIiwibm9ybWFsaXplIiwidV9tb2RlbCIsInVfbXZwIiwiZ3JhcGhpY3MiLCJyZW5kZXJzIiwic3VyZmFjZSIsIm9ianMiLCJzY2VuZSIsIm11bHRpcGx5IiwibW9kZWwiLCJkcmF3IiwibWVzaCIsInByaW1pdGl2ZSIsImdldFJlbmRlciIsImRyYXdSZW5kZXJUYXJnZXQiLCJpbWFnZURhdGEiLCJidWZmZXIiLCJnbCIsImNsZWFyIiwiQ09MT1JfQlVGRkVSX0JJVCIsIkRFUFRIX0JVRkZFUl9CSVQiLCJ2aWV3cG9ydCIsInJlbmRlciIsInJlYWRQaXhlbHMiLCJSR0JBIiwiVU5TSUdORURfQllURSIsInB1dEltYWdlRGF0YSIsIkdyYXBoaWNzIiwiR0wiLCJzY3JlZW4iLCJhbmltYXRlIiwib25kcmF3IiwicmVuZGVyVGFyZ2V0cyIsImNsZWFyQ29sb3IiLCJlbmFibGUiLCJERVBUSF9URVNUIiwiaW50ZXJhY3Rpb25Nb2RlcyIsIm1hdCIsInJvdGF0ZVkiLCJ0eXBlIiwiVFJJQU5HTEVTIiwiTWVzaCIsImN1YmUiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0EsWUFlQSxTQUFBQSxHQUFBQyxFQUFBQyxFQUFBQyxHQUNBRixFQUFBQyxLQUFBRCxFQUFBQyxHQUFBQyxHQWRBSCxFQUFBSSxNQUFBSCxVQUFBLFNBQUEsV0FFQSxJQUFBLEdBREFJLEdBQUFDLEtBQUFDLFNBQ0FDLEVBQUEsRUFBQUEsRUFBQUgsRUFBQUksU0FBQUQsRUFDQSxJQUFBLEdBQUFFLEdBQUFGLEVBQUEsRUFBQUUsRUFBQUwsRUFBQUksU0FBQUMsRUFDQUwsRUFBQUcsS0FBQUgsRUFBQUssSUFBQUwsRUFBQU0sT0FBQUQsSUFBQSxFQUNBLE9BQUFMLEtBR0FMLEVBQUFJLE1BQUFILFVBQUEsVUFBQSxTQUFBVyxHQUNBLElBQUEsR0FBQUosR0FBQSxFQUFBQSxFQUFBRixLQUFBRyxPQUFBRCxJQUNBSSxFQUFBTixLQUFBRSxHQUFBQSxFQUFBRixXQ2JBLFdBQ0EsWUFrSUEsU0FBQU4sR0FBQUMsRUFBQUMsRUFBQUMsR0FDQUYsRUFBQUMsS0FBQUQsRUFBQUMsR0FBQUMsR0FHQSxRQUFBVSxLQUNBLE1BQUFDLE1BQUFDLE1BQUEsT0FBQSxFQUFBRCxLQUFBRSxXQUNBQyxTQUFBLElBQUFDLFVBQUEsR0F0SUFsQixFQUFBbUIsWUFBQWxCLFVBQUEsV0FBQSxXQUNBLEdBQUFtQixHQUFBQyxDQUNBLEtBQUEsR0FBQWIsS0FBQWMsV0FDQUYsRUFBQWQsS0FBQWlCLFVBQUFqQixLQUFBaUIsVUFBQUMsT0FBQUMsUUFB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QUNBLFFBQUExQixLQUFBcUksSUFBQTNHLElBSUFrRSxHQUFBOEUsWUFBQW9ELE9DcEJBLFdBQ0EsWUFFQTlHLFFBQUFySCxVQUFBMEgsUUFBQXZDLElBQUEsUUFBQSxTQUFBYyxHQUNBQSxFQUFBcUcsT0FDQXpCLEtBQUE5RixTQUFBUixXQUdBLElBQUE2SixHQUFBaEUsS0FBQXJFLFFBQ0FxRSxNQUFBaUUsUUFBQUQsRUFBQUEsRUFBQSxJQUVBbkksRUFBQXFHLE1BQUF6QixLQUFBMUYsS0FDQW1KLEtBQUEsU0FDQTNCLFVBQUExRyxFQUFBaUcsU0FBQWMsR0FBQXVCLFVBQ0E3QixLQUFBaUIsR0FBQWEsS0FBQUMsT0FDQWpDLE1BQUE0QixNQUVBIiwiZmlsZSI6ImNvYndlYi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoKGZ1bmN0aW9uKCl7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgc2FmZUV4dGVuZChBcnJheS5wcm90b3R5cGUsICd1bmlxdWUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgYSA9IHRoaXMuY29uY2F0KCk7XHJcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGEubGVuZ3RoOyArK2kpXHJcbiAgICAgICAgICAgIGZvcih2YXIgaiA9IGkgKyAxOyBqIDwgYS5sZW5ndGg7ICsrailcclxuICAgICAgICAgICAgICAgIGlmKGFbaV0gPT09IGFbal0pIGEuc3BsaWNlKGotLSwgMSk7XHJcbiAgICAgICAgcmV0dXJuIGE7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzYWZlRXh0ZW5kKEFycmF5LnByb3RvdHlwZSwgJ2ZvckVhY2gnLCBmdW5jdGlvbihjYWxsYmFjaykge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgY2FsbGJhY2sodGhpc1tpXSwgaSwgdGhpcyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBzYWZlRXh0ZW5kKHByb3RvdHlwZSwgcHJvcGVydHksIHZhbHVlKSB7XHJcbiAgICAgICAgaWYoIXByb3RvdHlwZVtwcm9wZXJ0eV0pIHByb3RvdHlwZVtwcm9wZXJ0eV0gPSB2YWx1ZTtcclxuICAgIH1cclxufSkoKSk7XHJcbiIsIigoZnVuY3Rpb24oKXtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBzYWZlRXh0ZW5kKEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ2FkZENsYXNzJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBvbGRDbGFzc05hbWVzLCBuZXdDbGFzc05hbWVzO1xyXG4gICAgICAgIGZvcih2YXIgaSBpbiBhcmd1bWVudHMpe1xyXG4gICAgICAgICAgICBvbGRDbGFzc05hbWVzID0gIXRoaXMuY2xhc3NOYW1lID8gW10gOiB0aGlzLmNsYXNzTmFtZS50cmltKCkucmVwbGFjZSgvXFxzKy9nLCAnICcpLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgIG5ld0NsYXNzTmFtZXMgPSAhYXJndW1lbnRzW2ldID8gW10gOiBhcmd1bWVudHNbaV0udHJpbSgpLnJlcGxhY2UoL1xccysvZywgJyAnKS5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICB0aGlzLmNsYXNzTmFtZSA9IG9sZENsYXNzTmFtZXMuY29uY2F0KG5ld0NsYXNzTmFtZXMpLnVuaXF1ZSgpLmpvaW4oJyAnKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBzYWZlRXh0ZW5kKEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ2hhc0NsYXNzJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBxdWVyeUNsYXNzTmFtZXMsIGN1cnJlbnRDbGFzc05hbWVzID0gIXRoaXMuY2xhc3NOYW1lID8gW10gOiB0aGlzLmNsYXNzTmFtZS50cmltKCkucmVwbGFjZSgvXFxzKy9nLCAnICcpLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgZm9yKHZhciBpIGluIGFyZ3VtZW50cyl7XHJcbiAgICAgICAgICAgIHF1ZXJ5Q2xhc3NOYW1lcyA9ICFhcmd1bWVudHNbaV0gPyBbXSA6IGFyZ3VtZW50c1tpXS50cmltKCkucmVwbGFjZSgvXFxzKy9nLCAnICcpLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBxdWVyeUNsYXNzTmFtZXMubGVuZ3RoOyBpbmRleCsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IHF1ZXJ5Q2xhc3NOYW1lc1tpbmRleF07XHJcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENsYXNzTmFtZXMuaW5kZXhPZihuYW1lKSA9PSAtMSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzYWZlRXh0ZW5kKEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ3JlbW92ZUNsYXNzJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBpbmRleCA9IDAsIGN1cnJlbnRDbGFzc05hbWVzLCByZW1vdmVDbGFzc05hbWVzO1xyXG4gICAgICAgIHZhciByZW1vdmVFYWNoID0gZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICAgICAgaW5kZXggPSBjdXJyZW50Q2xhc3NOYW1lcy5pbmRleE9mKG5hbWUpO1xyXG4gICAgICAgICAgICBpZiAoaW5kZXggIT0gLTEpXHJcbiAgICAgICAgICAgICAgICBjdXJyZW50Q2xhc3NOYW1lcy5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgZm9yKHZhciBpIGluIGFyZ3VtZW50cyl7XHJcbiAgICAgICAgICAgIGN1cnJlbnRDbGFzc05hbWVzID0gIXRoaXMuY2xhc3NOYW1lID8gW10gOiB0aGlzLmNsYXNzTmFtZS50cmltKCkucmVwbGFjZSgvXFxzKy9nLCAnICcpLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgIHJlbW92ZUNsYXNzTmFtZXMgPSAhYXJndW1lbnRzW2ldID8gW10gOiBhcmd1bWVudHNbaV0udHJpbSgpLnJlcGxhY2UoL1xccysvZywgJyAnKS5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICByZW1vdmVDbGFzc05hbWVzLmZvckVhY2gocmVtb3ZlRWFjaCk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xhc3NOYW1lID0gY3VycmVudENsYXNzTmFtZXMudW5pcXVlKCkuam9pbignICcpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHNhZmVFeHRlbmQoSFRNTEVsZW1lbnQucHJvdG90eXBlLCAnZGF0YScsIGZ1bmN0aW9uIChhdHRyLCB2YWx1ZSkge1xyXG4gICAgICAgIGlmICghd2luZG93Ll9fZGF0YV9jYWNoZSkgd2luZG93Ll9fZGF0YV9jYWNoZSA9IG5ldyBXZWFrTWFwKCk7XHJcbiAgICAgICAgdmFyIGVsQXR0cnMgPSB3aW5kb3cuX19kYXRhX2NhY2hlLmdldCh0aGlzKSB8fCB7fTtcclxuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBlbEF0dHJzW2F0dHJdID0gdmFsdWU7XHJcbiAgICAgICAgICAgIHdpbmRvdy5fX2RhdGFfY2FjaGUuc2V0KHRoaXMsIGVsQXR0cnMpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGlmIChhdHRyKSByZXR1cm4gZWxBdHRycyAmJiBlbEF0dHJzW2F0dHJdO1xyXG4gICAgICAgICAgICBlbHNlIHJldHVybiBlbEF0dHJzO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0pO1xyXG5cclxuICAgIHNhZmVFeHRlbmQoSFRNTEVsZW1lbnQucHJvdG90eXBlLCAnc2V0RGF0YScsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgaWYgKCF3aW5kb3cuX19kYXRhX2NhY2hlKSB3aW5kb3cuX19kYXRhX2NhY2hlID0gbmV3IFdlYWtNYXAoKTtcclxuICAgICAgICB3aW5kb3cuX19kYXRhX2NhY2hlLnNldCh0aGlzLCBkYXRhKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH0pO1xyXG5cclxuICAgIHNhZmVFeHRlbmQoSFRNTEVsZW1lbnQucHJvdG90eXBlLCAnYXR0cicsIGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xyXG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZShuYW1lLCB2YWx1ZSk7XHJcbiAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IG51bGwpXHJcbiAgICAgICAgICAgIHRoaXMucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKG5hbWUpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfSk7XHJcblxyXG4gICAgc2FmZUV4dGVuZChIVE1MRWxlbWVudC5wcm90b3R5cGUsICdhdHRyRGF0YScsIGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmF0dHIoJ2RhdGEtJyArIG5hbWUsIHZhbHVlKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHNhZmVFeHRlbmQoRWxlbWVudC5wcm90b3R5cGUsICdtYXRjaGVzJyxcclxuICAgICAgICBFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzU2VsZWN0b3IgfHxcclxuICAgICAgICBFbGVtZW50LnByb3RvdHlwZS5tb3pNYXRjaGVzU2VsZWN0b3IgfHxcclxuICAgICAgICBFbGVtZW50LnByb3RvdHlwZS5tc01hdGNoZXNTZWxlY3RvciB8fFxyXG4gICAgICAgIEVsZW1lbnQucHJvdG90eXBlLm9NYXRjaGVzU2VsZWN0b3IgfHxcclxuICAgICAgICBFbGVtZW50LnByb3RvdHlwZS53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHxcclxuICAgICAgICBmdW5jdGlvbihzKSB7XHJcbiAgICAgICAgICAgIHZhciBtYXRjaGVzID0gKHRoaXMuZG9jdW1lbnQgfHwgdGhpcy5vd25lckRvY3VtZW50KS5xdWVyeVNlbGVjdG9yQWxsKHMpLFxyXG4gICAgICAgICAgICAgICAgaSA9IG1hdGNoZXMubGVuZ3RoO1xyXG4gICAgICAgICAgICB3aGlsZSAoLS1pID49IDAgJiYgbWF0Y2hlcy5pdGVtKGkpICE9PSB0aGlzKSB7fVxyXG4gICAgICAgICAgICByZXR1cm4gaSA+IC0xO1xyXG4gICAgICAgIH1cclxuICAgICk7XHJcblxyXG4gICAgc2FmZUV4dGVuZChIVE1MRWxlbWVudC5wcm90b3R5cGUsICdwYXJlbnQnLCBmdW5jdGlvbiAocXVlcnkpIHtcclxuICAgICAgICBpZiAoIXF1ZXJ5KSByZXR1cm4gdGhpcy5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgIHZhciBjdXJyZW50ID0gdGhpcy5wYXJlbnRFbGVtZW50O1xyXG4gICAgICAgIHdoaWxlICghY3VycmVudC5tYXRjaGVzKHF1ZXJ5KSlcclxuICAgICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucGFyZW50RWxlbWVudDtcclxuICAgICAgICByZXR1cm4gY3VycmVudDtcclxuICAgIH0pO1xyXG5cclxuICAgIHNhZmVFeHRlbmQoSFRNTEVsZW1lbnQucHJvdG90eXBlLCAnaGVpZ2h0JywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gYXJndW1lbnRzWzBdO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJylcclxuICAgICAgICAgICAgICAgIHRoaXMuc3R5bGUuaGVpZ2h0ID0gdmFsdWUgKyAncHgnO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB0aGlzLnN0eWxlLmhlaWdodCA9IHZhbHVlO1xyXG4gICAgICAgIH0gZWxzZVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jbGllbnRIZWlnaHQ7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzYWZlRXh0ZW5kKEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ3dpZHRoJywgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEpIHtcclxuICAgICAgICAgICAgdmFyIHZhbHVlID0gYXJndW1lbnRzWzBdO1xyXG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJylcclxuICAgICAgICAgICAgICAgIHRoaXMuc3R5bGUud2lkdGggPSB2YWx1ZSArICdweCc7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHRoaXMuc3R5bGUud2lkdGggPSB2YWx1ZTtcclxuICAgICAgICB9IGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xpZW50V2lkdGg7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzYWZlRXh0ZW5kKHdpbmRvdywgJ2d1aWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuICdHVUlELScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBzYWZlRXh0ZW5kKEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ2d1aWQnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIGd1aWQgPSBudWxsLCBvdmVybGFwID0gbnVsbDtcclxuICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgIGd1aWQgPSB3aW5kb3cuZ3VpZCgpO1xyXG4gICAgICAgICAgICBvdmVybGFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignIycgKyBndWlkKTtcclxuICAgICAgICB9IHdoaWxlKG92ZXJsYXApO1xyXG4gICAgICAgIHRoaXMuYXR0cignaWQnLCBndWlkKTtcclxuICAgICAgICByZXR1cm4gZ3VpZDtcclxuICAgIH0pO1xyXG5cclxuICAgIGZ1bmN0aW9uIHNhZmVFeHRlbmQocHJvdG90eXBlLCBwcm9wZXJ0eSwgdmFsdWUpIHtcclxuICAgICAgICBpZighcHJvdG90eXBlW3Byb3BlcnR5XSkgcHJvdG90eXBlW3Byb3BlcnR5XSA9IHZhbHVlO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHM0KCkge1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKVxyXG4gICAgICAgICAgICAudG9TdHJpbmcoMTYpLnN1YnN0cmluZygxKTtcclxuICAgIH1cclxufSkoKSk7XHJcbiIsIigoZnVuY3Rpb24oKXtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB3aW5kb3cuZXh0ZW5kID0gZnVuY3Rpb24gKGRlZmF1bHRzLCBwcm9wZXJ0aWVzKSB7XHJcbiAgICAgICAgZm9yICh2YXIgcHJvcGVydHkgaW4gcHJvcGVydGllcylcclxuICAgICAgICAgICAgaWYgKHByb3BlcnR5ICYmIHByb3BlcnRpZXMuaGFzT3duUHJvcGVydHkocHJvcGVydHkpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBwcm9wZXJ0aWVzW3Byb3BlcnR5XTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKVxyXG4gICAgICAgICAgICAgICAgICAgIGV4dGVuZChkZWZhdWx0c1twcm9wZXJ0eV0sIHByb3BlcnRpZXNbcHJvcGVydHldKTtcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0c1twcm9wZXJ0eV0gPSBwcm9wZXJ0aWVzW3Byb3BlcnR5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBzYWZlRXh0ZW5kKE9iamVjdCwgJ2Nsb25lJywgZnVuY3Rpb24gKG9iaikge1xyXG4gICAgICAgIHZhciBuZXdPYmogPSB7fTtcclxuICAgICAgICBmb3IgKHZhciBwcm9wZXJ0eSBpbiBvYmopXHJcbiAgICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkocHJvcGVydHkpKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBvYmpbcHJvcGVydHldO1xyXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcpXHJcbiAgICAgICAgICAgICAgICAgICAgbmV3T2JqW3Byb3BlcnR5XSA9IE9iamVjdC5jbG9uZShvYmpbcHJvcGVydHldKTtcclxuICAgICAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgICAgICBuZXdPYmpbcHJvcGVydHldID0gb2JqW3Byb3BlcnR5XTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBuZXdPYmo7XHJcbiAgICB9KTtcclxuXHJcbiAgICBmdW5jdGlvbiBzYWZlRXh0ZW5kKHByb3RvdHlwZSwgcHJvcGVydHksIHZhbHVlKSB7XHJcbiAgICAgICAgaWYoIXByb3RvdHlwZVtwcm9wZXJ0eV0pIHByb3RvdHlwZVtwcm9wZXJ0eV0gPSB2YWx1ZTtcclxuICAgIH1cclxufSkoKSk7XHJcbiIsIigoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBUcmVlTm9kZSA9IGZ1bmN0aW9uIChwYXJlbnQsIGRhdGEpIHtcclxuICAgICAgICB0aGlzLmRhdGEgPSBkYXRhIHx8IHt9O1xyXG4gICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xyXG4gICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcclxuICAgIH07XHJcblxyXG4gICAgd2luZG93LlRyZWVOb2RlID0gVHJlZU5vZGU7XHJcblxyXG4gICAgVHJlZU5vZGUucHJvdG90eXBlLmlzUm9vdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gIXRoaXMucGFyZW50O1xyXG4gICAgfTtcclxuXHJcbiAgICBUcmVlTm9kZS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICB2YXIgY2hpbGQgPSBuZXcgdGhpcy5jb25zdHJ1Y3Rvcih0aGlzLCBkYXRhKTtcclxuICAgICAgICB0aGlzLmNoaWxkcmVuLnB1c2goY2hpbGQpO1xyXG4gICAgICAgIHJldHVybiBjaGlsZDtcclxuICAgIH07XHJcblxyXG4gICAgVHJlZU5vZGUucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIChpbmRleCkge1xyXG4gICAgICAgIHRoaXMuY2hpbGRyZW4uc2xpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfTtcclxuXHJcbiAgICBUcmVlTm9kZS5wcm90b3R5cGUuZGZzID0gZnVuY3Rpb24gKGNoZWNrKSB7XHJcbiAgICAgICAgdmFyIG91dCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoIWNoZWNrIHx8IChjaGVjayAmJiBjaGVjayh0aGlzLmNoaWxkcmVuW2ldKSkpXHJcbiAgICAgICAgICAgICAgICBvdXQucHVzaCh0aGlzLmNoaWxkcmVuW2ldKTtcclxuICAgICAgICAgICAgb3V0LmNvbmNhdCh0aGlzLmNoaWxkcmVuW2ldLmRmcyhjaGVjaykpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gb3V0O1xyXG4gICAgfTtcclxuXHJcbiAgICBUcmVlTm9kZS5wcm90b3R5cGUuYmZzID0gZnVuY3Rpb24gKGNoZWNrKSB7XHJcbiAgICAgICAgdmFyIG91dCA9IFtdLCBpO1xyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKVxyXG4gICAgICAgICAgICBpZiAoIWNoZWNrIHx8IChjaGVjayAmJiBjaGVjayh0aGlzLmNoaWxkcmVuW2ldKSkpXHJcbiAgICAgICAgICAgICAgICBvdXQucHVzaCh0aGlzLmNoaWxkcmVuW2ldKTtcclxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5jaGlsZHJlbi5sZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgb3V0LmNvbmNhdCh0aGlzLmNoaWxkcmVuW2ldLmJmcyhjaGVjaykpO1xyXG4gICAgICAgIHJldHVybiBvdXQ7XHJcbiAgICB9O1xyXG5cclxuICAgIFRyZWVOb2RlLmV4dGVuZCA9IGZ1bmN0aW9uIChkZWZhdWx0cykge1xyXG4gICAgICAgIHZhciBfVHJlZU5vZGUgPSBmdW5jdGlvbiAocGFyZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIFRyZWVOb2RlLmNhbGwodGhpcywgcGFyZW50LCBkYXRhKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIF9UcmVlTm9kZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFRyZWVOb2RlLnByb3RvdHlwZSk7XHJcbiAgICAgICAgX1RyZWVOb2RlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IF9UcmVlTm9kZTtcclxuICAgICAgICBleHRlbmQoX1RyZWVOb2RlLnByb3RvdHlwZSwgZGVmYXVsdHMpO1xyXG4gICAgICAgIHJldHVybiBuZXcgX1RyZWVOb2RlKG51bGwpO1xyXG4gICAgfTtcclxufSkoKSk7XHJcbiIsIigoZnVuY3Rpb24oKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIEV2ZW50SGFuZGxlciA9IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2UgPSBpbnN0YW5jZTtcclxuICAgICAgICB0aGlzLmxpc3RlbmVycyA9IHt9O1xyXG4gICAgfTtcclxuXHJcbiAgICBFdmVudEhhbmRsZXIucHJvdG90eXBlLnRyaWdnZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgbmFtZSA9IGFyZ3VtZW50c1swXTtcclxuICAgICAgICB2YXIgbGlzdGVuZXJzID0gdGhpcy5saXN0ZW5lcnNbbmFtZV0gfHwgW107XHJcbiAgICAgICAgQXJyYXkucHJvdG90eXBlLnNwbGljZS5jYWxsKGFyZ3VtZW50cywgMCwgMSk7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsaXN0ZW5lcnMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgIGxpc3RlbmVyc1tpXS5hcHBseShudWxsLCBhcmd1bWVudHMpO1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2UubG9nZ2VyLmRlYnVnKG5hbWUsIGFyZ3VtZW50cyk7XHJcbiAgICB9O1xyXG5cclxuICAgIEV2ZW50SGFuZGxlci5wcm90b3R5cGUub24gPSBmdW5jdGlvbihuYW1lLCBjYWxsYmFjaykge1xyXG4gICAgICAgIGlmICghdGhpcy5saXN0ZW5lcnNbbmFtZV0pIHRoaXMubGlzdGVuZXJzW25hbWVdID0gW107XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lcnNbbmFtZV0ucHVzaChjYWxsYmFjayk7XHJcbiAgICB9O1xyXG5cclxuICAgIEV2ZW50SGFuZGxlci5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLmxpc3RlbmVyc1tuYW1lXTtcclxuICAgIH07XHJcblxyXG4gICAgRXZlbnRIYW5kbGVyLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbihuYW1lLCBjYWxsYmFjaykge1xyXG4gICAgICAgIGlmICh0aGlzLmxpc3RlbmVyc1tuYW1lXSkge1xyXG4gICAgICAgICAgICB2YXIgYXJyYXkgPSB0aGlzLmxpc3RlbmVyc1tuYW1lXTtcclxuICAgICAgICAgICAgaWYgKGFycmF5LmluZGV4T2YoY2FsbGJhY2spID4gLTEpIGFycmF5LnNwbGljZShpbmRleCwgMSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB3aW5kb3cuRXZlbnRIYW5kbGVyID0gRXZlbnRIYW5kbGVyO1xyXG59KSgpKTtcclxuIiwiKChmdW5jdGlvbigpe1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBlbXB0eUZ1bmN0aW9uID0gZnVuY3Rpb24gKCkge307XHJcblxyXG4gICAgdmFyIExvZ2dlciA9IGZ1bmN0aW9uIChpbnN0YW5jZSwgaXNEZWJ1Zykge1xyXG4gICAgICAgIHRoaXMuZGVidWcgPSBpc0RlYnVnID8gY29uc29sZS5kZWJ1Zy5iaW5kKCkgOiBlbXB0eUZ1bmN0aW9uO1xyXG5cclxuICAgICAgICB0aGlzLmluZm8gPSBpc0RlYnVnID8gY29uc29sZS5pbmZvLmJpbmQoKSA6IGVtcHR5RnVuY3Rpb247XHJcblxyXG4gICAgICAgIHRoaXMud2FybiA9IGNvbnNvbGUud2Fybi5iaW5kKCk7XHJcblxyXG4gICAgICAgIHRoaXMuZXJyb3IgPSBjb25zb2xlLmVycm9yLmJpbmQoKTtcclxuICAgIH07XHJcblxyXG4gICAgd2luZG93LkxvZ2dlciA9IExvZ2dlcjtcclxufSkoKSk7XHJcbiIsIihmdW5jdGlvbigpe1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcclxuICAgICAgICBjb250YWluZXI6IHtcclxuICAgICAgICAgICAgc2VsZWN0b3I6ICcjY29id2ViJyxcclxuICAgICAgICAgICAgY2xhc3NOYW1lOiAnY2ItY29udGFpbmVyJ1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIENvYndlYiA9IGZ1bmN0aW9uIChvcHRpb25zKSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gZGVmYXVsdE9wdGlvbnM7XHJcbiAgICAgICAgZXh0ZW5kKHRoaXMub3B0aW9ucywgb3B0aW9ucyB8fCB7fSk7XHJcblxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLm9wdGlvbnMuY29udGFpbmVyLnNlbGVjdG9yKTtcclxuICAgICAgICBpZiAoIXRoaXMuY29udGFpbmVyKVxyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgY29udGFpbmVyIHNlbGVjdG9yOiBcXCcnICtcclxuICAgICAgICAgICAgICAgIHRoaXMub3B0aW9ucy5jb250YWluZXIuc2VsZWN0b3IgKyAnXFwnJyk7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuYWRkQ2xhc3ModGhpcy5vcHRpb25zLmNvbnRhaW5lci5jbGFzc05hbWUpO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmRhdGEoJ2luc3RhbmNlJywgdGhpcyk7XHJcblxyXG4gICAgICAgIHRoaXMubG9nZ2VyID0gbmV3IExvZ2dlcih0aGlzLCB0cnVlKTtcclxuICAgICAgICB0aGlzLmV2ZW50cyA9IG5ldyBFdmVudEhhbmRsZXIodGhpcyk7XHJcbiAgICAgICAgQ29id2ViLnByb3RvdHlwZS5tb2R1bGVzLmxvYWQodGhpcyk7XHJcbiAgICB9O1xyXG5cclxuICAgIHdpbmRvdy5Db2J3ZWIgPSBDb2J3ZWI7XHJcbn0oKSk7XHJcbiIsIigoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIENvYndlYi5wcm90b3R5cGUubW9kdWxlcyA9IHtcclxuICAgICAgICBhbGw6IHt9LFxyXG4gICAgICAgIGFkZDogZnVuY3Rpb24gKG5hbWUsIGluaXQsIGRlcGVuZGVuY2llcykge1xyXG4gICAgICAgICAgICBkZXBlbmRlbmNpZXMgPSBkZXBlbmRlbmNpZXMgfHwgW107XHJcblxyXG4gICAgICAgICAgICB0aGlzLmFsbFtuYW1lXSA9IHtcclxuICAgICAgICAgICAgICAgIGRlcGVuZGVuY2llczogZGVwZW5kZW5jaWVzLFxyXG4gICAgICAgICAgICAgICAgaW5pdDogaW5pdFxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgbG9hZDogZnVuY3Rpb24gKGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2UgPSBpbnN0YW5jZTtcclxuICAgICAgICAgICAgYWRkUmV2ZXJzZURlcGVuZGVuY2llcyh0aGlzLmFsbCk7XHJcbiAgICAgICAgICAgIHZhciBzb3J0ZWROYW1lcyA9IHRvcG9sb2dpY2FsU29ydChpbnN0YW5jZSwgdGhpcy5hbGwpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNvcnRlZE5hbWVzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBzb3J0ZWROYW1lc1tpXTtcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hbGxbbmFtZV0uaW5pdChpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuZXZlbnRzLnRyaWdnZXIoJ21vZHVsZXMubG9hZGVkJywgbmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChleCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLmxvZ2dlci5lcnJvcignTG9hZGluZyBtb2R1bGUgJyArIG5hbWUsIGV4KTtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5ldmVudHMudHJpZ2dlcignbW9kdWxlcy5lcnJvcicsIG5hbWUsIGV4KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpbnN0YW5jZS5ldmVudHMudHJpZ2dlcignbW9kdWxlcy5sb2FkZWQuYWxsJywgc29ydGVkTmFtZXMpO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcHJpbnQ6IGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgICAgICBpZiAoaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gdGhpcy5hbGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbW9kdWxlID0gdGhpcy5hbGxbbmFtZV07XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UubG9nZ2VyLmRlYnVnKCdOYW1lOiAnLCBuYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5sb2dnZXIuZGVidWcoJ1xcdERlcGVuZGVuY2llczogJywgbW9kdWxlLmRlcGVuZGVuY2llcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UubG9nZ2VyLmRlYnVnKCdcXHREZXBlbmRhbnQ6ICcsIG1vZHVsZS5kZXBlbmRhbnQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3I6IFwibG9hZFwiIHNob3VsZCBiZSBjYWxsZWQgYmVmb3JlIFwicHJpbnRcIicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBmdW5jdGlvbiBhZGRSZXZlcnNlRGVwZW5kZW5jaWVzIChtb2R1bGVzKSB7XHJcbiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBtb2R1bGVzKSB7XHJcbiAgICAgICAgICAgIHZhciBtb2R1bGUgPSBtb2R1bGVzW25hbWVdO1xyXG4gICAgICAgICAgICBpZiAoIW1vZHVsZS5kZXBlbmRhbnQpIG1vZHVsZS5kZXBlbmRhbnQgPSBbXTtcclxuICAgICAgICAgICAgaWYgKG1vZHVsZS5kZXBlbmRlbmNpZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtb2R1bGUuZGVwZW5kZW5jaWVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlcFBsdWdpbiA9IG1vZHVsZXNbbW9kdWxlLmRlcGVuZGVuY2llc1tpXV07XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkZXBQbHVnaW4uZGVwZW5kYW50KSBkZXBQbHVnaW4uZGVwZW5kYW50ID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgZGVwUGx1Z2luLmRlcGVuZGFudC5wdXNoKG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHRvcG9sb2dpY2FsU29ydCAoaW5zdGFuY2UsIG1vZHVsZXMpIHtcclxuICAgICAgICB2YXIgY2FuZGlkYXRlcyA9IFtdLCBzb3J0ZWROYW1lcyA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIG5hbWUgaW4gbW9kdWxlcylcclxuICAgICAgICAgICAgaWYgKG1vZHVsZXNbbmFtZV0uZGVwZW5kZW5jaWVzLmxlbmd0aCA9PT0gMClcclxuICAgICAgICAgICAgICAgIGNhbmRpZGF0ZXMucHVzaChuYW1lKTtcclxuICAgICAgICB3aGlsZSAoY2FuZGlkYXRlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHZhciBuZXh0TmFtZSA9IGNhbmRpZGF0ZXNbMF07XHJcbiAgICAgICAgICAgIGNhbmRpZGF0ZXMuc3BsaWNlKDAsIDEpO1xyXG4gICAgICAgICAgICBpZiAobW9kdWxlc1tuZXh0TmFtZV0pIHtcclxuICAgICAgICAgICAgICAgIHZhciBtb2R1bGUgPSBtb2R1bGVzW25leHROYW1lXTtcclxuICAgICAgICAgICAgICAgIHNvcnRlZE5hbWVzLnB1c2gobmV4dE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtb2R1bGUuZGVwZW5kYW50Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlcE5hbWUgPSBtb2R1bGUuZGVwZW5kYW50W2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChhbGxEZXBlbmRlbmNpZXNNZXQoc29ydGVkTmFtZXMsIG1vZHVsZXNbZGVwTmFtZV0pKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYW5kaWRhdGVzLnB1c2goZGVwTmFtZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5ldmVudHMudHJpZ2dlcignbW9kdWxlcy5lcnJvci5taXNzaW5nJywgbmV4dE5hbWUpO1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UubG9nZ2VyLndhcm5pbmcoJ01pc3NpbmcgbW9kdWxlIFxcJycgKyBuZXh0TmFtZSArICdcXCcnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoT2JqZWN0LmtleXMobW9kdWxlcykubGVuZ3RoICE9PSBzb3J0ZWROYW1lcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UuZXZlbnRzLnRyaWdnZXIoJ21vZHVsZXMuZXJyb3IuY3ljbGUnKTtcclxuICAgICAgICAgICAgaW5zdGFuY2UubG9nZ2VyLmVycm9yKCdEZXBlbmRlbmN5IGN5Y2xlIGZvdW5kIGluIG1vZHVsZXMnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHNvcnRlZE5hbWVzO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFsbERlcGVuZGVuY2llc01ldCAobG9hZGVkVW50aWxOb3csIG1vZHVsZSkge1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbW9kdWxlLmRlcGVuZGVuY2llcy5sZW5ndGg7IGkrKylcclxuICAgICAgICAgICAgaWYgKGxvYWRlZFVudGlsTm93LmluZGV4T2YobW9kdWxlLmRlcGVuZGVuY2llc1tpXSkgPT09IC0xKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn0pKCkpO1xyXG4iLCIoKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBDb2J3ZWIucHJvdG90eXBlLm1vZHVsZXMuYWRkKCdwYW5lLXR5cGVzJywgZnVuY3Rpb24gKGluc3RhbmNlKSB7XHJcbiAgICAgICAgdmFyIHBhbmVUeXBlcyA9IHtcclxuICAgICAgICAgICAgYWxsOiB7fSxcclxuICAgICAgICAgICAgYWRkOiBmdW5jdGlvbiAobmFtZSwgY2FsbGJhY2spIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxsW25hbWVdID0gY2FsbGJhY2s7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmFsbFtuYW1lXTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgcmVtb3ZlOiBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuYWxsW25hbWVdO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBoYXM6IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gISF0aGlzLmFsbFtuYW1lXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHBhbmVUeXBlcy5hZGQoJ2RlZmF1bHQnLCBmdW5jdGlvbiAocGFuZSwgaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UubG9nZ2VyLmRlYnVnKCdEZWZhdWx0IHBhbmUgdHlwZSAodGhpcyBkb2VzIG5vdGhpbmcpJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGluc3RhbmNlLmV2ZW50cy5vbigncGFuZS5zcGxpdCcsIGZ1bmN0aW9uIChvbGRQYW5lLCBuZXdQYW5lKSB7XHJcbiAgICAgICAgICAgIHZhciBvbGRUeXBlID0gb2xkUGFuZS5hdHRyRGF0YSgncGFuZS10eXBlJyk7XHJcbiAgICAgICAgICAgIGlmIChvbGRUeXBlKSBpbnN0YW5jZS5wYW5lLnNldFR5cGUobmV3UGFuZSwgb2xkVHlwZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGluc3RhbmNlLnBhbmUudHlwZXMgPSBwYW5lVHlwZXM7XHJcblxyXG4gICAgICAgIGluc3RhbmNlLnBhbmUuc2V0VHlwZSA9IGZ1bmN0aW9uIChwYW5lLCBuYW1lKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnR5cGVzLmhhcyhuYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy50eXBlcy5nZXQobmFtZSkocGFuZSwgaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgcGFuZS5hdHRyRGF0YSgncGFuZS10eXBlJywgbmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSwgWydwYW5lJ10pO1xyXG59KSgpKTtcclxuIiwiKChmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgQ29id2ViLnByb3RvdHlwZS5tb2R1bGVzLmFkZCgncGFuZScsIGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgIGluc3RhbmNlLnBhbmUgPSBuZXcgUGFuZSh7XHJcbiAgICAgICAgICAgIGNvbnRhaW5lcjogaW5zdGFuY2Uub3B0aW9ucy5jb250YWluZXIuc2VsZWN0b3IsXHJcbiAgICAgICAgICAgIHNlcGFyYXRvcjoge1xyXG4gICAgICAgICAgICAgICAgc2l6ZTogM1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBjYWxsYmFja3M6IHtcclxuICAgICAgICAgICAgICAgIC8vb25QYW5lQ3JlYXRlOiBvblBhbmVDcmVhdGUsXHJcbiAgICAgICAgICAgICAgICBvblBhbmVTcGxpdDogb25QYW5lU3BsaXQsXHJcbiAgICAgICAgICAgICAgICBvblBhbmVSZXNpemU6IG9uUGFuZVJlc2l6ZSxcclxuICAgICAgICAgICAgICAgIC8vb25QYW5lTWVyZ2U6IG9uUGFuZU1lcmdlLFxyXG4gICAgICAgICAgICAgICAgLy9vblBhbmVEZXN0cm95OiBvblBhbmVEZXN0cm95LFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9uUGFuZUNyZWF0ZSAocGFuZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdvblBhbmVDcmVhdGUnLCBwYW5lKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9uUGFuZVNwbGl0IChvcmlnaW4sIG5ld1BhbmUpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UuZXZlbnRzLnRyaWdnZXIoJ3BhbmUuc3BsaXQnLCBvcmlnaW4sIG5ld1BhbmUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb25QYW5lUmVzaXplIChwYW5lKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLmV2ZW50cy50cmlnZ2VyKCdwYW5lLnJlc2l6ZScsIHBhbmUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb25QYW5lTWVyZ2UgKG1lcmdlciwgdG9SZW1vdmUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5kZWJ1Zygnb25QYW5lTWVyZ2UnLCBtZXJnZXIsIHRvUmVtb3ZlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9uUGFuZURlc3Ryb3kgKHBhbmUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5kZWJ1Zygnb25QYW5lRGVzdHJveScsIHBhbmUpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59KSgpKTtcclxuIiwiKChmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgQ29id2ViLnByb3RvdHlwZS5tb2R1bGVzLmFkZCgnc3VyZmFjZScsIGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgIGluc3RhbmNlLnBhbmUudHlwZXMuYWRkKCdzdXJmYWNlJywgZnVuY3Rpb24gKHBhbmUsIGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcclxuICAgICAgICAgICAgcGFuZS5hcHBlbmQoY2FudmFzKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xyXG4gICAgICAgICAgICAgICAgcHJvajogbWF0NC5jcmVhdGUoKSxcclxuICAgICAgICAgICAgICAgIHZpZXc6IG1hdDQuY3JlYXRlKClcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgbWF0NC5wZXJzcGVjdGl2ZShkYXRhLnByb2osIC00NSAqIERFRzJSQUQsXHJcbiAgICAgICAgICAgICAgICBjYW52YXMud2lkdGggLyBjYW52YXMuaGVpZ2h0LCAwLjEsIDEwMDApO1xyXG4gICAgICAgICAgICBtYXQ0Lmxvb2tBdChkYXRhLnZpZXcsIFswLDIsNF0sIFswLDAsMF0sIFswLDEsMF0pO1xyXG4gICAgICAgICAgICBtYXQ0LnNjYWxlKGRhdGEudmlldywgZGF0YS52aWV3LCBbMSwxLjIsMV0pO1xyXG4gICAgICAgICAgICBwYW5lLmRhdGEoJ3N1cmZhY2UnLCBkYXRhKTtcclxuICAgICAgICAgICAgdXBkYXRlQ2FudmFzU2l6ZShwYW5lKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaW5zdGFuY2UuZXZlbnRzLm9uKCdwYW5lLnJlc2l6ZScsIGZ1bmN0aW9uIChwYW5lKSB7XHJcbiAgICAgICAgICAgIGlmIChwYW5lLmF0dHJEYXRhKCdwYW5lLXR5cGUnKSA9PT0gJ3N1cmZhY2UnKSB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVDYW52YXNTaXplKHBhbmUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciByb290ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBhbmUnKTtcclxuICAgICAgICBpbnN0YW5jZS5wYW5lLnNldFR5cGUocm9vdCwgJ3N1cmZhY2UnKTtcclxuICAgICAgICBpbnN0YW5jZS5wYW5lLnNldFJlbmRlcihyb290LCAnc29saWQnKTtcclxuICAgIH0sIFsncGFuZS10eXBlcycsICdzdXJmYWNlLXJlbmRlciddKTtcclxuXHJcbiAgICBmdW5jdGlvbiB1cGRhdGVDYW52YXNTaXplIChwYW5lKSB7XHJcbiAgICAgICAgdmFyIGNhbnZhcyA9IHBhbmUucXVlcnlTZWxlY3RvcignY2FudmFzJyk7XHJcbiAgICAgICAgdmFyIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcclxuICAgICAgICB2YXIgd2lkdGggPSBwYW5lLndpZHRoKCksIGhlaWdodCA9IHBhbmUuaGVpZ2h0KCk7XHJcbiAgICAgICAgcGFuZS5kYXRhKCdidWZmZXInLCBuZXcgVWludDhBcnJheSh3aWR0aCAqIGhlaWdodCAqIDQpKTtcclxuICAgICAgICBwYW5lLmRhdGEoJ2ltZ0RhdGEnLCBjb250ZXh0LmNyZWF0ZUltYWdlRGF0YSh3aWR0aCwgaGVpZ2h0KSk7XHJcblxyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgY2FudmFzLndpZHRoID0gd2lkdGg7XHJcblxyXG4gICAgICAgIHZhciBkYXRhID0gcGFuZS5kYXRhKCdzdXJmYWNlJyk7XHJcbiAgICAgICAgbWF0NC5wZXJzcGVjdGl2ZShkYXRhLnByb2osIC00NSAqIERFRzJSQUQsIHdpZHRoIC8gaGVpZ2h0LCAwLjEsIDEwMDApO1xyXG4gICAgfVxyXG59KSgpKTtcclxuIiwiKChmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgQ29id2ViLnByb3RvdHlwZS5tb2R1bGVzLmFkZCgnb2JqZWN0LWludGVyYWN0aW9uJywgZnVuY3Rpb24gKGluc3RhbmNlKSB7XHJcblxyXG4gICAgICAgIGluc3RhbmNlLmludGVyYWN0aW9uLmFkZCgnb2JqZWN0Jywge1xyXG4gICAgICAgICAgICBvbk1vdXNlRG93bjogZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5sb2dnZXIuZGVidWcoJ29uTW91c2VEb3duJywgZXZlbnQpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBvbk1vdXNlVXA6IGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UubG9nZ2VyLmRlYnVnKCdvbk1vdXNlVXAnLCBldmVudCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIG9uTW91c2VNb3ZlOiBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLmxvZ2dlci5kZWJ1Zygnb25Nb3VzZU1vdmUnLCBldmVudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9LCBbJ3N1cmZhY2UtcmVuZGVyJ10pO1xyXG59KSgpKTtcclxuIiwiKChmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgQ29id2ViLnByb3RvdHlwZS5tb2R1bGVzLmFkZCgnc3VyZmFjZS1pbnRlcmFjdGlvbicsIGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgIGluc3RhbmNlLnBhbmUuc2V0SW50ZXJhY3Rpb24gPSBmdW5jdGlvbiAocGFuZSwgbmFtZSkge1xyXG4gICAgICAgICAgICB2YXIgaW50ZXJhY3Rpb25zID0gaW5zdGFuY2UuaW50ZXJhY3Rpb247XHJcbiAgICAgICAgICAgIGlmIChpbnRlcmFjdGlvbnMuaGFzKG5hbWUpKVxyXG4gICAgICAgICAgICAgICAgcGFuZS5hdHRyRGF0YSgnc3VyZmFjZS1pbnRlcmFjdGlvbicsIG5hbWUpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGluc3RhbmNlLnBhbmUuZ2V0SW50ZXJhY3Rpb24gPSBmdW5jdGlvbiAocGFuZSkge1xyXG4gICAgICAgICAgICB2YXIgaW50ZXJhY3Rpb25zID0gaW5zdGFuY2UuaW50ZXJhY3Rpb247XHJcbiAgICAgICAgICAgIHZhciBuYW1lID0gcGFuZS5hdHRyRGF0YSgnc3VyZmFjZS1pbnRlcmFjdGlvbicpO1xyXG4gICAgICAgICAgICByZXR1cm4gaW50ZXJhY3Rpb25zLmdldChuYW1lKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpbnN0YW5jZS5ldmVudHMub24oJ3BhbmUuc3BsaXQnLCBmdW5jdGlvbiAob2xkUGFuZSwgbmV3UGFuZSkge1xyXG4gICAgICAgICAgICBuZXdQYW5lLmF0dHJEYXRhKCdzdXJmYWNlLWludGVyYWN0aW9uJywgb2xkUGFuZS5hdHRyRGF0YSgnc3VyZmFjZS1pbnRlcmFjdGlvbicpKTtcclxuICAgICAgICB9KTtcclxuICAgIH0sIFsnaW50ZXJhY3Rpb24tbW9kZSddKTtcclxufSkoKSk7XHJcbiIsIigoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIENvYndlYi5wcm90b3R5cGUubW9kdWxlcy5hZGQoJ3JlbmRlci1zb2xpZCcsIGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgIHZhciBzaGFkZXIgPSBuZXcgU2hhZGVyKFxyXG4gICAgICAgICAgICAncHJlY2lzaW9uIGhpZ2hwIGZsb2F0OycgK1xyXG4gICAgICAgICAgICAnYXR0cmlidXRlIHZlYzMgYV92ZXJ0ZXg7JyArXHJcbiAgICAgICAgICAgICdhdHRyaWJ1dGUgdmVjMyBhX25vcm1hbDsnICtcclxuICAgICAgICAgICAgJ3ZhcnlpbmcgdmVjMyB2X25vcm1hbDsnICtcclxuICAgICAgICAgICAgJ3VuaWZvcm0gbWF0NCB1X212cDsnICtcclxuICAgICAgICAgICAgJ3VuaWZvcm0gbWF0NCB1X21vZGVsOycgK1xyXG4gICAgICAgICAgICAndm9pZCBtYWluKCkgeycgK1xyXG4gICAgICAgICAgICAnICAgIHZfbm9ybWFsID0gKHVfbW9kZWwgKiB2ZWM0KGFfbm9ybWFsLDAuMCkpLnh5ejsnICtcclxuICAgICAgICAgICAgJyAgICBnbF9Qb3NpdGlvbiA9IHVfbXZwICogdmVjNChhX3ZlcnRleCwxLjApOycgK1xyXG4gICAgICAgICAgICAnfScsXHJcbiAgICAgICAgICAgICdwcmVjaXNpb24gaGlnaHAgZmxvYXQ7JyArXHJcbiAgICAgICAgICAgICd2YXJ5aW5nIHZlYzMgdl9ub3JtYWw7JyArXHJcbiAgICAgICAgICAgICd1bmlmb3JtIHZlYzMgdV9saWdodHZlY3RvcjsnICtcclxuICAgICAgICAgICAgJ3VuaWZvcm0gdmVjNCB1X2NvbG9yOycgK1xyXG4gICAgICAgICAgICAndm9pZCBtYWluKCkgeycgK1xyXG4gICAgICAgICAgICAnICB2ZWMzIE4gPSBub3JtYWxpemUodl9ub3JtYWwpOycgK1xyXG4gICAgICAgICAgICAnICBnbF9GcmFnQ29sb3IgPSB1X2NvbG9yICogbWF4KDAuMCwgZG90KHVfbGlnaHR2ZWN0b3IsTikpOycgK1xyXG4gICAgICAgICAgICAnfSdcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICB2YXIgdGVtcCA9IG1hdDQuY3JlYXRlKCk7XHJcbiAgICAgICAgdmFyIG12cCA9IG1hdDQuY3JlYXRlKCk7XHJcblxyXG4gICAgICAgIHZhciB1bmlmb3JtcyA9IHtcclxuICAgICAgICAgICAgdV9jb2xvcjogWzEsIDEsIDEsIDFdLFxyXG4gICAgICAgICAgICB1X2xpZ2h0dmVjdG9yOiB2ZWMzLm5vcm1hbGl6ZSh2ZWMzLmNyZWF0ZSgpLCBbMSwgMiwgM10pLFxyXG4gICAgICAgICAgICB1X21vZGVsOiBudWxsLFxyXG4gICAgICAgICAgICB1X212cDogbXZwXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaW5zdGFuY2UuZ3JhcGhpY3MucmVuZGVycy5hZGQoJ3NvbGlkJywgZnVuY3Rpb24gKHN1cmZhY2UpIHtcclxuICAgICAgICAgICAgdmFyIG9ianMgPSBpbnN0YW5jZS5zY2VuZS5yb290LmRmcygpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9ianMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBvYmogPSBvYmpzW2ldLmRhdGE7XHJcbiAgICBcdFx0XHRtYXQ0Lm11bHRpcGx5KHRlbXAsIHN1cmZhY2Uudmlldywgb2JqLm1vZGVsKTtcclxuICAgIFx0XHRcdG1hdDQubXVsdGlwbHkobXZwLCBzdXJmYWNlLnByb2osIHRlbXApO1xyXG5cclxuICAgIFx0XHRcdHVuaWZvcm1zLnVfbW9kZWwgPSBvYmoubW9kZWw7XHJcbiAgICBcdFx0XHRzaGFkZXIudW5pZm9ybXModW5pZm9ybXMpLmRyYXcob2JqLm1lc2gsIG9iai5wcmltaXRpdmUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgfSwgWydncmFwaGljcy1yZW5kZXInXSk7XHJcbn0pKCkpO1xyXG4iLCIoKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBDb2J3ZWIucHJvdG90eXBlLm1vZHVsZXMuYWRkKCdzdXJmYWNlLXJlbmRlcicsIGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgIGluc3RhbmNlLnBhbmUuc2V0UmVuZGVyID0gZnVuY3Rpb24gKHBhbmUsIG5hbWUpIHtcclxuICAgICAgICAgICAgdmFyIHJlbmRlcnMgPSBpbnN0YW5jZS5ncmFwaGljcy5yZW5kZXJzO1xyXG4gICAgICAgICAgICBpZiAocmVuZGVycy5oYXMobmFtZSkpXHJcbiAgICAgICAgICAgICAgICBwYW5lLmF0dHJEYXRhKCdzdXJmYWNlLXJlbmRlcicsIG5hbWUpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGluc3RhbmNlLnBhbmUuZ2V0UmVuZGVyID0gZnVuY3Rpb24gKHBhbmUpIHtcclxuICAgICAgICAgICAgdmFyIHJlbmRlcnMgPSBpbnN0YW5jZS5ncmFwaGljcy5yZW5kZXJzO1xyXG4gICAgICAgICAgICB2YXIgbmFtZSA9IHBhbmUuYXR0ckRhdGEoJ3N1cmZhY2UtcmVuZGVyJyk7XHJcbiAgICAgICAgICAgIHJldHVybiByZW5kZXJzLmdldChuYW1lKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpbnN0YW5jZS5ldmVudHMub24oJ3BhbmUuc3BsaXQnLCBmdW5jdGlvbiAob2xkUGFuZSwgbmV3UGFuZSkge1xyXG4gICAgICAgICAgICBuZXdQYW5lLmF0dHJEYXRhKCdzdXJmYWNlLXJlbmRlcicsIG9sZFBhbmUuYXR0ckRhdGEoJ3N1cmZhY2UtcmVuZGVyJykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSwgWydncmFwaGljcy1yZW5kZXInXSk7XHJcbn0pKCkpO1xyXG4iLCIoKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBDb2J3ZWIucHJvdG90eXBlLm1vZHVsZXMuYWRkKCdncmFwaGljcy1yZW5kZXInLCBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcclxuICAgICAgICBpbnN0YW5jZS5ncmFwaGljcy5yZW5kZXJzID0ge1xyXG4gICAgICAgICAgICBhbGw6IHt9LFxyXG4gICAgICAgICAgICBhZGQ6IGZ1bmN0aW9uIChuYW1lLCBjYWxsYmFjaykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hbGxbbmFtZV0gPSBjYWxsYmFjaztcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYWxsW25hbWVdO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICByZW1vdmU6IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5hbGxbbmFtZV07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGhhczogZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAhIXRoaXMuYWxsW25hbWVdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0sIFsnZ3JhcGhpY3MnXSk7XHJcbn0pKCkpO1xyXG4iLCIoKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgR3JhcGhpY3MgPSBmdW5jdGlvbiAoaW5zdGFuY2UpIHtcclxuICAgICAgICB0aGlzLmluc3RhbmNlID0gaW5zdGFuY2U7XHJcbiAgICAgICAgdGhpcy5nbCA9IEdMLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGhlaWdodDogc2NyZWVuLmhlaWdodCxcclxuICAgICAgICAgICAgd2lkdGg6IHNjcmVlbi53aWR0aFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuZ2wuYW5pbWF0ZSgpO1xyXG4gICAgICAgIHRoaXMuZ2wub25kcmF3ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2YXIgcmVuZGVyVGFyZ2V0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2NhbnZhcycpO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlbmRlclRhcmdldHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgICAgICAgICBkcmF3UmVuZGVyVGFyZ2V0KGluc3RhbmNlLCByZW5kZXJUYXJnZXRzW2ldKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHRoaXMuZ2wuY2xlYXJDb2xvcigwLjQsIDAuNCwgMC40LCAxKTtcclxuICAgICAgICB0aGlzLmdsLmVuYWJsZSh0aGlzLmdsLkRFUFRIX1RFU1QpO1xyXG4gICAgfTtcclxuXHJcbiAgICBDb2J3ZWIucHJvdG90eXBlLm1vZHVsZXMuYWRkKCdncmFwaGljcycsIGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgIGluc3RhbmNlLmdyYXBoaWNzID0gbmV3IEdyYXBoaWNzKGluc3RhbmNlKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGZ1bmN0aW9uIGRyYXdSZW5kZXJUYXJnZXQgKGluc3RhbmNlLCBjYW52YXMpIHtcclxuICAgICAgICB2YXIgcGFuZSA9IGNhbnZhcy5wYXJlbnQoJy5wYW5lJyk7XHJcbiAgICAgICAgdmFyIGltYWdlRGF0YSA9IHBhbmUuZGF0YSgnaW1nRGF0YScpO1xyXG4gICAgICAgIHZhciBzdXJmYWNlID0gcGFuZS5kYXRhKCdzdXJmYWNlJyk7XHJcbiAgICAgICAgdmFyIGJ1ZmZlciA9IHBhbmUuZGF0YSgnYnVmZmVyJyk7XHJcbiAgICAgICAgdmFyIGdsID0gaW5zdGFuY2UuZ3JhcGhpY3MuZ2w7XHJcblxyXG4gICAgICAgIHZhciB3aWR0aCAgPSBjYW52YXMuY2xpZW50V2lkdGgsIGhlaWdodCA9IGNhbnZhcy5jbGllbnRIZWlnaHQ7XHJcbiAgICAgICAgZ2wuY2xlYXIoZ2wuQ09MT1JfQlVGRkVSX0JJVCB8IGdsLkRFUFRIX0JVRkZFUl9CSVQpO1xyXG4gICAgICAgIGdsLnZpZXdwb3J0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xyXG5cclxuICAgICAgICB2YXIgcmVuZGVyID0gaW5zdGFuY2UucGFuZS5nZXRSZW5kZXIocGFuZSk7XHJcbiAgICAgICAgaWYgKHJlbmRlcikgcmVuZGVyKHN1cmZhY2UpO1xyXG5cclxuICAgICAgICB2YXIgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG4gICAgICAgIGlmIChjb250ZXh0KSB7XHJcbiAgICAgICAgICAgIGdsLnJlYWRQaXhlbHMoMCwgMCwgd2lkdGgsIGhlaWdodCwgZ2wuUkdCQSwgZ2wuVU5TSUdORURfQllURSwgYnVmZmVyKTtcclxuICAgICAgICAgICAgaW1hZ2VEYXRhLmRhdGEuc2V0KGJ1ZmZlcik7XHJcbiAgICAgICAgICAgIGNvbnRleHQucHV0SW1hZ2VEYXRhKGltYWdlRGF0YSwgMCwgMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KSgpKTtcclxuIiwiKChmdW5jdGlvbiAoKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgQ29id2ViLnByb3RvdHlwZS5tb2R1bGVzLmFkZCgnaW50ZXJhY3Rpb24tbW9kZScsIGZ1bmN0aW9uIChpbnN0YW5jZSkge1xyXG4gICAgICAgIHZhciBpbnRlcmFjdGlvbk1vZGVzID0ge1xyXG4gICAgICAgICAgICBhbGw6IHt9LFxyXG4gICAgICAgICAgICBhZGQ6IGZ1bmN0aW9uIChuYW1lLCBjYWxsYmFja3MpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWxsW25hbWVdID0gY2FsbGJhY2tzO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uIChuYW1lKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5hbGxbbmFtZV07XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHJlbW92ZTogZnVuY3Rpb24gKG5hbWUpIHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmFsbFtuYW1lXTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgaGFzOiBmdW5jdGlvbiAobmFtZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICEhdGhpcy5hbGxbbmFtZV07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpbnN0YW5jZS5pbnRlcmFjdGlvbiA9IGludGVyYWN0aW9uTW9kZXM7XHJcbiAgICB9KTtcclxufSkoKSk7XHJcbiIsIigoZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIENvYndlYi5wcm90b3R5cGUubW9kdWxlcy5hZGQoJ3NjZW5lJywgZnVuY3Rpb24gKGluc3RhbmNlKSB7XHJcbiAgICAgICAgaW5zdGFuY2Uuc2NlbmUgPSB7XHJcbiAgICAgICAgICAgIHJvb3Q6IFRyZWVOb2RlLmV4dGVuZCh7fSlcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgbWF0ID0gbWF0NC5jcmVhdGUoKTtcclxuICAgICAgICBtYXQ0LnJvdGF0ZVkobWF0LCBtYXQsIDAuOCk7XHJcblxyXG4gICAgICAgIGluc3RhbmNlLnNjZW5lLnJvb3QuYWRkKHtcclxuICAgICAgICAgICAgdHlwZTogJ29iamVjdCcsXHJcbiAgICAgICAgICAgIHByaW1pdGl2ZTogaW5zdGFuY2UuZ3JhcGhpY3MuZ2wuVFJJQU5HTEVTLFxyXG4gICAgICAgICAgICBtZXNoOiBHTC5NZXNoLmN1YmUoKSxcclxuICAgICAgICAgICAgbW9kZWw6IG1hdCxcclxuICAgICAgICB9KTtcclxuICAgIH0sIFsnZ3JhcGhpY3MnXSk7XHJcbn0pKCkpO1xyXG4iXX0=
